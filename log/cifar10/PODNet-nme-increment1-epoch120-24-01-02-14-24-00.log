Label: podnet_nme_cifar10_5steps
orders : None
{'model': 'podnet', 'convnet': 'rebuffi', 'dropout': 0.0, 'herding': None, 'memory_size': 2000, 'temperature': 1, 'fixed_memory': True, 'dataset': 'cifar10', 'increment': 1, 'batch_size': 128, 'workers': 0, 'threads': 1, 'validation': 0.0, 'random_classes': True, 'max_task': None, 'onehot': False, 'initial_increment': 5, 'sampler': None, 'data_path': '/data/douillard/', 'lr': 0.1, 'weight_decay': 0.0005, 'scheduling': 'cosine', 'lr_decay': 0.1, 'optimizer': 'sgd', 'epochs': 120, 'device': [0], 'label': 'podnet_nme_cifar10_5steps', 'autolabel': False, 'seed': [1], 'seed_range': None, 'options': None, 'save_model': 'last', 'dump_predictions': False, 'logging': 'info', 'resume': None, 'resume_first': False, 'recompute_meta': False, 'no_benchmark': False, 'detect_anomaly': False, 'dummy': 1, 'includes': ['headers/dummy.yaml'], 'data_root': 'D:/data/douillard/cifar10/cifar10', 'save_path': '.', 'eval_type': 'nme', 'backbone': {'name': 'resnet18'}, 'classifier': {'name': 'PODNet'}, 'classifier_config': {'type': 'cosine', 'proxy_per_class': 10, 'distance': 'neg_stable_cosine_distance'}, 'postprocessor_config': {'type': 'learned_scaling', 'initial_value': 1.0}, 'pod_flat': {'scheduled_factor': 1.0}, 'pod_spatial': {'scheduled_factor': 3.0, 'collapse_channels': 'spatial'}, 'nca': {'margin': 0.6, 'scale': 1.0, 'exclude_pos_denominator': True}, 'groupwise_factors': {'old_weights': 0.0}, 'finetuning_config': {'sampling': 'undersampling', 'tuning': 'classifier', 'lr': 0.05, 'epochs': 20, 'scaling': None}, 'proxy_per_class': 1, 'weight_generation': {'type': 'imprinted', 'multi_class_diff': 'kmeans'}, 'dataset_transforms': {'color_jitter': True}}
Launching run 1/1
Set seed 1
CUDA algos are determinists but very slow!
Files already downloaded and verified
Files already downloaded and verified
Dataset iCIFAR10: class ordering: [6, 8, 9, 7, 5, 3, 0, 4, 1, 2].
Downsampling type stride
Using 10 proxies per class.
Model will be save at this rythm: last.
================Task 0 Start!================
Testing on False unseen tasks (max class = 5).
Before task
Now 200 examplars per class.
Group: convnet, lr: 0.1.
Group: postprocessing, lr: 0.1.
Group: new_weights, lr: 0.1.
================Task 0 Training!================
The training samples number: 25000
Train on 0->5.
train task
nb 25000.
Train [1/6] | Epoch [1/120] |	nca: 245.8408352136612, loss: 245.8408352136612 
Train [1/6] | Epoch [2/120] |	nca: 172.5943865776062, loss: 172.5943865776062 
Train [1/6] | Epoch [3/120] |	nca: 122.78007876873016, loss: 122.78007876873016 
Train [1/6] | Epoch [4/120] |	nca: 102.02858290076256, loss: 102.02858290076256 
Train [1/6] | Epoch [5/120] |	nca: 89.43182381987572, loss: 89.43182381987572 
Train [1/6] | Epoch [6/120] |	nca: 81.16078592836857, loss: 81.16078592836857 
Train [1/6] | Epoch [7/120] |	nca: 77.56302607059479, loss: 77.56302607059479 
Train [1/6] | Epoch [8/120] |	nca: 69.65983571112156, loss: 69.65983571112156 
Train [1/6] | Epoch [9/120] |	nca: 67.30038060247898, loss: 67.30038060247898 
Train [1/6] | Epoch [10/120] |	nca: 63.35206197202206, loss: 63.35206197202206 
Train [1/6] | Epoch [11/120] |	nca: 63.4706047475338, loss: 63.4706047475338 
Train [1/6] | Epoch [12/120] |	nca: 61.91594834625721, loss: 61.91594834625721 
Train [1/6] | Epoch [13/120] |	nca: 58.834900572896004, loss: 58.834900572896004 
Train [1/6] | Epoch [14/120] |	nca: 56.784416645765305, loss: 56.784416645765305 
Train [1/6] | Epoch [15/120] |	nca: 54.47796542942524, loss: 54.47796542942524 
Train [1/6] | Epoch [16/120] |	nca: 55.559927716851234, loss: 55.559927716851234 
Train [1/6] | Epoch [17/120] |	nca: 54.12913544476032, loss: 54.12913544476032 
Train [1/6] | Epoch [18/120] |	nca: 53.073642402887344, loss: 53.073642402887344 
Train [1/6] | Epoch [19/120] |	nca: 50.87010081857443, loss: 50.87010081857443 
Train [1/6] | Epoch [20/120] |	nca: 50.47608771920204, loss: 50.47608771920204 
Train [1/6] | Epoch [21/120] |	nca: 51.25454207509756, loss: 51.25454207509756 
Train [1/6] | Epoch [22/120] |	nca: 49.460700169205666, loss: 49.460700169205666 
Train [1/6] | Epoch [23/120] |	nca: 49.17236062884331, loss: 49.17236062884331 
Train [1/6] | Epoch [24/120] |	nca: 46.83349861949682, loss: 46.83349861949682 
Train [1/6] | Epoch [25/120] |	nca: 47.089063577353954, loss: 47.089063577353954 
Train [1/6] | Epoch [26/120] |	nca: 47.94596654176712, loss: 47.94596654176712 
Train [1/6] | Epoch [27/120] |	nca: 45.37578894942999, loss: 45.37578894942999 
Train [1/6] | Epoch [28/120] |	nca: 44.7356171682477, loss: 44.7356171682477 
Train [1/6] | Epoch [29/120] |	nca: 45.168326146900654, loss: 45.168326146900654 
Train [1/6] | Epoch [30/120] |	nca: 43.84719205647707, loss: 43.84719205647707 
Train [1/6] | Epoch [31/120] |	nca: 42.72599148750305, loss: 42.72599148750305 
Train [1/6] | Epoch [32/120] |	nca: 43.578373700380325, loss: 43.578373700380325 
Train [1/6] | Epoch [33/120] |	nca: 42.7602099403739, loss: 42.7602099403739 
Train [1/6] | Epoch [34/120] |	nca: 41.44649402052164, loss: 41.44649402052164 
Train [1/6] | Epoch [35/120] |	nca: 41.23208089917898, loss: 41.23208089917898 
Train [1/6] | Epoch [36/120] |	nca: 41.45045995339751, loss: 41.45045995339751 
Train [1/6] | Epoch [37/120] |	nca: 39.988542944192886, loss: 39.988542944192886 
Train [1/6] | Epoch [38/120] |	nca: 39.93265783786774, loss: 39.93265783786774 
Train [1/6] | Epoch [39/120] |	nca: 41.36157989501953, loss: 41.36157989501953 
Train [1/6] | Epoch [40/120] |	nca: 39.25457309931517, loss: 39.25457309931517 
Train [1/6] | Epoch [41/120] |	nca: 37.54802066087723, loss: 37.54802066087723 
Train [1/6] | Epoch [42/120] |	nca: 37.44420774281025, loss: 37.44420774281025 
Train [1/6] | Epoch [43/120] |	nca: 37.67340023070574, loss: 37.67340023070574 
Train [1/6] | Epoch [44/120] |	nca: 37.58645989745855, loss: 37.58645989745855 
Train [1/6] | Epoch [45/120] |	nca: 36.49546932429075, loss: 36.49546932429075 
Train [1/6] | Epoch [46/120] |	nca: 35.04204720258713, loss: 35.04204720258713 
Train [1/6] | Epoch [47/120] |	nca: 35.664037972688675, loss: 35.664037972688675 
Train [1/6] | Epoch [48/120] |	nca: 34.65353090316057, loss: 34.65353090316057 
Train [1/6] | Epoch [49/120] |	nca: 35.572185568511486, loss: 35.572185568511486 
Train [1/6] | Epoch [50/120] |	nca: 33.81679506227374, loss: 33.81679506227374 
Train [1/6] | Epoch [51/120] |	nca: 32.9052422195673, loss: 32.9052422195673 
Train [1/6] | Epoch [52/120] |	nca: 33.15567522868514, loss: 33.15567522868514 
Train [1/6] | Epoch [53/120] |	nca: 31.450403779745102, loss: 31.450403779745102 
Train [1/6] | Epoch [54/120] |	nca: 34.26010449975729, loss: 34.26010449975729 
Train [1/6] | Epoch [55/120] |	nca: 31.601949632167816, loss: 31.601949632167816 
Train [1/6] | Epoch [56/120] |	nca: 31.725672975182533, loss: 31.725672975182533 
Train [1/6] | Epoch [57/120] |	nca: 28.952415395528078, loss: 28.952415395528078 
Train [1/6] | Epoch [58/120] |	nca: 29.77424867451191, loss: 29.77424867451191 
Train [1/6] | Epoch [59/120] |	nca: 30.800806496292353, loss: 30.800806496292353 
Train [1/6] | Epoch [60/120] |	nca: 28.181162133812904, loss: 28.181162133812904 
Train [1/6] | Epoch [61/120] |	nca: 28.18985367566347, loss: 28.18985367566347 
Train [1/6] | Epoch [62/120] |	nca: 26.925289779901505, loss: 26.925289779901505 
Train [1/6] | Epoch [63/120] |	nca: 27.081361396238208, loss: 27.081361396238208 
Train [1/6] | Epoch [64/120] |	nca: 26.434019286185503, loss: 26.434019286185503 
Train [1/6] | Epoch [65/120] |	nca: 26.650334242731333, loss: 26.650334242731333 
Train [1/6] | Epoch [66/120] |	nca: 26.487534064799547, loss: 26.487534064799547 
Train [1/6] | Epoch [67/120] |	nca: 23.778376234695315, loss: 23.778376234695315 
Train [1/6] | Epoch [68/120] |	nca: 24.291168808937073, loss: 24.291168808937073 
Train [1/6] | Epoch [69/120] |	nca: 24.489956106990576, loss: 24.489956106990576 
Train [1/6] | Epoch [70/120] |	nca: 22.476315023377538, loss: 22.476315023377538 
Train [1/6] | Epoch [71/120] |	nca: 22.503997141495347, loss: 22.503997141495347 
Train [1/6] | Epoch [72/120] |	nca: 21.6598435100168, loss: 21.6598435100168 
Train [1/6] | Epoch [73/120] |	nca: 21.587385354563594, loss: 21.587385354563594 
Train [1/6] | Epoch [74/120] |	nca: 20.210880786180496, loss: 20.210880786180496 
Train [1/6] | Epoch [75/120] |	nca: 19.625069089233875, loss: 19.625069089233875 
Train [1/6] | Epoch [76/120] |	nca: 21.642834179103374, loss: 21.642834179103374 
Train [1/6] | Epoch [77/120] |	nca: 18.291334059089422, loss: 18.291334059089422 
Train [1/6] | Epoch [78/120] |	nca: 18.65569807961583, loss: 18.65569807961583 
Train [1/6] | Epoch [79/120] |	nca: 17.62219910696149, loss: 17.62219910696149 
Train [1/6] | Epoch [80/120] |	nca: 17.407912705093622, loss: 17.407912705093622 
Train [1/6] | Epoch [81/120] |	nca: 16.496454492211342, loss: 16.496454492211342 
Train [1/6] | Epoch [82/120] |	nca: 16.820061057806015, loss: 16.820061057806015 
Train [1/6] | Epoch [83/120] |	nca: 15.35195083450526, loss: 15.35195083450526 
Train [1/6] | Epoch [84/120] |	nca: 13.914684473536909, loss: 13.914684473536909 
Train [1/6] | Epoch [85/120] |	nca: 14.0109041351825, loss: 14.0109041351825 
Train [1/6] | Epoch [86/120] |	nca: 12.465625306591392, loss: 12.465625306591392 
Train [1/6] | Epoch [87/120] |	nca: 12.355045438744128, loss: 12.355045438744128 
Train [1/6] | Epoch [88/120] |	nca: 11.348202416673303, loss: 11.348202416673303 
Train [1/6] | Epoch [89/120] |	nca: 11.009868800640106, loss: 11.009868800640106 
Train [1/6] | Epoch [90/120] |	nca: 10.398885025642812, loss: 10.398885025642812 
Train [1/6] | Epoch [91/120] |	nca: 11.372860364150256, loss: 11.372860364150256 
Train [1/6] | Epoch [92/120] |	nca: 9.965923971962184, loss: 9.965923971962184 
Train [1/6] | Epoch [93/120] |	nca: 8.111091959290206, loss: 8.111091959290206 
Train [1/6] | Epoch [94/120] |	nca: 7.646015346981585, loss: 7.646015346981585 
Train [1/6] | Epoch [95/120] |	nca: 6.757473370293155, loss: 6.757473370293155 
Train [1/6] | Epoch [96/120] |	nca: 6.746314025949687, loss: 6.746314025949687 
Train [1/6] | Epoch [97/120] |	nca: 5.69044786458835, loss: 5.69044786458835 
Train [1/6] | Epoch [98/120] |	nca: 5.551049451343715, loss: 5.551049451343715 
Train [1/6] | Epoch [99/120] |	nca: 4.650478226249106, loss: 4.650478226249106 
Train [1/6] | Epoch [100/120] |	nca: 4.592842740938067, loss: 4.592842740938067 
Train [1/6] | Epoch [101/120] |	nca: 3.962735577719286, loss: 3.962735577719286 
Train [1/6] | Epoch [102/120] |	nca: 3.7106836666353047, loss: 3.7106836666353047 
Train [1/6] | Epoch [103/120] |	nca: 3.0817868828307837, loss: 3.0817868828307837 
Train [1/6] | Epoch [104/120] |	nca: 2.8189788802992553, loss: 2.8189788802992553 
Train [1/6] | Epoch [105/120] |	nca: 2.195655744872056, loss: 2.195655744872056 
Train [1/6] | Epoch [106/120] |	nca: 1.8336870921775699, loss: 1.8336870921775699 
Train [1/6] | Epoch [107/120] |	nca: 1.8560217798221856, loss: 1.8560217798221856 
Train [1/6] | Epoch [108/120] |	nca: 1.4504967533284798, loss: 1.4504967533284798 
Train [1/6] | Epoch [109/120] |	nca: 1.6059455482754856, loss: 1.6059455482754856 
Train [1/6] | Epoch [110/120] |	nca: 1.335516064427793, loss: 1.335516064427793 
Train [1/6] | Epoch [111/120] |	nca: 1.2380568476510234, loss: 1.2380568476510234 
Train [1/6] | Epoch [112/120] |	nca: 1.103980946354568, loss: 1.103980946354568 
Train [1/6] | Epoch [113/120] |	nca: 1.1307565013412386, loss: 1.1307565013412386 
Train [1/6] | Epoch [114/120] |	nca: 1.3132521962979808, loss: 1.3132521962979808 
Train [1/6] | Epoch [115/120] |	nca: 0.8999430210096762, loss: 0.8999430210096762 
Train [1/6] | Epoch [116/120] |	nca: 0.9052222461323254, loss: 0.9052222461323254 
Train [1/6] | Epoch [117/120] |	nca: 0.9571318146772683, loss: 0.9571318146772683 
Train [1/6] | Epoch [118/120] |	nca: 1.060318163363263, loss: 1.060318163363263 
Train [1/6] | Epoch [119/120] |	nca: 0.9505865636165254, loss: 0.9505865636165254 
Train [1/6] | Epoch [120/120] |	nca: 0.9351504602236673, loss: 0.9351504602236673 
after task
Building & updating memory.
after task
Eval on 0->5.
eval task
podnet_nme_cifar10_5steps
Avg inc acc: 0.971.
Current acc: {'total': 0.971, '00-09': 0.971}.
Avg inc acc top5: 1.0.
Current acc top5: {'total': 1.0}.
Forgetting: 0.0.
Cord metric: 0.97.
================Task 1 Start!================
Testing on False unseen tasks (max class = 6).
Set memory of size: 1000.
Before task
Generating imprinted weights
Multi class diff kmeans.
Now 200 examplars per class.
Group: convnet, lr: 0.1.
Group: postprocessing, lr: 0.1.
Group: new_weights, lr: 0.1.
================Task 1 Training!================
The training samples number: 6000
Train on 5->6.
train task
nb 6000.
Train [2/6] | Epoch [1/120] |	nca: 36.2642480134964, flat: 46.649911642074585, pod: 170.45712041854858, loss: 253.37128019332886 
Train [2/6] | Epoch [2/120] |	nca: 19.656562358140945, flat: 29.464866936206818, pod: 126.25778436660767, loss: 175.37921404838562 
Train [2/6] | Epoch [3/120] |	nca: 15.861443176865578, flat: 24.107642024755478, pod: 108.3094699382782, loss: 148.278555393219 
Train [2/6] | Epoch [4/120] |	nca: 14.447034016251564, flat: 21.646229177713394, pod: 99.4331784248352, loss: 135.52644228935242 
Train [2/6] | Epoch [5/120] |	nca: 13.412799537181854, flat: 20.239172279834747, pod: 92.99129676818848, loss: 126.6432683467865 
Train [2/6] | Epoch [6/120] |	nca: 13.091972976922989, flat: 19.865929424762726, pod: 90.12467157840729, loss: 123.08257412910461 
Train [2/6] | Epoch [7/120] |	nca: 11.731189534068108, flat: 18.52443903684616, pod: 83.33672642707825, loss: 113.592355966568 
Train [2/6] | Epoch [8/120] |	nca: 10.887686893343925, flat: 17.439885556697845, pod: 78.47479748725891, loss: 106.80237030982971 
Train [2/6] | Epoch [9/120] |	nca: 10.514564976096153, flat: 17.4875385761261, pod: 77.01918196678162, loss: 105.02128505706787 
Train [2/6] | Epoch [10/120] |	nca: 10.237257957458496, flat: 17.002877324819565, pod: 74.48426651954651, loss: 101.72440242767334 
Train [2/6] | Epoch [11/120] |	nca: 10.682420015335083, flat: 17.247954577207565, pod: 74.59560751914978, loss: 102.52598118782043 
Train [2/6] | Epoch [12/120] |	nca: 10.555249348282814, flat: 17.576903522014618, pod: 78.50404441356659, loss: 106.63619756698608 
Train [2/6] | Epoch [13/120] |	nca: 9.736607819795609, flat: 16.981948524713516, pod: 74.2323272228241, loss: 100.95088386535645 
Train [2/6] | Epoch [14/120] |	nca: 10.247868433594704, flat: 16.803999364376068, pod: 73.59071922302246, loss: 100.64258694648743 
Train [2/6] | Epoch [15/120] |	nca: 8.979211062192917, flat: 15.938764482736588, pod: 68.70208704471588, loss: 93.6200624704361 
Train [2/6] | Epoch [16/120] |	nca: 8.533256195485592, flat: 15.662914425134659, pod: 66.47565865516663, loss: 90.67182874679565 
Train [2/6] | Epoch [17/120] |	nca: 8.993228681385517, flat: 15.766345858573914, pod: 67.05877232551575, loss: 91.81834638118744 
Train [2/6] | Epoch [18/120] |	nca: 9.20456125587225, flat: 15.931514084339142, pod: 69.63655936717987, loss: 94.77263450622559 
Train [2/6] | Epoch [19/120] |	nca: 8.992724671959877, flat: 15.793374121189117, pod: 67.9001635313034, loss: 92.68626272678375 
Train [2/6] | Epoch [20/120] |	nca: 8.17036660015583, flat: 15.521195203065872, pod: 65.87606990337372, loss: 89.567631483078 
Train [2/6] | Epoch [21/120] |	nca: 8.108769692480564, flat: 15.427643030881882, pod: 64.94917798042297, loss: 88.48559081554413 
Train [2/6] | Epoch [22/120] |	nca: 8.811674199998379, flat: 15.92984226346016, pod: 68.53400766849518, loss: 93.27552437782288 
Train [2/6] | Epoch [23/120] |	nca: 7.989522561430931, flat: 15.445230334997177, pod: 65.20120203495026, loss: 88.63595461845398 
Train [2/6] | Epoch [24/120] |	nca: 8.53395777195692, flat: 15.139606714248657, pod: 64.20823800563812, loss: 87.88180267810822 
Train [2/6] | Epoch [25/120] |	nca: 7.449492234736681, flat: 14.956969261169434, pod: 61.934544920921326, loss: 84.34100639820099 
Train [2/6] | Epoch [26/120] |	nca: 8.340152584016323, flat: 15.230621457099915, pod: 64.67064189910889, loss: 88.24141597747803 
Train [2/6] | Epoch [27/120] |	nca: 7.66035882383585, flat: 14.959904223680496, pod: 62.81600522994995, loss: 85.43626821041107 
Train [2/6] | Epoch [28/120] |	nca: 8.085446126759052, flat: 15.06006607413292, pod: 64.73687469959259, loss: 87.88238656520844 
Train [2/6] | Epoch [29/120] |	nca: 8.368010461330414, flat: 15.615122631192207, pod: 66.67982065677643, loss: 90.66295349597931 
Train [2/6] | Epoch [30/120] |	nca: 7.89589611440897, flat: 16.065928906202316, pod: 67.80442643165588, loss: 91.76625263690948 
Train [2/6] | Epoch [31/120] |	nca: 7.604456439614296, flat: 14.723981395363808, pod: 61.537240982055664, loss: 83.86567866802216 
Train [2/6] | Epoch [32/120] |	nca: 7.208250142633915, flat: 14.304346233606339, pod: 59.072819113731384, loss: 80.58541512489319 
Train [2/6] | Epoch [33/120] |	nca: 7.728499725461006, flat: 14.861682206392288, pod: 61.69993710517883, loss: 84.29011940956116 
Train [2/6] | Epoch [34/120] |	nca: 7.1557425037026405, flat: 14.309824764728546, pod: 59.517338156700134, loss: 80.982905626297 
Train [2/6] | Epoch [35/120] |	nca: 8.727389492094517, flat: 15.614590764045715, pod: 64.49031209945679, loss: 88.83229267597198 
Train [2/6] | Epoch [36/120] |	nca: 7.566403787583113, flat: 15.2473783493042, pod: 64.78073799610138, loss: 87.59451973438263 
Train [2/6] | Epoch [37/120] |	nca: 7.170016564428806, flat: 14.440537989139557, pod: 59.78375566005707, loss: 81.39430963993073 
Train [2/6] | Epoch [38/120] |	nca: 6.74124226719141, flat: 14.34685131907463, pod: 58.16057598590851, loss: 79.24866938591003 
Train [2/6] | Epoch [39/120] |	nca: 7.3622559532523155, flat: 14.257754474878311, pod: 59.539960503578186, loss: 81.15997099876404 
Train [2/6] | Epoch [40/120] |	nca: 6.457411997020245, flat: 13.828706994652748, pod: 56.942800998687744, loss: 77.22891962528229 
Train [2/6] | Epoch [41/120] |	nca: 6.778845641762018, flat: 13.717101216316223, pod: 56.211504101753235, loss: 76.70745122432709 
Train [2/6] | Epoch [42/120] |	nca: 6.737637132406235, flat: 14.219076246023178, pod: 58.61579895019531, loss: 79.57251214981079 
Train [2/6] | Epoch [43/120] |	nca: 7.103680536150932, flat: 13.932718947529793, pod: 56.9136825799942, loss: 77.95008218288422 
Train [2/6] | Epoch [44/120] |	nca: 6.637998498976231, flat: 13.847688466310501, pod: 57.16381525993347, loss: 77.64950215816498 
Train [2/6] | Epoch [45/120] |	nca: 7.0941619127988815, flat: 13.991266995668411, pod: 57.1866739988327, loss: 78.2721027135849 
Train [2/6] | Epoch [46/120] |	nca: 7.304138600826263, flat: 14.464056685566902, pod: 60.47177505493164, loss: 82.23997056484222 
Train [2/6] | Epoch [47/120] |	nca: 6.261784709990025, flat: 13.772255897521973, pod: 56.8646183013916, loss: 76.89865934848785 
Train [2/6] | Epoch [48/120] |	nca: 5.986505210399628, flat: 13.612088724970818, pod: 55.09433710575104, loss: 74.69293129444122 
Train [2/6] | Epoch [49/120] |	nca: 6.3636733666062355, flat: 13.874633565545082, pod: 55.40747570991516, loss: 75.64578294754028 
Train [2/6] | Epoch [50/120] |	nca: 6.092426784336567, flat: 13.976794719696045, pod: 57.02337467670441, loss: 77.09259605407715 
Train [2/6] | Epoch [51/120] |	nca: 6.086939863860607, flat: 13.25327019393444, pod: 52.788374185562134, loss: 72.12858426570892 
Train [2/6] | Epoch [52/120] |	nca: 6.007954601198435, flat: 13.215933948755264, pod: 53.89974343776703, loss: 73.1236321926117 
Train [2/6] | Epoch [53/120] |	nca: 5.797925729304552, flat: 13.137455150485039, pod: 52.61382496356964, loss: 71.54920542240143 
Train [2/6] | Epoch [54/120] |	nca: 6.591508828103542, flat: 13.797228768467903, pod: 56.076337456703186, loss: 76.46507525444031 
Train [2/6] | Epoch [55/120] |	nca: 5.978492747992277, flat: 13.266473516821861, pod: 52.98272329568863, loss: 72.22768950462341 
Train [2/6] | Epoch [56/120] |	nca: 6.019370950758457, flat: 13.393388494849205, pod: 53.82570791244507, loss: 73.2384672164917 
Train [2/6] | Epoch [57/120] |	nca: 6.471759352833033, flat: 13.289362728595734, pod: 52.70926296710968, loss: 72.47038519382477 
Train [2/6] | Epoch [58/120] |	nca: 5.532429795712233, flat: 13.016437783837318, pod: 51.04398316144943, loss: 69.59285080432892 
Train [2/6] | Epoch [59/120] |	nca: 5.866029258817434, flat: 13.243877664208412, pod: 51.98030710220337, loss: 71.09021413326263 
Train [2/6] | Epoch [60/120] |	nca: 5.415767043828964, flat: 13.035401582717896, pod: 51.37932777404785, loss: 69.83049583435059 
Train [2/6] | Epoch [61/120] |	nca: 5.837475925683975, flat: 13.044690489768982, pod: 49.40056759119034, loss: 68.28273403644562 
Train [2/6] | Epoch [62/120] |	nca: 5.742093712091446, flat: 12.883248046040535, pod: 50.74277901649475, loss: 69.36812090873718 
Train [2/6] | Epoch [63/120] |	nca: 5.454463850706816, flat: 12.736418217420578, pod: 48.735132932662964, loss: 66.92601501941681 
Train [2/6] | Epoch [64/120] |	nca: 5.188194677233696, flat: 12.46590669453144, pod: 48.924181163311005, loss: 66.57828307151794 
Train [2/6] | Epoch [65/120] |	nca: 5.334306824952364, flat: 12.471859768033028, pod: 48.5596439242363, loss: 66.36581099033356 
Train [2/6] | Epoch [66/120] |	nca: 5.319617107510567, flat: 12.698765113949776, pod: 47.94830900430679, loss: 65.96669125556946 
Train [2/6] | Epoch [67/120] |	nca: 5.499006412923336, flat: 12.70829276740551, pod: 48.52704930305481, loss: 66.73434865474701 
Train [2/6] | Epoch [68/120] |	nca: 5.610298737883568, flat: 12.78909157216549, pod: 48.930935740470886, loss: 67.33032596111298 
Train [2/6] | Epoch [69/120] |	nca: 5.648649863898754, flat: 13.18693570792675, pod: 50.69995981454849, loss: 69.5355452299118 
Train [2/6] | Epoch [70/120] |	nca: 4.695925675332546, flat: 12.538578107953072, pod: 47.279635429382324, loss: 64.51413929462433 
Train [2/6] | Epoch [71/120] |	nca: 4.693079516291618, flat: 12.170731097459793, pod: 45.32060796022415, loss: 62.18441843986511 
Train [2/6] | Epoch [72/120] |	nca: 4.951647378504276, flat: 12.114201039075851, pod: 45.49481576681137, loss: 62.56066393852234 
Train [2/6] | Epoch [73/120] |	nca: 5.738869853317738, flat: 12.395557209849358, pod: 46.39569443464279, loss: 64.53012108802795 
Train [2/6] | Epoch [74/120] |	nca: 4.804611403495073, flat: 12.054473146796227, pod: 45.80757236480713, loss: 62.66665732860565 
Train [2/6] | Epoch [75/120] |	nca: 4.935215514153242, flat: 12.149734571576118, pod: 44.82892453670502, loss: 61.91387498378754 
Train [2/6] | Epoch [76/120] |	nca: 5.072832107543945, flat: 12.262602344155312, pod: 46.31340283155441, loss: 63.64883780479431 
Train [2/6] | Epoch [77/120] |	nca: 4.90032871440053, flat: 12.045843541622162, pod: 44.01433855295181, loss: 60.960511207580566 
Train [2/6] | Epoch [78/120] |	nca: 4.305424254387617, flat: 11.866696745157242, pod: 43.18574905395508, loss: 59.357870221138 
Train [2/6] | Epoch [79/120] |	nca: 4.390756171196699, flat: 11.931593596935272, pod: 42.7187774181366, loss: 59.04112696647644 
Train [2/6] | Epoch [80/120] |	nca: 4.371232617646456, flat: 11.78660337626934, pod: 42.40475708246231, loss: 58.56259334087372 
Train [2/6] | Epoch [81/120] |	nca: 4.5499455109238625, flat: 11.776530489325523, pod: 41.90837574005127, loss: 58.234851479530334 
Train [2/6] | Epoch [82/120] |	nca: 4.462809842079878, flat: 11.862462371587753, pod: 41.84564137458801, loss: 58.17091393470764 
Train [2/6] | Epoch [83/120] |	nca: 4.570056822150946, flat: 11.857378914952278, pod: 40.9739573597908, loss: 57.40139293670654 
Train [2/6] | Epoch [84/120] |	nca: 4.107740640640259, flat: 11.737418532371521, pod: 39.58715373277664, loss: 55.43231272697449 
Train [2/6] | Epoch [85/120] |	nca: 4.002949867397547, flat: 11.532597497105598, pod: 40.14691811800003, loss: 55.6824654340744 
Train [2/6] | Epoch [86/120] |	nca: 3.859077088534832, flat: 11.31928464770317, pod: 38.50191152095795, loss: 53.68027317523956 
Train [2/6] | Epoch [87/120] |	nca: 4.197020184248686, flat: 11.379180669784546, pod: 39.08979707956314, loss: 54.66599762439728 
Train [2/6] | Epoch [88/120] |	nca: 4.073579713702202, flat: 11.347700029611588, pod: 39.35273838043213, loss: 54.77401804924011 
Train [2/6] | Epoch [89/120] |	nca: 4.261130474507809, flat: 11.485431209206581, pod: 39.13078784942627, loss: 54.87734937667847 
Train [2/6] | Epoch [90/120] |	nca: 4.096768151968718, flat: 11.26606097817421, pod: 37.81486874818802, loss: 53.1776978969574 
Train [2/6] | Epoch [91/120] |	nca: 4.261573825031519, flat: 11.130889609456062, pod: 36.97826135158539, loss: 52.37072467803955 
Train [2/6] | Epoch [92/120] |	nca: 3.861319314688444, flat: 11.241168841719627, pod: 37.11301010847092, loss: 52.21549814939499 
Train [2/6] | Epoch [93/120] |	nca: 3.9900364093482494, flat: 11.21541902422905, pod: 37.39440983533859, loss: 52.59986490011215 
Train [2/6] | Epoch [94/120] |	nca: 3.577421572059393, flat: 11.00531131029129, pod: 35.52555751800537, loss: 50.10829043388367 
Train [2/6] | Epoch [95/120] |	nca: 3.8479351215064526, flat: 11.093873023986816, pod: 35.2406747341156, loss: 50.18248265981674 
Train [2/6] | Epoch [96/120] |	nca: 3.7234314046800137, flat: 10.877999886870384, pod: 35.2824649810791, loss: 49.88389629125595 
Train [2/6] | Epoch [97/120] |	nca: 3.503130469471216, flat: 11.065925598144531, pod: 35.14626586437225, loss: 49.71532195806503 
Train [2/6] | Epoch [98/120] |	nca: 3.5334819704294205, flat: 10.964506819844246, pod: 34.92597550153732, loss: 49.42396426200867 
Train [2/6] | Epoch [99/120] |	nca: 3.4646373577415943, flat: 10.891499772667885, pod: 34.456074595451355, loss: 48.812211990356445 
Train [2/6] | Epoch [100/120] |	nca: 3.6951303258538246, flat: 10.666957169771194, pod: 33.66208750009537, loss: 48.02417504787445 
Train [2/6] | Epoch [101/120] |	nca: 3.5480588264763355, flat: 10.901344805955887, pod: 33.84103190898895, loss: 48.29043585062027 
Train [2/6] | Epoch [102/120] |	nca: 3.568507056683302, flat: 10.960040614008904, pod: 33.585398495197296, loss: 48.11394566297531 
Train [2/6] | Epoch [103/120] |	nca: 3.5885521061718464, flat: 10.82623040676117, pod: 34.042914152145386, loss: 48.45769703388214 
Train [2/6] | Epoch [104/120] |	nca: 3.4964316077530384, flat: 10.656450062990189, pod: 32.576463401317596, loss: 46.72934478521347 
Train [2/6] | Epoch [105/120] |	nca: 3.386440698057413, flat: 10.487718030810356, pod: 32.578389286994934, loss: 46.452547907829285 
Train [2/6] | Epoch [106/120] |	nca: 3.7025417275726795, flat: 10.693015933036804, pod: 32.87209892272949, loss: 47.267656683921814 
Train [2/6] | Epoch [107/120] |	nca: 3.108830116689205, flat: 10.771586522459984, pod: 32.16363471746445, loss: 46.0440514087677 
Train [2/6] | Epoch [108/120] |	nca: 3.3633232302963734, flat: 10.725229889154434, pod: 32.20799869298935, loss: 46.29655164480209 
Train [2/6] | Epoch [109/120] |	nca: 3.3045060597360134, flat: 10.587239846587181, pod: 32.03387647867203, loss: 45.92562258243561 
Train [2/6] | Epoch [110/120] |	nca: 3.181325301527977, flat: 10.496009811758995, pod: 31.689433991909027, loss: 45.366769194602966 
Train [2/6] | Epoch [111/120] |	nca: 3.1889957562088966, flat: 10.491936847567558, pod: 31.562471747398376, loss: 45.24340456724167 
Train [2/6] | Epoch [112/120] |	nca: 3.098967485129833, flat: 10.561308786273003, pod: 30.788063168525696, loss: 44.44833958148956 
Train [2/6] | Epoch [113/120] |	nca: 3.215461529791355, flat: 10.426376894116402, pod: 31.073459327220917, loss: 44.71529793739319 
Train [2/6] | Epoch [114/120] |	nca: 3.1102187782526016, flat: 10.412456035614014, pod: 30.9007608294487, loss: 44.423435509204865 
Train [2/6] | Epoch [115/120] |	nca: 3.242502799257636, flat: 10.595485806465149, pod: 31.32864671945572, loss: 45.166635036468506 
Train [2/6] | Epoch [116/120] |	nca: 3.0298200733959675, flat: 10.418483138084412, pod: 31.434412479400635, loss: 44.882715821266174 
Train [2/6] | Epoch [117/120] |	nca: 3.2116016559302807, flat: 10.562661275267601, pod: 30.668311893939972, loss: 44.44257491827011 
Train [2/6] | Epoch [118/120] |	nca: 3.0267608016729355, flat: 10.37191827595234, pod: 30.484832048416138, loss: 43.88351136445999 
Train [2/6] | Epoch [119/120] |	nca: 3.3740728832781315, flat: 10.454400703310966, pod: 30.847735047340393, loss: 44.676208674907684 
Train [2/6] | Epoch [120/120] |	nca: 3.2804819755256176, flat: 10.344995900988579, pod: 30.377004384994507, loss: 44.002482175827026 
Fine-tuning
Building & updating memory.
Train [2/6] | Epoch [121/140] |	nca: 3.1789835691452026, flat: 4.760334074497223, pod: 14.7043536901474, loss: 22.6436710357666 
Train [2/6] | Epoch [122/140] |	nca: 1.9278573989868164, flat: 4.635224461555481, pod: 14.616271018981934, loss: 21.17935299873352 
Train [2/6] | Epoch [123/140] |	nca: 1.3338659033179283, flat: 4.7642307579517365, pod: 15.057746767997742, loss: 21.15584373474121 
Train [2/6] | Epoch [124/140] |	nca: 1.2847567647695541, flat: 4.795023202896118, pod: 15.029282569885254, loss: 21.10906231403351 
Train [2/6] | Epoch [125/140] |	nca: 1.3519699946045876, flat: 4.654876559972763, pod: 14.826932549476624, loss: 20.833778858184814 
Train [2/6] | Epoch [126/140] |	nca: 1.021959014236927, flat: 4.740775257349014, pod: 14.684123873710632, loss: 20.446858286857605 
Train [2/6] | Epoch [127/140] |	nca: 1.1522838845849037, flat: 4.654158800840378, pod: 14.791046261787415, loss: 20.59748888015747 
Train [2/6] | Epoch [128/140] |	nca: 0.9468382894992828, flat: 4.774006813764572, pod: 14.80689549446106, loss: 20.527740836143494 
Train [2/6] | Epoch [129/140] |	nca: 1.0093495920300484, flat: 4.742562115192413, pod: 14.950714111328125, loss: 20.70262598991394 
Train [2/6] | Epoch [130/140] |	nca: 0.962017372250557, flat: 4.86715891957283, pod: 15.012577056884766, loss: 20.841753005981445 
Train [2/6] | Epoch [131/140] |	nca: 0.9403890781104565, flat: 4.742277383804321, pod: 14.87531840801239, loss: 20.557984709739685 
Train [2/6] | Epoch [132/140] |	nca: 0.9996674582362175, flat: 4.697528719902039, pod: 14.727208018302917, loss: 20.42440438270569 
Train [2/6] | Epoch [133/140] |	nca: 0.893733561038971, flat: 4.6338368356227875, pod: 14.82163679599762, loss: 20.349207282066345 
Train [2/6] | Epoch [134/140] |	nca: 0.9731814861297607, flat: 4.703869462013245, pod: 14.827815651893616, loss: 20.50486648082733 
Train [2/6] | Epoch [135/140] |	nca: 0.8312202580273151, flat: 4.755743086338043, pod: 14.883662819862366, loss: 20.47062635421753 
Train [2/6] | Epoch [136/140] |	nca: 0.9486947879195213, flat: 4.6218386590480804, pod: 14.554638981819153, loss: 20.12517237663269 
Train [2/6] | Epoch [137/140] |	nca: 1.142678864300251, flat: 4.728566259145737, pod: 14.912185192108154, loss: 20.783430218696594 
Train [2/6] | Epoch [138/140] |	nca: 1.053867556154728, flat: 4.89794859290123, pod: 15.228613138198853, loss: 21.180429458618164 
Train [2/6] | Epoch [139/140] |	nca: 1.0700986459851265, flat: 4.768859535455704, pod: 15.048599600791931, loss: 20.88755750656128 
Train [2/6] | Epoch [140/140] |	nca: 0.8963722139596939, flat: 4.9072451293468475, pod: 15.215693831443787, loss: 21.01931130886078 
after task
Building & updating memory.
after task
Eval on 0->6.
eval task
podnet_nme_cifar10_5steps
Avg inc acc: 0.9125.
Current acc: {'total': 0.854, '00-09': 0.854}.
Avg inc acc top5: 1.0.
Current acc top5: {'total': 1.0}.
Forgetting: 0.058499999999999996.
Cord metric: 0.88.
Old accuracy: 0.91, mean: 0.91.
New accuracy: 0.59, mean: 0.59.
================Task 2 Start!================
Testing on False unseen tasks (max class = 7).
Set memory of size: 1200.
Before task
Generating imprinted weights
Multi class diff kmeans.
Now 200 examplars per class.
Group: convnet, lr: 0.1.
Group: postprocessing, lr: 0.1.
Group: new_weights, lr: 0.1.
================Task 2 Training!================
The training samples number: 6200
Train on 6->7.
train task
nb 6200.
Train [3/6] | Epoch [1/120] |	nca: 18.8397234082222, flat: 21.503390669822693, pod: 101.36973834037781, loss: 141.71285367012024 
Train [3/6] | Epoch [2/120] |	nca: 10.673900030553341, flat: 10.602696418762207, pod: 68.48889660835266, loss: 89.76549339294434 
Train [3/6] | Epoch [3/120] |	nca: 8.287144161760807, flat: 8.570855438709259, pod: 61.143476128578186, loss: 78.00147581100464 
Train [3/6] | Epoch [4/120] |	nca: 7.930077791213989, flat: 7.942850351333618, pod: 59.336196184158325, loss: 75.20912396907806 
Train [3/6] | Epoch [5/120] |	nca: 8.100632421672344, flat: 7.704943776130676, pod: 58.40711832046509, loss: 74.21269512176514 
Train [3/6] | Epoch [6/120] |	nca: 7.7116333320736885, flat: 7.405321009457111, pod: 56.45103311538696, loss: 71.56798720359802 
Train [3/6] | Epoch [7/120] |	nca: 7.169065669178963, flat: 7.473070524632931, pod: 57.550403237342834, loss: 72.19253969192505 
Train [3/6] | Epoch [8/120] |	nca: 6.641084499657154, flat: 7.183419801294804, pod: 55.554199039936066, loss: 69.37870335578918 
Train [3/6] | Epoch [9/120] |	nca: 6.208750080317259, flat: 6.727927424013615, pod: 51.88623631000519, loss: 64.82291388511658 
Train [3/6] | Epoch [10/120] |	nca: 6.466885931789875, flat: 6.790318593382835, pod: 52.93139439821243, loss: 66.18859922885895 
Train [3/6] | Epoch [11/120] |	nca: 6.363485626876354, flat: 6.856590822339058, pod: 54.54555857181549, loss: 67.76563489437103 
Train [3/6] | Epoch [12/120] |	nca: 5.642934188246727, flat: 6.22455058246851, pod: 51.094426572322845, loss: 62.96191143989563 
Train [3/6] | Epoch [13/120] |	nca: 6.307133004069328, flat: 6.675614930689335, pod: 52.644238114356995, loss: 65.62698578834534 
Train [3/6] | Epoch [14/120] |	nca: 5.992973819375038, flat: 6.52835626155138, pod: 51.8003648519516, loss: 64.32169508934021 
Train [3/6] | Epoch [15/120] |	nca: 5.8463247530162334, flat: 6.665327839553356, pod: 53.39712852239609, loss: 65.90878105163574 
Train [3/6] | Epoch [16/120] |	nca: 5.630641091614962, flat: 6.42873165756464, pod: 51.67784184217453, loss: 63.73721468448639 
Train [3/6] | Epoch [17/120] |	nca: 5.8336193561553955, flat: 6.135021768510342, pod: 50.823607206344604, loss: 62.792248010635376 
Train [3/6] | Epoch [18/120] |	nca: 5.898783542215824, flat: 6.361888870596886, pod: 51.258628726005554, loss: 63.51930129528046 
Train [3/6] | Epoch [19/120] |	nca: 5.437980402261019, flat: 6.370909251272678, pod: 52.02331966161728, loss: 63.83220946788788 
Train [3/6] | Epoch [20/120] |	nca: 6.04134576022625, flat: 6.058513790369034, pod: 50.05183702707291, loss: 62.15169668197632 
Train [3/6] | Epoch [21/120] |	nca: 5.490880113095045, flat: 6.401053421199322, pod: 52.596540570259094, loss: 64.48847389221191 
Train [3/6] | Epoch [22/120] |	nca: 5.312072180211544, flat: 5.903681010007858, pod: 49.93975043296814, loss: 61.15550351142883 
Train [3/6] | Epoch [23/120] |	nca: 4.835852161049843, flat: 5.700367607176304, pod: 48.531938433647156, loss: 59.06815779209137 
Train [3/6] | Epoch [24/120] |	nca: 5.219633717089891, flat: 5.854492001235485, pod: 49.37997251749039, loss: 60.45409798622131 
Train [3/6] | Epoch [25/120] |	nca: 5.45330522954464, flat: 6.0080737471580505, pod: 49.179586708545685, loss: 60.640965819358826 
Train [3/6] | Epoch [26/120] |	nca: 5.094491209834814, flat: 6.357115410268307, pod: 52.987450301647186, loss: 64.43905675411224 
Train [3/6] | Epoch [27/120] |	nca: 5.135100670158863, flat: 6.059709288179874, pod: 50.30099606513977, loss: 61.495805859565735 
Train [3/6] | Epoch [28/120] |	nca: 5.392691221088171, flat: 6.180150307714939, pod: 51.49322456121445, loss: 63.06606578826904 
Train [3/6] | Epoch [29/120] |	nca: 4.9823622815310955, flat: 6.003858581185341, pod: 50.45334094762802, loss: 61.43956172466278 
Train [3/6] | Epoch [30/120] |	nca: 5.423227369785309, flat: 6.035372830927372, pod: 50.00203758478165, loss: 61.46063780784607 
Train [3/6] | Epoch [31/120] |	nca: 4.357539992779493, flat: 5.724782548844814, pod: 48.002486288547516, loss: 58.08480882644653 
Train [3/6] | Epoch [32/120] |	nca: 4.945782296359539, flat: 5.661227449774742, pod: 48.12907159328461, loss: 58.73608136177063 
Train [3/6] | Epoch [33/120] |	nca: 5.54981017485261, flat: 6.07339309155941, pod: 50.40373122692108, loss: 62.02693474292755 
Train [3/6] | Epoch [34/120] |	nca: 4.841035280376673, flat: 5.5276468470692635, pod: 46.93227815628052, loss: 57.300960183143616 
Train [3/6] | Epoch [35/120] |	nca: 5.556075591593981, flat: 6.199552275240421, pod: 50.64726001024246, loss: 62.4028879404068 
Train [3/6] | Epoch [36/120] |	nca: 4.5498922020196915, flat: 5.923298925161362, pod: 49.171962916851044, loss: 59.64515459537506 
Train [3/6] | Epoch [37/120] |	nca: 4.473567198961973, flat: 5.581336252391338, pod: 47.10712629556656, loss: 57.16202962398529 
Train [3/6] | Epoch [38/120] |	nca: 4.7027865163981915, flat: 5.693112939596176, pod: 48.132684111595154, loss: 58.52858364582062 
Train [3/6] | Epoch [39/120] |	nca: 4.324689544737339, flat: 5.366721287369728, pod: 45.545378386974335, loss: 55.2367889881134 
Train [3/6] | Epoch [40/120] |	nca: 5.2501285914331675, flat: 6.188125371932983, pod: 50.36474817991257, loss: 61.80300223827362 
Train [3/6] | Epoch [41/120] |	nca: 3.9678976871073246, flat: 5.608207680284977, pod: 47.311191380023956, loss: 56.88729614019394 
Train [3/6] | Epoch [42/120] |	nca: 4.63139345869422, flat: 5.487363398075104, pod: 47.24779200553894, loss: 57.36654889583588 
Train [3/6] | Epoch [43/120] |	nca: 4.473242502659559, flat: 5.685017302632332, pod: 46.60497289896011, loss: 56.763232827186584 
Train [3/6] | Epoch [44/120] |	nca: 4.453539177775383, flat: 5.2603044882416725, pod: 45.09393912553787, loss: 54.807783007621765 
Train [3/6] | Epoch [45/120] |	nca: 4.180199200287461, flat: 5.627698749303818, pod: 47.06286859512329, loss: 56.870766282081604 
Train [3/6] | Epoch [46/120] |	nca: 4.363127186894417, flat: 5.539149045944214, pod: 47.32691806554794, loss: 57.22919404506683 
Train [3/6] | Epoch [47/120] |	nca: 4.681111421436071, flat: 5.6188871413469315, pod: 46.3055624961853, loss: 56.6055611371994 
Train [3/6] | Epoch [48/120] |	nca: 4.442943945527077, flat: 5.433484293520451, pod: 46.64809799194336, loss: 56.524525821208954 
Train [3/6] | Epoch [49/120] |	nca: 3.8781485110521317, flat: 5.250096432864666, pod: 45.568666219711304, loss: 54.69691127538681 
Train [3/6] | Epoch [50/120] |	nca: 4.131578203290701, flat: 5.230134882032871, pod: 44.5263677239418, loss: 53.888081073760986 
Train [3/6] | Epoch [51/120] |	nca: 3.820852441713214, flat: 5.077052175998688, pod: 42.665553987026215, loss: 51.5634588599205 
Train [3/6] | Epoch [52/120] |	nca: 4.027050813660026, flat: 5.154098324477673, pod: 44.19733315706253, loss: 53.37848228216171 
Train [3/6] | Epoch [53/120] |	nca: 3.959275584667921, flat: 5.44815157353878, pod: 44.476062536239624, loss: 53.883489429950714 
Train [3/6] | Epoch [54/120] |	nca: 3.7907352410256863, flat: 5.033624358475208, pod: 42.101947605609894, loss: 50.926306903362274 
Train [3/6] | Epoch [55/120] |	nca: 4.220804166048765, flat: 5.120505183935165, pod: 41.93237942457199, loss: 51.27368867397308 
Train [3/6] | Epoch [56/120] |	nca: 4.3268183544278145, flat: 5.3839797377586365, pod: 43.676174342632294, loss: 53.386972427368164 
Train [3/6] | Epoch [57/120] |	nca: 3.34196999669075, flat: 5.005064815282822, pod: 42.09190171957016, loss: 50.438936948776245 
Train [3/6] | Epoch [58/120] |	nca: 3.940586531534791, flat: 4.963850915431976, pod: 41.75888782739639, loss: 50.66332525014877 
Train [3/6] | Epoch [59/120] |	nca: 3.9797164127230644, flat: 5.412788517773151, pod: 44.08853214979172, loss: 53.48103731870651 
Train [3/6] | Epoch [60/120] |	nca: 4.001406621187925, flat: 5.062766708433628, pod: 42.055077373981476, loss: 51.119250774383545 
Train [3/6] | Epoch [61/120] |	nca: 3.658971294760704, flat: 4.717508673667908, pod: 39.55009377002716, loss: 47.926573753356934 
Train [3/6] | Epoch [62/120] |	nca: 3.5091110970824957, flat: 4.922691620886326, pod: 40.980348110198975, loss: 49.41215109825134 
Train [3/6] | Epoch [63/120] |	nca: 3.7906754575669765, flat: 5.028418123722076, pod: 42.00582814216614, loss: 50.82492160797119 
Train [3/6] | Epoch [64/120] |	nca: 3.5928768645972013, flat: 4.905026912689209, pod: 40.59966665506363, loss: 49.0975706577301 
Train [3/6] | Epoch [65/120] |	nca: 3.326300697401166, flat: 4.829973414540291, pod: 40.078273355960846, loss: 48.234547555446625 
Train [3/6] | Epoch [66/120] |	nca: 3.500921044498682, flat: 4.732510149478912, pod: 38.848872423172, loss: 47.08230364322662 
Train [3/6] | Epoch [67/120] |	nca: 3.4420680962502956, flat: 4.747589617967606, pod: 39.80155950784683, loss: 47.991217374801636 
Train [3/6] | Epoch [68/120] |	nca: 3.7241927161812782, flat: 4.57706468552351, pod: 38.5910347700119, loss: 46.89229208230972 
Train [3/6] | Epoch [69/120] |	nca: 3.3713287319988012, flat: 4.692897371947765, pod: 38.50602412223816, loss: 46.570250391960144 
Train [3/6] | Epoch [70/120] |	nca: 3.0176453664898872, flat: 4.5194224789738655, pod: 37.971892952919006, loss: 45.50896072387695 
Train [3/6] | Epoch [71/120] |	nca: 3.2534387595951557, flat: 4.643294274806976, pod: 38.47546178102493, loss: 46.37219476699829 
Train [3/6] | Epoch [72/120] |	nca: 3.2440009880810976, flat: 4.514921247959137, pod: 36.88145691156387, loss: 44.64037883281708 
Train [3/6] | Epoch [73/120] |	nca: 3.3903291411697865, flat: 4.566777154803276, pod: 38.213589668273926, loss: 46.17069602012634 
Train [3/6] | Epoch [74/120] |	nca: 3.047677878290415, flat: 4.648293651640415, pod: 38.349486351013184, loss: 46.04545772075653 
Train [3/6] | Epoch [75/120] |	nca: 3.198843374848366, flat: 4.3304183185100555, pod: 36.03568232059479, loss: 43.56494379043579 
Train [3/6] | Epoch [76/120] |	nca: 2.8664569091051817, flat: 4.290320090949535, pod: 35.70978766679764, loss: 42.86656469106674 
Train [3/6] | Epoch [77/120] |	nca: 2.703159460797906, flat: 4.368284471333027, pod: 36.16392606496811, loss: 43.235369980335236 
Train [3/6] | Epoch [78/120] |	nca: 2.6894695349037647, flat: 4.291521966457367, pod: 35.70509600639343, loss: 42.68608766794205 
Train [3/6] | Epoch [79/120] |	nca: 2.587262712419033, flat: 4.1288821920752525, pod: 34.243920624256134, loss: 40.96006542444229 
Train [3/6] | Epoch [80/120] |	nca: 2.7680395767092705, flat: 4.048267364501953, pod: 33.521053194999695, loss: 40.3373601436615 
Train [3/6] | Epoch [81/120] |	nca: 2.3837349116802216, flat: 3.95977383852005, pod: 32.98171752691269, loss: 39.32522624731064 
Train [3/6] | Epoch [82/120] |	nca: 2.652151733636856, flat: 3.8869578391313553, pod: 33.31803458929062, loss: 39.85714399814606 
Train [3/6] | Epoch [83/120] |	nca: 2.8839547466486692, flat: 4.313999950885773, pod: 34.56351590156555, loss: 41.76147049665451 
Train [3/6] | Epoch [84/120] |	nca: 2.7359161227941513, flat: 4.089049458503723, pod: 33.56539112329483, loss: 40.390356719493866 
Train [3/6] | Epoch [85/120] |	nca: 2.6524361576884985, flat: 3.952686555683613, pod: 31.86948972940445, loss: 38.47461223602295 
Train [3/6] | Epoch [86/120] |	nca: 2.4525993168354034, flat: 3.9420411996543407, pod: 31.680284440517426, loss: 38.074924767017365 
Train [3/6] | Epoch [87/120] |	nca: 2.683985034003854, flat: 3.9822160080075264, pod: 32.249229311943054, loss: 38.915430426597595 
Train [3/6] | Epoch [88/120] |	nca: 2.5232809837907553, flat: 3.966270573437214, pod: 31.53317403793335, loss: 38.02272546291351 
Train [3/6] | Epoch [89/120] |	nca: 2.4436875507235527, flat: 3.6699607372283936, pod: 29.374020099639893, loss: 35.487668216228485 
Train [3/6] | Epoch [90/120] |	nca: 2.4833625480532646, flat: 3.847215097397566, pod: 30.964534521102905, loss: 37.29511201381683 
Train [3/6] | Epoch [91/120] |	nca: 2.4927978515625, flat: 3.807115778326988, pod: 29.926365971565247, loss: 36.226279616355896 
Train [3/6] | Epoch [92/120] |	nca: 2.518672237172723, flat: 3.8399059548974037, pod: 29.791245877742767, loss: 36.14982408285141 
Train [3/6] | Epoch [93/120] |	nca: 2.3780627828091383, flat: 3.692440655082464, pod: 29.813879400491714, loss: 35.8843829035759 
Train [3/6] | Epoch [94/120] |	nca: 2.4343961104750633, flat: 3.8563483506441116, pod: 30.307145953178406, loss: 36.59789043664932 
Train [3/6] | Epoch [95/120] |	nca: 2.2440140824764967, flat: 3.6515680365264416, pod: 28.848180264234543, loss: 34.743762373924255 
Train [3/6] | Epoch [96/120] |	nca: 2.207442158833146, flat: 3.614886049181223, pod: 27.619899332523346, loss: 33.442227721214294 
Train [3/6] | Epoch [97/120] |	nca: 2.2925673201680183, flat: 3.6299412958323956, pod: 28.88312005996704, loss: 34.80562889575958 
Train [3/6] | Epoch [98/120] |	nca: 2.216872861608863, flat: 3.5885936953127384, pod: 27.587280362844467, loss: 33.392746925354004 
Train [3/6] | Epoch [99/120] |	nca: 2.2922377958893776, flat: 3.5827130302786827, pod: 27.222136288881302, loss: 33.097087144851685 
Train [3/6] | Epoch [100/120] |	nca: 2.2003304921090603, flat: 3.5854600109159946, pod: 27.330375880002975, loss: 33.11616635322571 
Train [3/6] | Epoch [101/120] |	nca: 2.300926685333252, flat: 3.4525558911263943, pod: 27.03202459216118, loss: 32.78550720214844 
Train [3/6] | Epoch [102/120] |	nca: 1.885009715333581, flat: 3.5071588195860386, pod: 27.047139167785645, loss: 32.43930757045746 
Train [3/6] | Epoch [103/120] |	nca: 2.1421872414648533, flat: 3.348970517516136, pod: 25.782935172319412, loss: 31.274092853069305 
Train [3/6] | Epoch [104/120] |	nca: 2.0188737120479345, flat: 3.3134517036378384, pod: 25.100637763738632, loss: 30.432963132858276 
Train [3/6] | Epoch [105/120] |	nca: 2.097922295331955, flat: 3.4195895679295063, pod: 26.07198080420494, loss: 31.589492559432983 
Train [3/6] | Epoch [106/120] |	nca: 1.9966773018240929, flat: 3.3969170227646828, pod: 26.167798072099686, loss: 31.561392307281494 
Train [3/6] | Epoch [107/120] |	nca: 1.997864969074726, flat: 3.3905476592481136, pod: 25.132010728120804, loss: 30.52042344212532 
Train [3/6] | Epoch [108/120] |	nca: 2.1297536119818687, flat: 3.3021085672080517, pod: 25.20980790257454, loss: 30.64167010784149 
Train [3/6] | Epoch [109/120] |	nca: 2.025396805256605, flat: 3.4020973592996597, pod: 25.37874808907509, loss: 30.806242406368256 
Train [3/6] | Epoch [110/120] |	nca: 2.0144612547010183, flat: 3.2884126231074333, pod: 24.293486893177032, loss: 29.59636080265045 
Train [3/6] | Epoch [111/120] |	nca: 1.9939354825764894, flat: 3.2660166285932064, pod: 24.426160514354706, loss: 29.686112642288208 
Train [3/6] | Epoch [112/120] |	nca: 1.9683275762945414, flat: 3.24861316382885, pod: 23.9703029692173, loss: 29.187243789434433 
Train [3/6] | Epoch [113/120] |	nca: 1.886030737310648, flat: 3.2149697989225388, pod: 23.68082746863365, loss: 28.781827837228775 
Train [3/6] | Epoch [114/120] |	nca: 1.9453509133309126, flat: 3.3144041523337364, pod: 24.180677384138107, loss: 29.440432369709015 
Train [3/6] | Epoch [115/120] |	nca: 2.0553927067667246, flat: 3.1797686368227005, pod: 23.210993885993958, loss: 28.446155339479446 
Train [3/6] | Epoch [116/120] |	nca: 1.9239704739302397, flat: 3.231604188680649, pod: 23.91256821155548, loss: 29.068143099546432 
Train [3/6] | Epoch [117/120] |	nca: 1.87326904758811, flat: 3.2407092340290546, pod: 23.76409739255905, loss: 28.87807559967041 
Train [3/6] | Epoch [118/120] |	nca: 1.9768002089112997, flat: 3.192817248404026, pod: 23.13554385304451, loss: 28.305161356925964 
Train [3/6] | Epoch [119/120] |	nca: 2.055823417380452, flat: 3.148309674113989, pod: 23.007524490356445, loss: 28.21165770292282 
Train [3/6] | Epoch [120/120] |	nca: 1.9917801078408957, flat: 3.2727585062384605, pod: 23.73400592803955, loss: 28.998544424772263 
Fine-tuning
Building & updating memory.
Train [3/6] | Epoch [121/140] |	nca: 5.096423998475075, flat: 2.654236674308777, pod: 20.152133464813232, loss: 27.902793884277344 
Train [3/6] | Epoch [122/140] |	nca: 2.648779734969139, flat: 2.72425939142704, pod: 20.39576828479767, loss: 25.76880717277527 
Train [3/6] | Epoch [123/140] |	nca: 2.1597789376974106, flat: 2.6762216091156006, pod: 20.290345072746277, loss: 25.12634527683258 
Train [3/6] | Epoch [124/140] |	nca: 1.6638397350907326, flat: 2.6596879959106445, pod: 20.246349096298218, loss: 24.56987690925598 
Train [3/6] | Epoch [125/140] |	nca: 1.5250026509165764, flat: 2.6568826138973236, pod: 20.207852363586426, loss: 24.389737725257874 
Train [3/6] | Epoch [126/140] |	nca: 1.579056091606617, flat: 2.7027911692857742, pod: 20.33431041240692, loss: 24.616157293319702 
Train [3/6] | Epoch [127/140] |	nca: 1.2910501211881638, flat: 2.720710650086403, pod: 20.49486780166626, loss: 24.50662875175476 
Train [3/6] | Epoch [128/140] |	nca: 1.4079517349600792, flat: 2.7189026176929474, pod: 20.449554681777954, loss: 24.576408863067627 
Train [3/6] | Epoch [129/140] |	nca: 1.1846593990921974, flat: 2.6780868470668793, pod: 20.220539450645447, loss: 24.083285808563232 
Train [3/6] | Epoch [130/140] |	nca: 1.2490257620811462, flat: 2.6856189966201782, pod: 20.328598141670227, loss: 24.263242840766907 
Train [3/6] | Epoch [131/140] |	nca: 1.1382528617978096, flat: 2.6707055270671844, pod: 20.231959342956543, loss: 24.04091763496399 
Train [3/6] | Epoch [132/140] |	nca: 1.1538124978542328, flat: 2.657745897769928, pod: 20.12132215499878, loss: 23.932880401611328 
Train [3/6] | Epoch [133/140] |	nca: 1.202948659658432, flat: 2.6842231154441833, pod: 20.36240243911743, loss: 24.249574184417725 
Train [3/6] | Epoch [134/140] |	nca: 1.304264672100544, flat: 2.761018246412277, pod: 20.60177791118622, loss: 24.667060494422913 
Train [3/6] | Epoch [135/140] |	nca: 1.169445462524891, flat: 2.671931266784668, pod: 20.464791774749756, loss: 24.306168913841248 
Train [3/6] | Epoch [136/140] |	nca: 1.1740381196141243, flat: 2.698446750640869, pod: 20.467397212982178, loss: 24.339881896972656 
Train [3/6] | Epoch [137/140] |	nca: 1.2479907274246216, flat: 2.665140211582184, pod: 20.307154774665833, loss: 24.220285773277283 
Train [3/6] | Epoch [138/140] |	nca: 1.2721397653222084, flat: 2.668882578611374, pod: 20.29340946674347, loss: 24.234431505203247 
Train [3/6] | Epoch [139/140] |	nca: 1.0245652496814728, flat: 2.6894414126873016, pod: 20.431987047195435, loss: 24.14599370956421 
Train [3/6] | Epoch [140/140] |	nca: 1.1809798777103424, flat: 2.6800973266363144, pod: 20.327893376350403, loss: 24.18897008895874 
after task
Building & updating memory.
after task
Eval on 0->7.
eval task
podnet_nme_cifar10_5steps
Avg inc acc: 0.8853333333333332.
Current acc: {'total': 0.831, '00-09': 0.831}.
Avg inc acc top5: 0.999.
Current acc top5: {'total': 0.997}.
Forgetting: 0.07.
Cord metric: 0.86.
Old accuracy: 0.83, mean: 0.87.
New accuracy: 0.81, mean: 0.70.
================Task 3 Start!================
Testing on False unseen tasks (max class = 8).
Set memory of size: 1400.
Before task
Generating imprinted weights
Multi class diff kmeans.
Now 200 examplars per class.
Group: convnet, lr: 0.1.
Group: postprocessing, lr: 0.1.
Group: new_weights, lr: 0.1.
================Task 3 Training!================
The training samples number: 6400
Train on 7->8.
train task
nb 6400.
Train [4/6] | Epoch [1/120] |	nca: 20.106893703341484, flat: 7.582297399640083, pod: 75.1095085144043, loss: 102.79869902133942 
Train [4/6] | Epoch [2/120] |	nca: 12.241046845912933, flat: 5.16061644256115, pod: 65.22669470310211, loss: 82.62835812568665 
Train [4/6] | Epoch [3/120] |	nca: 11.809086829423904, flat: 4.853570610284805, pod: 63.082552790641785, loss: 79.74521040916443 
Train [4/6] | Epoch [4/120] |	nca: 9.870214529335499, flat: 4.109669804573059, pod: 56.80536878108978, loss: 70.7852532863617 
Train [4/6] | Epoch [5/120] |	nca: 9.363991528749466, flat: 3.976934727281332, pod: 57.17436057329178, loss: 70.51528716087341 
Train [4/6] | Epoch [6/120] |	nca: 9.552700102329254, flat: 4.141379117965698, pod: 56.88347291946411, loss: 70.57755267620087 
Train [4/6] | Epoch [7/120] |	nca: 8.714456982910633, flat: 4.001497261226177, pod: 56.29765844345093, loss: 69.01361286640167 
Train [4/6] | Epoch [8/120] |	nca: 8.21322201937437, flat: 3.975848987698555, pod: 55.04528933763504, loss: 67.23436081409454 
Train [4/6] | Epoch [9/120] |	nca: 8.008347168564796, flat: 3.966134086251259, pod: 53.87623345851898, loss: 65.85071456432343 
Train [4/6] | Epoch [10/120] |	nca: 7.533316224813461, flat: 3.770300719887018, pod: 53.212126195430756, loss: 64.51574373245239 
Train [4/6] | Epoch [11/120] |	nca: 6.914632238447666, flat: 3.600381139665842, pod: 50.92960786819458, loss: 61.444621205329895 
Train [4/6] | Epoch [12/120] |	nca: 7.184496603906155, flat: 3.548014510422945, pod: 51.296911776065826, loss: 62.0294224023819 
Train [4/6] | Epoch [13/120] |	nca: 7.370209887623787, flat: 3.750509552657604, pod: 53.24919694662094, loss: 64.36991655826569 
Train [4/6] | Epoch [14/120] |	nca: 7.692424360662699, flat: 3.7049515619874, pod: 51.38802087306976, loss: 62.78539681434631 
Train [4/6] | Epoch [15/120] |	nca: 6.719963610172272, flat: 3.7151552103459835, pod: 52.50721615552902, loss: 62.94233500957489 
Train [4/6] | Epoch [16/120] |	nca: 7.6383858770132065, flat: 3.776250522583723, pod: 52.35650455951691, loss: 63.771141052246094 
Train [4/6] | Epoch [17/120] |	nca: 6.54668540507555, flat: 3.673494655638933, pod: 51.29099887609482, loss: 61.51117920875549 
Train [4/6] | Epoch [18/120] |	nca: 6.348762836307287, flat: 3.746372114866972, pod: 51.98987513780594, loss: 62.08501052856445 
Train [4/6] | Epoch [19/120] |	nca: 6.587732635438442, flat: 3.648210022598505, pod: 51.56876599788666, loss: 61.80470895767212 
Train [4/6] | Epoch [20/120] |	nca: 6.40797683596611, flat: 3.628607790917158, pod: 50.78409242630005, loss: 60.82067680358887 
Train [4/6] | Epoch [21/120] |	nca: 6.47810897231102, flat: 3.6707047447562218, pod: 51.43212288618088, loss: 61.580936551094055 
Train [4/6] | Epoch [22/120] |	nca: 5.752336136996746, flat: 3.422908578068018, pod: 47.43708097934723, loss: 56.61232566833496 
Train [4/6] | Epoch [23/120] |	nca: 6.292861942201853, flat: 3.6701061576604843, pod: 50.67504668235779, loss: 60.638014912605286 
Train [4/6] | Epoch [24/120] |	nca: 5.6464198008179665, flat: 3.592557493597269, pod: 49.4722797870636, loss: 58.711256980895996 
Train [4/6] | Epoch [25/120] |	nca: 6.582354053854942, flat: 3.5569271370768547, pod: 48.640142261981964, loss: 58.779423236846924 
Train [4/6] | Epoch [26/120] |	nca: 5.5390676110982895, flat: 3.711188603192568, pod: 50.642486691474915, loss: 59.89274299144745 
Train [4/6] | Epoch [27/120] |	nca: 5.971924506127834, flat: 3.463881630450487, pod: 49.598193287849426, loss: 59.0339994430542 
Train [4/6] | Epoch [28/120] |	nca: 5.487779159098864, flat: 3.3990465067327023, pod: 48.22316062450409, loss: 57.109986424446106 
Train [4/6] | Epoch [29/120] |	nca: 5.99629919603467, flat: 3.430800214409828, pod: 48.86628574132919, loss: 58.29338538646698 
Train [4/6] | Epoch [30/120] |	nca: 5.437437787652016, flat: 3.541263625025749, pod: 48.74390798807144, loss: 57.72260928153992 
Train [4/6] | Epoch [31/120] |	nca: 5.599760603159666, flat: 3.494103454053402, pod: 48.29351764917374, loss: 57.38738149404526 
Train [4/6] | Epoch [32/120] |	nca: 5.5108397006988525, flat: 3.3415860943496227, pod: 47.58123314380646, loss: 56.43365901708603 
Train [4/6] | Epoch [33/120] |	nca: 5.182744387537241, flat: 3.4790236577391624, pod: 48.52196156978607, loss: 57.1837295293808 
Train [4/6] | Epoch [34/120] |	nca: 4.7025331892073154, flat: 3.3950454108417034, pod: 47.32608127593994, loss: 55.42365962266922 
Train [4/6] | Epoch [35/120] |	nca: 5.417069971561432, flat: 3.4373865947127342, pod: 47.961349844932556, loss: 56.815806210041046 
Train [4/6] | Epoch [36/120] |	nca: 5.73986379802227, flat: 3.3556133434176445, pod: 48.06079465150833, loss: 57.15627145767212 
Train [4/6] | Epoch [37/120] |	nca: 5.227303706109524, flat: 3.3208711072802544, pod: 46.30180215835571, loss: 54.849976897239685 
Train [4/6] | Epoch [38/120] |	nca: 5.048800207674503, flat: 3.284982241690159, pod: 46.72589772939682, loss: 55.05968016386032 
Train [4/6] | Epoch [39/120] |	nca: 4.9111158438026905, flat: 3.1377328112721443, pod: 44.64284801483154, loss: 52.69169729948044 
Train [4/6] | Epoch [40/120] |	nca: 4.622497618198395, flat: 3.133531555533409, pod: 44.12036991119385, loss: 51.8763992190361 
Train [4/6] | Epoch [41/120] |	nca: 5.07061668112874, flat: 3.317831639200449, pod: 47.01998430490494, loss: 55.40843254327774 
Train [4/6] | Epoch [42/120] |	nca: 4.706527225673199, flat: 3.060463383793831, pod: 43.84121346473694, loss: 51.60820406675339 
Train [4/6] | Epoch [43/120] |	nca: 4.7413611970841885, flat: 3.1749396584928036, pod: 44.68731743097305, loss: 52.60361808538437 
Train [4/6] | Epoch [44/120] |	nca: 4.481740523129702, flat: 3.034362107515335, pod: 43.63082045316696, loss: 51.14692312479019 
Train [4/6] | Epoch [45/120] |	nca: 4.978567466139793, flat: 3.0750893093645573, pod: 44.543545603752136, loss: 52.59720194339752 
Train [4/6] | Epoch [46/120] |	nca: 4.1761068142950535, flat: 3.1063654720783234, pod: 44.443935334682465, loss: 51.72640770673752 
Train [4/6] | Epoch [47/120] |	nca: 4.133614081889391, flat: 2.969460219144821, pod: 43.40146058797836, loss: 50.5045348405838 
Train [4/6] | Epoch [48/120] |	nca: 4.78415097668767, flat: 3.008066698908806, pod: 44.17653101682663, loss: 51.96874874830246 
Train [4/6] | Epoch [49/120] |	nca: 4.9127624444663525, flat: 3.121321152895689, pod: 42.87446504831314, loss: 50.90854859352112 
Train [4/6] | Epoch [50/120] |	nca: 4.320906553417444, flat: 2.9804230630397797, pod: 42.08683341741562, loss: 49.38816297054291 
Train [4/6] | Epoch [51/120] |	nca: 3.9652332849800587, flat: 2.8322347328066826, pod: 40.767561972141266, loss: 47.56503003835678 
Train [4/6] | Epoch [52/120] |	nca: 4.23766378313303, flat: 2.917709894478321, pod: 41.84654092788696, loss: 49.0019149184227 
Train [4/6] | Epoch [53/120] |	nca: 4.324846293777227, flat: 3.0122925601899624, pod: 42.87894910573959, loss: 50.21608793735504 
Train [4/6] | Epoch [54/120] |	nca: 4.07452904433012, flat: 2.8007973060011864, pod: 41.03107833862305, loss: 47.90640473365784 
Train [4/6] | Epoch [55/120] |	nca: 4.213194008916616, flat: 2.9216546081006527, pod: 41.57043933868408, loss: 48.705287635326385 
Train [4/6] | Epoch [56/120] |	nca: 4.0116857923567295, flat: 2.751927435398102, pod: 40.21155422925949, loss: 46.97516757249832 
Train [4/6] | Epoch [57/120] |	nca: 4.038898728787899, flat: 2.9464752227067947, pod: 42.49562221765518, loss: 49.48099631071091 
Train [4/6] | Epoch [58/120] |	nca: 4.154998350888491, flat: 2.837379928678274, pod: 40.71741324663162, loss: 47.709791362285614 
Train [4/6] | Epoch [59/120] |	nca: 4.036420725286007, flat: 2.858315344899893, pod: 40.53005373477936, loss: 47.42478984594345 
Train [4/6] | Epoch [60/120] |	nca: 3.80147485435009, flat: 2.8196977339684963, pod: 41.90566325187683, loss: 48.526835799217224 
Train [4/6] | Epoch [61/120] |	nca: 3.8067813124507666, flat: 2.8544146977365017, pod: 42.37996757030487, loss: 49.0411633849144 
Train [4/6] | Epoch [62/120] |	nca: 3.7139538042247295, flat: 2.8200320415198803, pod: 40.60766959190369, loss: 47.14165550470352 
Train [4/6] | Epoch [63/120] |	nca: 3.526631750166416, flat: 2.678064227104187, pod: 38.89477211236954, loss: 45.09946799278259 
Train [4/6] | Epoch [64/120] |	nca: 3.6620141938328743, flat: 2.6692229993641376, pod: 40.24413973093033, loss: 46.57537692785263 
Train [4/6] | Epoch [65/120] |	nca: 2.969635471701622, flat: 2.4836741536855698, pod: 36.86346662044525, loss: 42.316776156425476 
Train [4/6] | Epoch [66/120] |	nca: 3.2673324421048164, flat: 2.520179435610771, pod: 37.113432824611664, loss: 42.90094465017319 
Train [4/6] | Epoch [67/120] |	nca: 3.771890677511692, flat: 2.489422645419836, pod: 36.85147249698639, loss: 43.11278575658798 
Train [4/6] | Epoch [68/120] |	nca: 3.5461818482726812, flat: 2.6149843335151672, pod: 38.40751212835312, loss: 44.56867837905884 
Train [4/6] | Epoch [69/120] |	nca: 3.182578470557928, flat: 2.395173318684101, pod: 35.20593070983887, loss: 40.78368264436722 
Train [4/6] | Epoch [70/120] |	nca: 3.271441448479891, flat: 2.4896349273622036, pod: 36.210186541080475, loss: 41.971262753009796 
Train [4/6] | Epoch [71/120] |	nca: 3.433338277041912, flat: 2.544623915106058, pod: 37.21520560979843, loss: 43.19316774606705 
Train [4/6] | Epoch [72/120] |	nca: 3.411277387291193, flat: 2.4046672508120537, pod: 34.98138242959976, loss: 40.79732692241669 
Train [4/6] | Epoch [73/120] |	nca: 3.255006894469261, flat: 2.4330115616321564, pod: 36.36786609888077, loss: 42.055884301662445 
Train [4/6] | Epoch [74/120] |	nca: 3.2149694971740246, flat: 2.326557047665119, pod: 34.31716561317444, loss: 39.85869216918945 
Train [4/6] | Epoch [75/120] |	nca: 3.1029203478246927, flat: 2.4857613928616047, pod: 34.55528110265732, loss: 40.14396268129349 
Train [4/6] | Epoch [76/120] |	nca: 2.857827501371503, flat: 2.2789181023836136, pod: 32.973867535591125, loss: 38.11061334609985 
Train [4/6] | Epoch [77/120] |	nca: 2.700855089351535, flat: 2.21298535913229, pod: 32.146788597106934, loss: 37.060629069805145 
Train [4/6] | Epoch [78/120] |	nca: 2.9145733658224344, flat: 2.1873372830450535, pod: 32.9586336016655, loss: 38.06054425239563 
Train [4/6] | Epoch [79/120] |	nca: 2.745066536590457, flat: 2.2772841304540634, pod: 34.06291836500168, loss: 39.085269033908844 
Train [4/6] | Epoch [80/120] |	nca: 2.700678603723645, flat: 2.2500229477882385, pod: 33.89877098798752, loss: 38.84947246313095 
Train [4/6] | Epoch [81/120] |	nca: 2.409679403528571, flat: 2.0679893530905247, pod: 31.215429842472076, loss: 35.69309866428375 
Train [4/6] | Epoch [82/120] |	nca: 2.5960691310465336, flat: 2.1682114377617836, pod: 31.98249089717865, loss: 36.746771574020386 
Train [4/6] | Epoch [83/120] |	nca: 2.6085312347859144, flat: 2.1634990200400352, pod: 32.497151255607605, loss: 37.26918160915375 
Train [4/6] | Epoch [84/120] |	nca: 2.539527289569378, flat: 2.06814106926322, pod: 30.503247320652008, loss: 35.11091589927673 
Train [4/6] | Epoch [85/120] |	nca: 2.5802991408854723, flat: 2.0883811060339212, pod: 30.634635776281357, loss: 35.30331605672836 
Train [4/6] | Epoch [86/120] |	nca: 2.7655982468277216, flat: 2.0075460374355316, pod: 30.911145359277725, loss: 35.68428963422775 
Train [4/6] | Epoch [87/120] |	nca: 2.6108803134411573, flat: 2.0237358044832945, pod: 30.469845712184906, loss: 35.1044619679451 
Train [4/6] | Epoch [88/120] |	nca: 2.4139932729303837, flat: 2.1124874353408813, pod: 31.75463706254959, loss: 36.28111785650253 
Train [4/6] | Epoch [89/120] |	nca: 2.2994584050029516, flat: 1.9266359880566597, pod: 28.800813287496567, loss: 33.02690774202347 
Train [4/6] | Epoch [90/120] |	nca: 2.310711959376931, flat: 1.9283843711018562, pod: 29.668008536100388, loss: 33.907104671001434 
Train [4/6] | Epoch [91/120] |	nca: 2.0357222259044647, flat: 1.9140216764062643, pod: 28.839822202920914, loss: 32.78956615924835 
Train [4/6] | Epoch [92/120] |	nca: 2.320177383720875, flat: 1.9490672573447227, pod: 28.015368402004242, loss: 32.28461301326752 
Train [4/6] | Epoch [93/120] |	nca: 2.20462797768414, flat: 1.8716373667120934, pod: 27.665547013282776, loss: 31.741812467575073 
Train [4/6] | Epoch [94/120] |	nca: 2.0577174555510283, flat: 1.8456877451390028, pod: 26.593856662511826, loss: 30.497261941432953 
Train [4/6] | Epoch [95/120] |	nca: 2.1504752598702908, flat: 1.8816473688930273, pod: 27.805320918560028, loss: 31.837443351745605 
Train [4/6] | Epoch [96/120] |	nca: 2.2183382138609886, flat: 1.8093749601393938, pod: 26.603618681430817, loss: 30.63133156299591 
Train [4/6] | Epoch [97/120] |	nca: 2.0003286320716143, flat: 1.8080943934619427, pod: 26.52065408229828, loss: 30.32907697558403 
Train [4/6] | Epoch [98/120] |	nca: 2.1504414677619934, flat: 1.7601779960095882, pod: 25.813470035791397, loss: 29.724089443683624 
Train [4/6] | Epoch [99/120] |	nca: 2.0779066644608974, flat: 1.7992624640464783, pod: 26.173314541578293, loss: 30.05048355460167 
Train [4/6] | Epoch [100/120] |	nca: 2.145585870370269, flat: 1.7966124564409256, pod: 26.026493340730667, loss: 29.968691617250443 
Train [4/6] | Epoch [101/120] |	nca: 2.1660093385726213, flat: 1.7459659930318594, pod: 25.056665122509003, loss: 28.96864029765129 
Train [4/6] | Epoch [102/120] |	nca: 1.953830847516656, flat: 1.6942843422293663, pod: 24.52603241801262, loss: 28.17414751648903 
Train [4/6] | Epoch [103/120] |	nca: 1.9826836083084345, flat: 1.642511297017336, pod: 24.375694900751114, loss: 28.000889837741852 
Train [4/6] | Epoch [104/120] |	nca: 2.0792963188141584, flat: 1.7213983163237572, pod: 24.49006325006485, loss: 28.29075786471367 
Train [4/6] | Epoch [105/120] |	nca: 1.8789830934256315, flat: 1.650710018351674, pod: 24.405253648757935, loss: 27.934946715831757 
Train [4/6] | Epoch [106/120] |	nca: 1.8938468098640442, flat: 1.6585588101297617, pod: 23.93362307548523, loss: 27.48602867126465 
Train [4/6] | Epoch [107/120] |	nca: 1.91301778703928, flat: 1.6237686444073915, pod: 22.65552893280983, loss: 26.192315578460693 
Train [4/6] | Epoch [108/120] |	nca: 1.9160112999379635, flat: 1.6282385885715485, pod: 23.510502606630325, loss: 27.05475240945816 
Train [4/6] | Epoch [109/120] |	nca: 1.877655515447259, flat: 1.6514718905091286, pod: 23.333465188741684, loss: 26.862592577934265 
Train [4/6] | Epoch [110/120] |	nca: 1.8535814844071865, flat: 1.581158583983779, pod: 22.188095420598984, loss: 25.62283566594124 
Train [4/6] | Epoch [111/120] |	nca: 1.9920666497200727, flat: 1.6479900293052197, pod: 23.349791049957275, loss: 26.989847719669342 
Train [4/6] | Epoch [112/120] |	nca: 1.7915696576237679, flat: 1.613336095586419, pod: 22.645534992218018, loss: 26.05044063925743 
Train [4/6] | Epoch [113/120] |	nca: 1.8160717077553272, flat: 1.6289513166993856, pod: 23.51937586069107, loss: 26.96439889073372 
Train [4/6] | Epoch [114/120] |	nca: 1.8730897344648838, flat: 1.5286655314266682, pod: 21.541632026433945, loss: 24.943387240171432 
Train [4/6] | Epoch [115/120] |	nca: 1.8422473520040512, flat: 1.4993952065706253, pod: 21.355187118053436, loss: 24.69682964682579 
Train [4/6] | Epoch [116/120] |	nca: 1.7721102181822062, flat: 1.510221065953374, pod: 21.2937613427639, loss: 24.576092451810837 
Train [4/6] | Epoch [117/120] |	nca: 1.8468818739056587, flat: 1.5329553596675396, pod: 21.460612803697586, loss: 24.840450137853622 
Train [4/6] | Epoch [118/120] |	nca: 1.862112931907177, flat: 1.5221196692436934, pod: 21.723333925008774, loss: 25.107566565275192 
Train [4/6] | Epoch [119/120] |	nca: 1.9243579618632793, flat: 1.5437476616352797, pod: 21.86978179216385, loss: 25.337887197732925 
Train [4/6] | Epoch [120/120] |	nca: 1.7956376913934946, flat: 1.507622255012393, pod: 20.814997792243958, loss: 24.11825782060623 
Fine-tuning
Building & updating memory.
Train [4/6] | Epoch [121/140] |	nca: 6.403909608721733, flat: 1.6964275613427162, pod: 17.418609857559204, loss: 25.51894700527191 
Train [4/6] | Epoch [122/140] |	nca: 2.3264562785625458, flat: 1.6947505921125412, pod: 17.35013920068741, loss: 21.37134623527527 
Train [4/6] | Epoch [123/140] |	nca: 1.6976342126727104, flat: 1.7018250599503517, pod: 17.365238547325134, loss: 20.764697909355164 
Train [4/6] | Epoch [124/140] |	nca: 1.5239479914307594, flat: 1.7293094247579575, pod: 17.580424427986145, loss: 20.83368146419525 
Train [4/6] | Epoch [125/140] |	nca: 1.4632509723305702, flat: 1.6830364093184471, pod: 17.22446084022522, loss: 20.370748162269592 
Train [4/6] | Epoch [126/140] |	nca: 1.3648314699530602, flat: 1.6720213070511818, pod: 17.266600728034973, loss: 20.30345332622528 
Train [4/6] | Epoch [127/140] |	nca: 1.2436050288379192, flat: 1.6815227046608925, pod: 17.271286487579346, loss: 20.19641423225403 
Train [4/6] | Epoch [128/140] |	nca: 1.380674108862877, flat: 1.7751085609197617, pod: 17.620232582092285, loss: 20.776015281677246 
Train [4/6] | Epoch [129/140] |	nca: 1.1820350028574467, flat: 1.7788224443793297, pod: 17.59106171131134, loss: 20.551919102668762 
Train [4/6] | Epoch [130/140] |	nca: 1.2744811475276947, flat: 1.7005174607038498, pod: 17.545241713523865, loss: 20.52024018764496 
Train [4/6] | Epoch [131/140] |	nca: 1.3294383063912392, flat: 1.7496506124734879, pod: 17.534722328186035, loss: 20.613811135292053 
Train [4/6] | Epoch [132/140] |	nca: 1.1290066950023174, flat: 1.693078137934208, pod: 17.427980422973633, loss: 20.250065207481384 
Train [4/6] | Epoch [133/140] |	nca: 1.0859329961240292, flat: 1.717813029885292, pod: 17.390427708625793, loss: 20.194173455238342 
Train [4/6] | Epoch [134/140] |	nca: 1.185323677957058, flat: 1.7417391315102577, pod: 17.441076397895813, loss: 20.368139028549194 
Train [4/6] | Epoch [135/140] |	nca: 1.1143541038036346, flat: 1.7347018048167229, pod: 17.61343777179718, loss: 20.462493777275085 
Train [4/6] | Epoch [136/140] |	nca: 1.1294580027461052, flat: 1.7893701493740082, pod: 17.656043529510498, loss: 20.574871301651 
Train [4/6] | Epoch [137/140] |	nca: 1.1527795605361462, flat: 1.7206974104046822, pod: 17.470813155174255, loss: 20.344290375709534 
Train [4/6] | Epoch [138/140] |	nca: 1.0953194238245487, flat: 1.7726879268884659, pod: 17.813031554222107, loss: 20.681038856506348 
Train [4/6] | Epoch [139/140] |	nca: 1.0102897733449936, flat: 1.7367984503507614, pod: 17.634111523628235, loss: 20.381199836730957 
Train [4/6] | Epoch [140/140] |	nca: 1.0520189218223095, flat: 1.732789784669876, pod: 17.54308271408081, loss: 20.32789123058319 
after task
Building & updating memory.
after task
Eval on 0->8.
eval task
podnet_nme_cifar10_5steps
Avg inc acc: 0.8647499999999999.
Current acc: {'total': 0.803, '00-09': 0.803}.
Avg inc acc top5: 0.9977499999999999.
Current acc top5: {'total': 0.994}.
Forgetting: 0.08399999999999996.
Cord metric: 0.83.
Old accuracy: 0.81, mean: 0.85.
New accuracy: 0.74, mean: 0.71.
================Task 4 Start!================
Testing on False unseen tasks (max class = 9).
Set memory of size: 1600.
Before task
Generating imprinted weights
Multi class diff kmeans.
Now 200 examplars per class.
Group: convnet, lr: 0.1.
Group: postprocessing, lr: 0.1.
Group: new_weights, lr: 0.1.
================Task 4 Training!================
The training samples number: 6600
Train on 8->9.
train task
nb 6600.
Train [5/6] | Epoch [1/120] |	nca: 21.189997628331184, flat: 12.991537973284721, pod: 80.1953274011612, loss: 114.3768630027771 
Train [5/6] | Epoch [2/120] |	nca: 12.558594360947609, flat: 7.35615561902523, pod: 61.03885865211487, loss: 80.95360887050629 
Train [5/6] | Epoch [3/120] |	nca: 10.48700711876154, flat: 6.692119516432285, pod: 58.72207736968994, loss: 75.9012039899826 
Train [5/6] | Epoch [4/120] |	nca: 10.533118441700935, flat: 6.70753038674593, pod: 59.39581799507141, loss: 76.63646650314331 
Train [5/6] | Epoch [5/120] |	nca: 9.266933105885983, flat: 6.489188008010387, pod: 58.311389446258545, loss: 74.06751084327698 
Train [5/6] | Epoch [6/120] |	nca: 8.825142152607441, flat: 5.90121404081583, pod: 53.60477238893509, loss: 68.33112895488739 
Train [5/6] | Epoch [7/120] |	nca: 8.737834602594376, flat: 6.0617005452513695, pod: 54.98691362142563, loss: 69.78644859790802 
Train [5/6] | Epoch [8/120] |	nca: 8.077302850782871, flat: 5.546822927892208, pod: 52.58576864004135, loss: 66.20989441871643 
Train [5/6] | Epoch [9/120] |	nca: 7.622780300676823, flat: 5.601152300834656, pod: 53.709737956523895, loss: 66.9336701631546 
Train [5/6] | Epoch [10/120] |	nca: 8.150632821023464, flat: 5.958278596401215, pod: 55.32761740684509, loss: 69.43652856349945 
Train [5/6] | Epoch [11/120] |	nca: 7.079153813421726, flat: 5.490380011498928, pod: 53.1970152258873, loss: 65.76654922962189 
Train [5/6] | Epoch [12/120] |	nca: 6.850012201815844, flat: 5.359036318957806, pod: 51.809187948703766, loss: 64.01823663711548 
Train [5/6] | Epoch [13/120] |	nca: 6.421712223440409, flat: 5.166282638907433, pod: 51.089849293231964, loss: 62.67784404754639 
Train [5/6] | Epoch [14/120] |	nca: 7.060138251632452, flat: 5.36467219889164, pod: 53.40027713775635, loss: 65.82508742809296 
Train [5/6] | Epoch [15/120] |	nca: 6.614381305873394, flat: 5.304330736398697, pod: 52.85017812252045, loss: 64.7688901424408 
Train [5/6] | Epoch [16/120] |	nca: 6.639924317598343, flat: 5.293790817260742, pod: 51.21051734685898, loss: 63.14423227310181 
Train [5/6] | Epoch [17/120] |	nca: 6.607766091823578, flat: 5.074672423303127, pod: 51.08734059333801, loss: 62.7697788476944 
Train [5/6] | Epoch [18/120] |	nca: 6.340797610580921, flat: 4.972098924219608, pod: 49.205750942230225, loss: 60.51864695549011 
Train [5/6] | Epoch [19/120] |	nca: 6.2761026956140995, flat: 5.217089578509331, pod: 51.954211711883545, loss: 63.44740414619446 
Train [5/6] | Epoch [20/120] |	nca: 6.0494149550795555, flat: 5.092943757772446, pod: 51.0673953294754, loss: 62.20975351333618 
Train [5/6] | Epoch [21/120] |	nca: 5.5839677304029465, flat: 5.037490487098694, pod: 49.397124230861664, loss: 60.0185831785202 
Train [5/6] | Epoch [22/120] |	nca: 5.274370454251766, flat: 4.85602830350399, pod: 49.10238218307495, loss: 59.23278111219406 
Train [5/6] | Epoch [23/120] |	nca: 5.6671576499938965, flat: 4.9986738711595535, pod: 49.29098469018936, loss: 59.95681619644165 
Train [5/6] | Epoch [24/120] |	nca: 5.9087361469864845, flat: 5.068334639072418, pod: 48.36603516340256, loss: 59.34310603141785 
Train [5/6] | Epoch [25/120] |	nca: 5.441774420440197, flat: 5.034431606531143, pod: 48.840896129608154, loss: 59.31710171699524 
Train [5/6] | Epoch [26/120] |	nca: 5.565916534513235, flat: 4.979471459984779, pod: 49.16902822256088, loss: 59.71441602706909 
Train [5/6] | Epoch [27/120] |	nca: 5.481021154671907, flat: 4.817637845873833, pod: 47.12955063581467, loss: 57.428209722042084 
Train [5/6] | Epoch [28/120] |	nca: 6.291583936661482, flat: 5.062974497675896, pod: 49.00357609987259, loss: 60.35813456773758 
Train [5/6] | Epoch [29/120] |	nca: 4.831816706806421, flat: 4.834637820720673, pod: 49.18789750337601, loss: 58.85435199737549 
Train [5/6] | Epoch [30/120] |	nca: 4.973558146506548, flat: 4.577325537800789, pod: 46.82234501838684, loss: 56.373228549957275 
Train [5/6] | Epoch [31/120] |	nca: 5.072407633066177, flat: 4.645085014402866, pod: 46.26202195882797, loss: 55.979514479637146 
Train [5/6] | Epoch [32/120] |	nca: 5.3537529818713665, flat: 4.665897369384766, pod: 47.324197828769684, loss: 57.343848049640656 
Train [5/6] | Epoch [33/120] |	nca: 5.238484971225262, flat: 4.843763776123524, pod: 47.65308880805969, loss: 57.73533761501312 
Train [5/6] | Epoch [34/120] |	nca: 5.36987728625536, flat: 4.766056813299656, pod: 48.5629004240036, loss: 58.69883435964584 
Train [5/6] | Epoch [35/120] |	nca: 5.627188745886087, flat: 5.107816584408283, pod: 49.28111952543259, loss: 60.016124844551086 
Train [5/6] | Epoch [36/120] |	nca: 4.8440127819776535, flat: 4.562546022236347, pod: 46.776333808898926, loss: 56.18289262056351 
Train [5/6] | Epoch [37/120] |	nca: 5.2568515837192535, flat: 4.603727973997593, pod: 46.31498795747757, loss: 56.17556715011597 
Train [5/6] | Epoch [38/120] |	nca: 5.663843244314194, flat: 4.79830464720726, pod: 46.90485215187073, loss: 57.36699998378754 
Train [5/6] | Epoch [39/120] |	nca: 4.772934507578611, flat: 4.355310194194317, pod: 44.005122661590576, loss: 53.133367240428925 
Train [5/6] | Epoch [40/120] |	nca: 4.887039452791214, flat: 4.779534794390202, pod: 47.51220345497131, loss: 57.17877793312073 
Train [5/6] | Epoch [41/120] |	nca: 4.678902700543404, flat: 4.437365800142288, pod: 45.23794835805893, loss: 54.35421699285507 
Train [5/6] | Epoch [42/120] |	nca: 4.469808965921402, flat: 4.3769140020012856, pod: 44.89981138706207, loss: 53.746534407138824 
Train [5/6] | Epoch [43/120] |	nca: 3.9407507590949535, flat: 4.255901262164116, pod: 44.347063601017, loss: 52.54371565580368 
Train [5/6] | Epoch [44/120] |	nca: 4.65718836709857, flat: 4.563664898276329, pod: 45.78051441907883, loss: 55.00136810541153 
Train [5/6] | Epoch [45/120] |	nca: 4.828970234841108, flat: 4.470996603369713, pod: 44.12112420797348, loss: 53.42109143733978 
Train [5/6] | Epoch [46/120] |	nca: 4.354642543941736, flat: 4.350173369050026, pod: 44.419880867004395, loss: 53.12469691038132 
Train [5/6] | Epoch [47/120] |	nca: 4.259707018733025, flat: 4.2595010325312614, pod: 43.47238975763321, loss: 51.991598069667816 
Train [5/6] | Epoch [48/120] |	nca: 4.058379292488098, flat: 4.182869881391525, pod: 42.427397668361664, loss: 50.66864663362503 
Train [5/6] | Epoch [49/120] |	nca: 4.316282171756029, flat: 4.163609284907579, pod: 43.39115411043167, loss: 51.87104552984238 
Train [5/6] | Epoch [50/120] |	nca: 4.536346979439259, flat: 4.192900694906712, pod: 42.81289768218994, loss: 51.54214531183243 
Train [5/6] | Epoch [51/120] |	nca: 4.039666872471571, flat: 4.067579973489046, pod: 41.186629235744476, loss: 49.293875992298126 
Train [5/6] | Epoch [52/120] |	nca: 4.139477904886007, flat: 4.035387448966503, pod: 41.20917534828186, loss: 49.38404059410095 
Train [5/6] | Epoch [53/120] |	nca: 4.316741768270731, flat: 4.183751031756401, pod: 42.13472390174866, loss: 50.63521671295166 
Train [5/6] | Epoch [54/120] |	nca: 3.864589210599661, flat: 3.9063231609761715, pod: 40.97377222776413, loss: 48.7446848154068 
Train [5/6] | Epoch [55/120] |	nca: 3.8988789282739162, flat: 4.0977994203567505, pod: 41.16711449623108, loss: 49.16379237174988 
Train [5/6] | Epoch [56/120] |	nca: 3.8346914798021317, flat: 3.820121541619301, pod: 40.36782091856003, loss: 48.02263402938843 
Train [5/6] | Epoch [57/120] |	nca: 3.7949201203882694, flat: 3.9216175861656666, pod: 39.74223107099533, loss: 47.45876878499985 
Train [5/6] | Epoch [58/120] |	nca: 3.9485616981983185, flat: 3.944870173931122, pod: 40.63332146406174, loss: 48.526753067970276 
Train [5/6] | Epoch [59/120] |	nca: 3.5256678611040115, flat: 3.8745216205716133, pod: 38.37154072523117, loss: 45.77173012495041 
Train [5/6] | Epoch [60/120] |	nca: 3.8755869641900063, flat: 3.843722064048052, pod: 39.23702818155289, loss: 46.95633727312088 
Train [5/6] | Epoch [61/120] |	nca: 4.196020271629095, flat: 3.9948823750019073, pod: 39.78291738033295, loss: 47.97382014989853 
Train [5/6] | Epoch [62/120] |	nca: 3.5650456119328737, flat: 3.809339139610529, pod: 39.30808538198471, loss: 46.682469844818115 
Train [5/6] | Epoch [63/120] |	nca: 3.6491212099790573, flat: 3.7753710076212883, pod: 38.34072721004486, loss: 45.76521909236908 
Train [5/6] | Epoch [64/120] |	nca: 3.63872879371047, flat: 3.6642891094088554, pod: 38.70186275243759, loss: 46.004880487918854 
Train [5/6] | Epoch [65/120] |	nca: 3.6248471047729254, flat: 3.661358669400215, pod: 37.97859984636307, loss: 45.26480555534363 
Train [5/6] | Epoch [66/120] |	nca: 3.5174927208572626, flat: 3.6058162972331047, pod: 36.935516357421875, loss: 44.05882549285889 
Train [5/6] | Epoch [67/120] |	nca: 3.182957850396633, flat: 3.5354781672358513, pod: 36.96353805065155, loss: 43.681973814964294 
Train [5/6] | Epoch [68/120] |	nca: 2.8233591336756945, flat: 3.477648090571165, pod: 36.787627160549164, loss: 43.08863419294357 
Train [5/6] | Epoch [69/120] |	nca: 3.0255251321941614, flat: 3.5291431546211243, pod: 37.08990287780762, loss: 43.64457106590271 
Train [5/6] | Epoch [70/120] |	nca: 3.152848169207573, flat: 3.5004763938486576, pod: 35.634423434734344, loss: 42.2877476811409 
Train [5/6] | Epoch [71/120] |	nca: 3.048826362937689, flat: 3.387363165616989, pod: 35.303465127944946, loss: 41.73965460062027 
Train [5/6] | Epoch [72/120] |	nca: 2.7453438490629196, flat: 3.2573481537401676, pod: 33.67770266532898, loss: 39.680394530296326 
Train [5/6] | Epoch [73/120] |	nca: 2.9749672301113605, flat: 3.2982645817101, pod: 34.01847332715988, loss: 40.291705429553986 
Train [5/6] | Epoch [74/120] |	nca: 3.237687151879072, flat: 3.412343267351389, pod: 35.21447867155075, loss: 41.86450910568237 
Train [5/6] | Epoch [75/120] |	nca: 2.833329990506172, flat: 3.3293375335633755, pod: 34.49981325864792, loss: 40.66248071193695 
Train [5/6] | Epoch [76/120] |	nca: 2.6233274936676025, flat: 3.0521701350808144, pod: 33.22297251224518, loss: 38.89847016334534 
Train [5/6] | Epoch [77/120] |	nca: 2.7429009824991226, flat: 3.1645532771945, pod: 32.719892382621765, loss: 38.62734693288803 
Train [5/6] | Epoch [78/120] |	nca: 2.5274980030953884, flat: 3.059797439724207, pod: 32.34199780225754, loss: 37.9292933344841 
Train [5/6] | Epoch [79/120] |	nca: 2.6771967206150293, flat: 3.096264984458685, pod: 32.57542783021927, loss: 38.34888964891434 
Train [5/6] | Epoch [80/120] |	nca: 2.5893880631774664, flat: 3.0414184518158436, pod: 31.384808152914047, loss: 37.01561462879181 
Train [5/6] | Epoch [81/120] |	nca: 2.544238343834877, flat: 3.0620681531727314, pod: 32.18928962945938, loss: 37.795596063137054 
Train [5/6] | Epoch [82/120] |	nca: 2.4652312118560076, flat: 3.104159165173769, pod: 31.92778569459915, loss: 37.49717599153519 
Train [5/6] | Epoch [83/120] |	nca: 2.4831814505159855, flat: 2.86055213958025, pod: 30.492570400238037, loss: 35.83630406856537 
Train [5/6] | Epoch [84/120] |	nca: 2.4688149113208055, flat: 3.078486144542694, pod: 32.03874731063843, loss: 37.58604842424393 
Train [5/6] | Epoch [85/120] |	nca: 2.353321937844157, flat: 2.887750670313835, pod: 29.032121121883392, loss: 34.27319377660751 
Train [5/6] | Epoch [86/120] |	nca: 2.4414590038359165, flat: 2.9933923184871674, pod: 30.39117783308029, loss: 35.82602900266647 
Train [5/6] | Epoch [87/120] |	nca: 2.377355258911848, flat: 2.872595626860857, pod: 30.529218941926956, loss: 35.77916997671127 
Train [5/6] | Epoch [88/120] |	nca: 2.4778771307319403, flat: 2.847281076014042, pod: 29.2813817858696, loss: 34.60653990507126 
Train [5/6] | Epoch [89/120] |	nca: 2.3435954116284847, flat: 2.913449116051197, pod: 30.084887266159058, loss: 35.34193181991577 
Train [5/6] | Epoch [90/120] |	nca: 2.3452074248343706, flat: 2.822677068412304, pod: 28.804227769374847, loss: 33.97211217880249 
Train [5/6] | Epoch [91/120] |	nca: 2.20300998352468, flat: 2.730987634509802, pod: 27.559052407741547, loss: 32.49304994940758 
Train [5/6] | Epoch [92/120] |	nca: 2.2872327361255884, flat: 2.7761625833809376, pod: 28.35878637433052, loss: 33.42218196392059 
Train [5/6] | Epoch [93/120] |	nca: 2.1136518847197294, flat: 2.753092050552368, pod: 27.335683554410934, loss: 32.20242774486542 
Train [5/6] | Epoch [94/120] |	nca: 2.1553537640720606, flat: 2.646334607154131, pod: 27.063247948884964, loss: 31.864936351776123 
Train [5/6] | Epoch [95/120] |	nca: 2.107782509177923, flat: 2.6126364804804325, pod: 26.764755249023438, loss: 31.485174149274826 
Train [5/6] | Epoch [96/120] |	nca: 2.136275952681899, flat: 2.6073123551905155, pod: 26.674994260072708, loss: 31.418582499027252 
Train [5/6] | Epoch [97/120] |	nca: 2.1641787979751825, flat: 2.54766084253788, pod: 25.231496781110764, loss: 29.943336099386215 
Train [5/6] | Epoch [98/120] |	nca: 1.9595284257084131, flat: 2.49141239002347, pod: 24.25130558013916, loss: 28.702246367931366 
Train [5/6] | Epoch [99/120] |	nca: 2.19689411111176, flat: 2.469389196485281, pod: 24.868746727705002, loss: 29.5350301861763 
Train [5/6] | Epoch [100/120] |	nca: 2.064388245344162, flat: 2.571768093854189, pod: 25.381448417901993, loss: 30.017604738473892 
Train [5/6] | Epoch [101/120] |	nca: 2.0029616579413414, flat: 2.550353165715933, pod: 24.6819024682045, loss: 29.23521727323532 
Train [5/6] | Epoch [102/120] |	nca: 2.170703349635005, flat: 2.503524459898472, pod: 24.422841876745224, loss: 29.097069650888443 
Train [5/6] | Epoch [103/120] |	nca: 2.1344921868294477, flat: 2.520809330046177, pod: 23.5240618288517, loss: 28.1793632209301 
Train [5/6] | Epoch [104/120] |	nca: 2.0125301741063595, flat: 2.4340933077037334, pod: 23.323680132627487, loss: 27.77030372619629 
Train [5/6] | Epoch [105/120] |	nca: 2.061191938817501, flat: 2.4771881885826588, pod: 23.482037991285324, loss: 28.02041819691658 
Train [5/6] | Epoch [106/120] |	nca: 1.9742609355598688, flat: 2.408004455268383, pod: 23.014119803905487, loss: 27.396385192871094 
Train [5/6] | Epoch [107/120] |	nca: 2.0866864044219255, flat: 2.3516673780977726, pod: 22.03593620657921, loss: 26.47429010272026 
Train [5/6] | Epoch [108/120] |	nca: 1.9321011863648891, flat: 2.3658473566174507, pod: 22.672311455011368, loss: 26.97026002407074 
Train [5/6] | Epoch [109/120] |	nca: 2.0922974683344364, flat: 2.3992313481867313, pod: 22.459480464458466, loss: 26.95100909471512 
Train [5/6] | Epoch [110/120] |	nca: 2.0096839480102062, flat: 2.3784444369375706, pod: 22.11117571592331, loss: 26.49930402636528 
Train [5/6] | Epoch [111/120] |	nca: 1.9334983695298433, flat: 2.3467884361743927, pod: 21.652630001306534, loss: 25.932916909456253 
Train [5/6] | Epoch [112/120] |	nca: 2.057383466511965, flat: 2.3603993505239487, pod: 21.955845087766647, loss: 26.37362802028656 
Train [5/6] | Epoch [113/120] |	nca: 1.9609984494745731, flat: 2.349349245429039, pod: 22.0966919362545, loss: 26.407039612531662 
Train [5/6] | Epoch [114/120] |	nca: 2.050768855959177, flat: 2.273460164666176, pod: 21.021419376134872, loss: 25.345648527145386 
Train [5/6] | Epoch [115/120] |	nca: 1.995764434337616, flat: 2.3196819610893726, pod: 21.071831315755844, loss: 25.387277513742447 
Train [5/6] | Epoch [116/120] |	nca: 1.9904649835079908, flat: 2.324972841888666, pod: 20.873017877340317, loss: 25.18845573067665 
Train [5/6] | Epoch [117/120] |	nca: 1.8933159448206425, flat: 2.291345864534378, pod: 20.793602794408798, loss: 24.97826448082924 
Train [5/6] | Epoch [118/120] |	nca: 1.9904902670532465, flat: 2.3191590793430805, pod: 20.755392014980316, loss: 25.065041303634644 
Train [5/6] | Epoch [119/120] |	nca: 2.0259567387402058, flat: 2.3598912805318832, pod: 21.296619564294815, loss: 25.68246755003929 
Train [5/6] | Epoch [120/120] |	nca: 1.9924251288175583, flat: 2.2781755439937115, pod: 21.056882441043854, loss: 25.327482998371124 
Fine-tuning
Building & updating memory.
Train [5/6] | Epoch [121/140] |	nca: 9.46341697871685, flat: 4.270885676145554, pod: 25.792141318321228, loss: 39.52644348144531 
Train [5/6] | Epoch [122/140] |	nca: 2.921239323914051, flat: 3.894553169608116, pod: 25.2424076795578, loss: 32.058199882507324 
Train [5/6] | Epoch [123/140] |	nca: 3.2231744527816772, flat: 3.4913808703422546, pod: 24.139250993728638, loss: 30.853806734085083 
Train [5/6] | Epoch [124/140] |	nca: 2.3417646810412407, flat: 3.609265834093094, pod: 24.45701313018799, loss: 30.40804398059845 
Train [5/6] | Epoch [125/140] |	nca: 2.2489681392908096, flat: 3.5450302958488464, pod: 24.050535321235657, loss: 29.844534039497375 
Train [5/6] | Epoch [126/140] |	nca: 3.318738281726837, flat: 3.864435851573944, pod: 25.50158989429474, loss: 32.68476378917694 
Train [5/6] | Epoch [127/140] |	nca: 2.603463463485241, flat: 3.9399376958608627, pod: 25.21707832813263, loss: 31.7604798078537 
Train [5/6] | Epoch [128/140] |	nca: 1.812837392091751, flat: 3.8235350400209427, pod: 24.88319730758667, loss: 30.519570112228394 
Train [5/6] | Epoch [129/140] |	nca: 1.689285583794117, flat: 3.5426144152879715, pod: 24.261325359344482, loss: 29.49322533607483 
Train [5/6] | Epoch [130/140] |	nca: 1.7822483144700527, flat: 3.601930320262909, pod: 24.881009221076965, loss: 30.265187621116638 
Train [5/6] | Epoch [131/140] |	nca: 1.4296159520745277, flat: 3.811093956232071, pod: 24.830681681632996, loss: 30.071391582489014 
Train [5/6] | Epoch [132/140] |	nca: 1.3026528172194958, flat: 3.766513094305992, pod: 25.074851036071777, loss: 30.14401686191559 
Train [5/6] | Epoch [133/140] |	nca: 1.6057595051825047, flat: 3.753641501069069, pod: 25.217445611953735, loss: 30.57684600353241 
Train [5/6] | Epoch [134/140] |	nca: 1.3344142884016037, flat: 3.569538399577141, pod: 24.152881503105164, loss: 29.05683398246765 
Train [5/6] | Epoch [135/140] |	nca: 1.428271021693945, flat: 3.736002027988434, pod: 25.237554788589478, loss: 30.401827692985535 
Train [5/6] | Epoch [136/140] |	nca: 1.4915203414857388, flat: 3.6525413244962692, pod: 24.629863381385803, loss: 29.773924827575684 
Train [5/6] | Epoch [137/140] |	nca: 1.434663102030754, flat: 3.736663669347763, pod: 25.219258308410645, loss: 30.39058530330658 
Train [5/6] | Epoch [138/140] |	nca: 1.416420567780733, flat: 3.7396223694086075, pod: 24.7647705078125, loss: 29.92081356048584 
Train [5/6] | Epoch [139/140] |	nca: 1.6441593952476978, flat: 3.7463037818670273, pod: 24.99345350265503, loss: 30.38391637802124 
Train [5/6] | Epoch [140/140] |	nca: 2.094874121248722, flat: 3.5413178503513336, pod: 24.30055344104767, loss: 29.936745285987854 
after task
Building & updating memory.
after task
Eval on 0->9.
eval task
podnet_nme_cifar10_5steps
Avg inc acc: 0.8478.
Current acc: {'total': 0.78, '00-09': 0.78}.
Avg inc acc top5: 0.9968.
Current acc top5: {'total': 0.993}.
Forgetting: 0.09549999999999997.
Cord metric: 0.81.
Old accuracy: 0.78, mean: 0.83.
New accuracy: 0.75, mean: 0.72.
================Task 5 Start!================
Testing on False unseen tasks (max class = 10).
Set memory of size: 1800.
Before task
Generating imprinted weights
Multi class diff kmeans.
Now 200 examplars per class.
Group: convnet, lr: 0.1.
Group: postprocessing, lr: 0.1.
Group: new_weights, lr: 0.1.
================Task 5 Training!================
The training samples number: 6800
Train on 9->10.
train task
nb 6800.
Train [6/6] | Epoch [1/120] |	nca: 26.41261065006256, flat: 7.648428060114384, pod: 82.65992081165314, loss: 116.72095966339111 
Train [6/6] | Epoch [2/120] |	nca: 27.080479323863983, flat: 9.965664729475975, pod: 97.44067621231079, loss: 134.48681938648224 
Train [6/6] | Epoch [3/120] |	nca: 21.093088433146477, flat: 7.336129732429981, pod: 83.34495151042938, loss: 111.77417004108429 
Train [6/6] | Epoch [4/120] |	nca: 19.51431940495968, flat: 6.853334933519363, pod: 79.43912732601166, loss: 105.80678117275238 
Train [6/6] | Epoch [5/120] |	nca: 16.381496757268906, flat: 5.883973278105259, pod: 73.73756945133209, loss: 96.00303947925568 
Train [6/6] | Epoch [6/120] |	nca: 14.85925966501236, flat: 5.039330922067165, pod: 67.18238413333893, loss: 87.08097493648529 
Train [6/6] | Epoch [7/120] |	nca: 14.360593467950821, flat: 5.161501303315163, pod: 66.39232075214386, loss: 85.91441535949707 
Train [6/6] | Epoch [8/120] |	nca: 13.445092171430588, flat: 4.922512128949165, pod: 65.32804119586945, loss: 83.69564580917358 
Train [6/6] | Epoch [9/120] |	nca: 12.97781726717949, flat: 4.795887641608715, pod: 63.03693068027496, loss: 80.81063556671143 
Train [6/6] | Epoch [10/120] |	nca: 14.179061770439148, flat: 5.379734747111797, pod: 67.26417982578278, loss: 86.82297646999359 
Train [6/6] | Epoch [11/120] |	nca: 12.492133796215057, flat: 5.202378250658512, pod: 64.88225930929184, loss: 82.5767707824707 
Train [6/6] | Epoch [12/120] |	nca: 11.288063928484917, flat: 4.589383900165558, pod: 59.97910237312317, loss: 75.8565502166748 
Train [6/6] | Epoch [13/120] |	nca: 12.361772924661636, flat: 4.865001887083054, pod: 63.92629015445709, loss: 81.15306460857391 
Train [6/6] | Epoch [14/120] |	nca: 12.040741711854935, flat: 5.1921180337667465, pod: 66.24586147069931, loss: 83.47872149944305 
Train [6/6] | Epoch [15/120] |	nca: 11.395350247621536, flat: 4.81590523570776, pod: 61.529125809669495, loss: 77.74038100242615 
Train [6/6] | Epoch [16/120] |	nca: 12.3544330149889, flat: 5.274045869708061, pod: 64.98461896181107, loss: 82.61309778690338 
Train [6/6] | Epoch [17/120] |	nca: 12.427774354815483, flat: 4.995389431715012, pod: 64.14517575502396, loss: 81.56834042072296 
Train [6/6] | Epoch [18/120] |	nca: 12.21896980702877, flat: 5.529263876378536, pod: 66.98403346538544, loss: 84.73226761817932 
Train [6/6] | Epoch [19/120] |	nca: 9.93742299824953, flat: 4.412926614284515, pod: 59.55062520503998, loss: 73.9009747505188 
Train [6/6] | Epoch [20/120] |	nca: 9.972390569746494, flat: 4.903483271598816, pod: 61.42808699607849, loss: 76.30396068096161 
Train [6/6] | Epoch [21/120] |	nca: 10.867623947560787, flat: 4.809736281633377, pod: 61.41269147396088, loss: 77.09005188941956 
Train [6/6] | Epoch [22/120] |	nca: 11.508155345916748, flat: 5.235549055039883, pod: 65.4530189037323, loss: 82.19672358036041 
Train [6/6] | Epoch [23/120] |	nca: 9.871185690164566, flat: 4.689872056245804, pod: 60.909734070301056, loss: 75.47079193592072 
Train [6/6] | Epoch [24/120] |	nca: 10.583010286092758, flat: 4.478102318942547, pod: 58.9504497051239, loss: 74.01156234741211 
Train [6/6] | Epoch [25/120] |	nca: 11.073671251535416, flat: 4.971760302782059, pod: 61.48629629611969, loss: 77.53172850608826 
Train [6/6] | Epoch [26/120] |	nca: 10.06653505563736, flat: 4.872394300997257, pod: 61.19547325372696, loss: 76.13440227508545 
Train [6/6] | Epoch [27/120] |	nca: 9.356160804629326, flat: 4.434772312641144, pod: 58.372719526290894, loss: 72.1636528968811 
Train [6/6] | Epoch [28/120] |	nca: 10.218606643378735, flat: 4.938986748456955, pod: 62.33666342496872, loss: 77.49425685405731 
Train [6/6] | Epoch [29/120] |	nca: 10.543868966400623, flat: 4.7090862691402435, pod: 60.092073142528534, loss: 75.34502828121185 
Train [6/6] | Epoch [30/120] |	nca: 8.891678772866726, flat: 4.796203002333641, pod: 59.7986398935318, loss: 73.4865220785141 
Train [6/6] | Epoch [31/120] |	nca: 8.820263974368572, flat: 4.16969234123826, pod: 54.912039399147034, loss: 67.90199542045593 
Train [6/6] | Epoch [32/120] |	nca: 13.526561096310616, flat: 6.092483542859554, pod: 69.03862488269806, loss: 88.65766942501068 
Train [6/6] | Epoch [33/120] |	nca: 8.707794852554798, flat: 4.640928231179714, pod: 59.34902548789978, loss: 72.69774830341339 
Train [6/6] | Epoch [34/120] |	nca: 10.214838027954102, flat: 4.718324329704046, pod: 59.87468534708023, loss: 74.80784773826599 
Train [6/6] | Epoch [35/120] |	nca: 12.110622368752956, flat: 6.21052759885788, pod: 69.51273673772812, loss: 87.83388662338257 
Train [6/6] | Epoch [36/120] |	nca: 8.44444439560175, flat: 4.225526116788387, pod: 55.07658541202545, loss: 67.7465558052063 
Train [6/6] | Epoch [37/120] |	nca: 8.366117343306541, flat: 4.306737013161182, pod: 55.52844554185867, loss: 68.20129978656769 
Train [6/6] | Epoch [38/120] |	nca: 8.372917614877224, flat: 4.295593407005072, pod: 56.08485245704651, loss: 68.7533632516861 
Train [6/6] | Epoch [39/120] |	nca: 8.055616326630116, flat: 4.288602747023106, pod: 55.85543632507324, loss: 68.19965553283691 
Train [6/6] | Epoch [40/120] |	nca: 7.211649555712938, flat: 4.034752763807774, pod: 53.44609397649765, loss: 64.69249641895294 
Train [6/6] | Epoch [41/120] |	nca: 6.994672909379005, flat: 3.846125055104494, pod: 50.6587792634964, loss: 61.49957716464996 
Train [6/6] | Epoch [42/120] |	nca: 7.485088810324669, flat: 3.862089466303587, pod: 51.96287024021149, loss: 63.31004858016968 
Train [6/6] | Epoch [43/120] |	nca: 8.103600095957518, flat: 4.528439737856388, pod: 58.46987819671631, loss: 71.10191822052002 
Train [6/6] | Epoch [44/120] |	nca: 7.568377755582333, flat: 4.394000396132469, pod: 56.34602153301239, loss: 68.30839943885803 
Train [6/6] | Epoch [45/120] |	nca: 8.340392015874386, flat: 4.2949589267373085, pod: 55.976825058460236, loss: 68.61217594146729 
Train [6/6] | Epoch [46/120] |	nca: 6.819664843380451, flat: 3.9007867723703384, pod: 52.27195459604263, loss: 62.99240654706955 
Train [6/6] | Epoch [47/120] |	nca: 7.449957996606827, flat: 4.08587159961462, pod: 54.16927444934845, loss: 65.70510387420654 
Train [6/6] | Epoch [48/120] |	nca: 8.828485630452633, flat: 4.30987586826086, pod: 55.523635506629944, loss: 68.66199624538422 
Train [6/6] | Epoch [49/120] |	nca: 8.940280243754387, flat: 4.560020878911018, pod: 57.38119912147522, loss: 70.88150036334991 
Train [6/6] | Epoch [50/120] |	nca: 7.949523277580738, flat: 4.640452906489372, pod: 55.9586364030838, loss: 68.54861283302307 
Train [6/6] | Epoch [51/120] |	nca: 6.3062008656561375, flat: 3.736492123454809, pod: 51.04836642742157, loss: 61.091059148311615 
Train [6/6] | Epoch [52/120] |	nca: 5.874387122690678, flat: 3.58398449793458, pod: 49.266183257102966, loss: 58.72455483675003 
Train [6/6] | Epoch [53/120] |	nca: 5.956111416220665, flat: 3.664838045835495, pod: 49.564410746097565, loss: 59.18536025285721 
Train [6/6] | Epoch [54/120] |	nca: 6.498577948659658, flat: 3.728192627429962, pod: 51.026221334934235, loss: 61.25299197435379 
Train [6/6] | Epoch [55/120] |	nca: 9.947383768856525, flat: 4.848904274404049, pod: 59.65613555908203, loss: 74.45242309570312 
Train [6/6] | Epoch [56/120] |	nca: 6.81355319544673, flat: 3.9714986346662045, pod: 52.96156007051468, loss: 63.7466122508049 
Train [6/6] | Epoch [57/120] |	nca: 7.053139872848988, flat: 3.9230229035019875, pod: 52.29624432325363, loss: 63.27240687608719 
Train [6/6] | Epoch [58/120] |	nca: 5.479744050651789, flat: 3.3393923230469227, pod: 46.4554945230484, loss: 55.27463090419769 
Train [6/6] | Epoch [59/120] |	nca: 7.176241636276245, flat: 4.140236563980579, pod: 53.33674609661102, loss: 64.6532244682312 
Train [6/6] | Epoch [60/120] |	nca: 5.889221541583538, flat: 3.517300520092249, pod: 49.245772898197174, loss: 58.652294874191284 
Train [6/6] | Epoch [61/120] |	nca: 5.169862285256386, flat: 3.3166504502296448, pod: 46.32532054185867, loss: 54.8118332028389 
Train [6/6] | Epoch [62/120] |	nca: 6.110046613961458, flat: 3.543928697705269, pod: 47.63977438211441, loss: 57.29374974966049 
Train [6/6] | Epoch [63/120] |	nca: 5.664897862821817, flat: 3.471275094896555, pod: 47.46901625394821, loss: 56.605189085006714 
Train [6/6] | Epoch [64/120] |	nca: 6.467908252030611, flat: 3.5474298670887947, pod: 48.85661309957504, loss: 58.87195134162903 
Train [6/6] | Epoch [65/120] |	nca: 6.112756744027138, flat: 3.5573843382298946, pod: 47.6271910071373, loss: 57.297332406044006 
Train [6/6] | Epoch [66/120] |	nca: 5.400235377252102, flat: 3.233746636658907, pod: 45.30033612251282, loss: 53.934318244457245 
Train [6/6] | Epoch [67/120] |	nca: 7.650385536253452, flat: 4.272768523544073, pod: 52.11256545782089, loss: 64.03571909666061 
Train [6/6] | Epoch [68/120] |	nca: 4.902688600122929, flat: 3.440161596983671, pod: 46.80959725379944, loss: 55.15244746208191 
Train [6/6] | Epoch [69/120] |	nca: 4.696479447185993, flat: 3.0914526134729385, pod: 43.68101966381073, loss: 51.468951642513275 
Train [6/6] | Epoch [70/120] |	nca: 4.571008771657944, flat: 3.1670955196022987, pod: 44.20716905593872, loss: 51.94527322053909 
Train [6/6] | Epoch [71/120] |	nca: 4.558417055755854, flat: 2.98701598867774, pod: 43.91083753108978, loss: 51.45627063512802 
Train [6/6] | Epoch [72/120] |	nca: 4.12148605287075, flat: 2.864607512950897, pod: 41.348335444927216, loss: 48.33442938327789 
Train [6/6] | Epoch [73/120] |	nca: 4.3507020100951195, flat: 2.854751303792, pod: 42.03627568483353, loss: 49.24172884225845 
Train [6/6] | Epoch [74/120] |	nca: 5.048629175871611, flat: 3.007914885878563, pod: 41.84923070669174, loss: 49.90577495098114 
Train [6/6] | Epoch [75/120] |	nca: 4.082948803901672, flat: 2.91177898645401, pod: 42.914330899715424, loss: 49.909058690071106 
Train [6/6] | Epoch [76/120] |	nca: 3.856193669140339, flat: 2.8135294280946255, pod: 41.368910014629364, loss: 48.03863334655762 
Train [6/6] | Epoch [77/120] |	nca: 3.541807010769844, flat: 2.703446477651596, pod: 39.32396847009659, loss: 45.56922197341919 
Train [6/6] | Epoch [78/120] |	nca: 3.579935748130083, flat: 2.709457900375128, pod: 38.44840055704117, loss: 44.73779410123825 
Train [6/6] | Epoch [79/120] |	nca: 3.337890647351742, flat: 2.685624063014984, pod: 40.48553431034088, loss: 46.509048759937286 
Train [6/6] | Epoch [80/120] |	nca: 3.3837644793093204, flat: 2.746126066893339, pod: 39.67791390419006, loss: 45.807804346084595 
Train [6/6] | Epoch [81/120] |	nca: 3.5592254400253296, flat: 2.569968994706869, pod: 37.316441118717194, loss: 43.445635199546814 
Train [6/6] | Epoch [82/120] |	nca: 3.437227787449956, flat: 2.6198170632123947, pod: 38.22095239162445, loss: 44.27799719572067 
Train [6/6] | Epoch [83/120] |	nca: 3.660175185650587, flat: 2.5005837939679623, pod: 36.4071848988533, loss: 42.56794363260269 
Train [6/6] | Epoch [84/120] |	nca: 3.03591226041317, flat: 2.536136019974947, pod: 37.66537803411484, loss: 43.23742628097534 
Train [6/6] | Epoch [85/120] |	nca: 3.1721749529242516, flat: 2.345870140939951, pod: 34.96432891488075, loss: 40.482374012470245 
Train [6/6] | Epoch [86/120] |	nca: 3.7706856429576874, flat: 2.6783956177532673, pod: 38.04891896247864, loss: 44.49800008535385 
Train [6/6] | Epoch [87/120] |	nca: 2.980152202770114, flat: 2.355388507246971, pod: 34.85017651319504, loss: 40.18571710586548 
Train [6/6] | Epoch [88/120] |	nca: 3.117393735796213, flat: 2.3396960347890854, pod: 35.23163324594498, loss: 40.6887229681015 
Train [6/6] | Epoch [89/120] |	nca: 2.942364327609539, flat: 2.237619385123253, pod: 33.234018832445145, loss: 38.414002418518066 
Train [6/6] | Epoch [90/120] |	nca: 2.8495895992964506, flat: 2.3380065746605396, pod: 35.09495994448662, loss: 40.282555997371674 
Train [6/6] | Epoch [91/120] |	nca: 3.4538098871707916, flat: 2.4008639063686132, pod: 35.24180996417999, loss: 41.09648388624191 
Train [6/6] | Epoch [92/120] |	nca: 3.032471690326929, flat: 2.1792754232883453, pod: 32.61939764022827, loss: 37.8311448097229 
Train [6/6] | Epoch [93/120] |	nca: 3.5013136118650436, flat: 2.3253909423947334, pod: 35.146121859550476, loss: 40.97282648086548 
Train [6/6] | Epoch [94/120] |	nca: 2.889103475958109, flat: 2.213886581361294, pod: 33.362424463033676, loss: 38.465414464473724 
Train [6/6] | Epoch [95/120] |	nca: 2.53708952665329, flat: 2.1214951556175947, pod: 31.210203737020493, loss: 35.86878854036331 
Train [6/6] | Epoch [96/120] |	nca: 3.005565345287323, flat: 2.1354077346622944, pod: 30.94244709610939, loss: 36.083420276641846 
Train [6/6] | Epoch [97/120] |	nca: 2.5021433290094137, flat: 2.1567377541214228, pod: 32.030708342790604, loss: 36.68958938121796 
Train [6/6] | Epoch [98/120] |	nca: 2.5585460048168898, flat: 2.097562300041318, pod: 31.502708822488785, loss: 36.15881711244583 
Train [6/6] | Epoch [99/120] |	nca: 3.3266297057271004, flat: 2.1227201763540506, pod: 30.608829379081726, loss: 36.05817922949791 
Train [6/6] | Epoch [100/120] |	nca: 2.801113300025463, flat: 2.05836477689445, pod: 30.161302864551544, loss: 35.02078104019165 
Train [6/6] | Epoch [101/120] |	nca: 2.7605712078511715, flat: 1.9696726221591234, pod: 29.471908628940582, loss: 34.20215240120888 
Train [6/6] | Epoch [102/120] |	nca: 2.815841108560562, flat: 2.0842645037919283, pod: 29.910776168107986, loss: 34.81088161468506 
Train [6/6] | Epoch [103/120] |	nca: 2.763396767899394, flat: 2.043942227959633, pod: 29.483790040016174, loss: 34.29112905263901 
Train [6/6] | Epoch [104/120] |	nca: 2.740513587370515, flat: 2.0111917927861214, pod: 28.678304225206375, loss: 33.43000954389572 
Train [6/6] | Epoch [105/120] |	nca: 2.7072969302535057, flat: 2.025852132588625, pod: 28.265828788280487, loss: 32.99897789955139 
Train [6/6] | Epoch [106/120] |	nca: 3.4209218565374613, flat: 2.1504096928983927, pod: 29.79566216468811, loss: 35.36699378490448 
Train [6/6] | Epoch [107/120] |	nca: 2.6760101933032274, flat: 1.9197021946310997, pod: 27.667447477579117, loss: 32.26315996050835 
Train [6/6] | Epoch [108/120] |	nca: 2.4405215326696634, flat: 1.822839206084609, pod: 26.664153963327408, loss: 30.927514612674713 
Train [6/6] | Epoch [109/120] |	nca: 2.277540987357497, flat: 1.8167703114449978, pod: 26.734778821468353, loss: 30.829089999198914 
Train [6/6] | Epoch [110/120] |	nca: 2.207418942824006, flat: 1.883312925696373, pod: 27.547972589731216, loss: 31.638704389333725 
Train [6/6] | Epoch [111/120] |	nca: 2.4889071751385927, flat: 1.8447047043591738, pod: 26.59535750746727, loss: 30.92896944284439 
Train [6/6] | Epoch [112/120] |	nca: 2.568265913054347, flat: 1.866310941055417, pod: 27.24317103624344, loss: 31.677747905254364 
Train [6/6] | Epoch [113/120] |	nca: 2.276959864422679, flat: 1.8635897599160671, pod: 26.375808209180832, loss: 30.516357988119125 
Train [6/6] | Epoch [114/120] |	nca: 2.124385565519333, flat: 1.867715671658516, pod: 27.100455969572067, loss: 31.0925575196743 
Train [6/6] | Epoch [115/120] |	nca: 2.0191234685480595, flat: 1.7887806724756956, pod: 25.73312884569168, loss: 29.541033029556274 
Train [6/6] | Epoch [116/120] |	nca: 2.2706344481557608, flat: 1.7926830053329468, pod: 26.228823870420456, loss: 30.292141288518906 
Train [6/6] | Epoch [117/120] |	nca: 2.30189273878932, flat: 1.7357140239328146, pod: 24.817787140607834, loss: 28.855393916368484 
Train [6/6] | Epoch [118/120] |	nca: 2.2173158545047045, flat: 1.7432782910764217, pod: 24.71118250489235, loss: 28.671776711940765 
Train [6/6] | Epoch [119/120] |	nca: 2.277715787291527, flat: 1.8767327219247818, pod: 26.63789728283882, loss: 30.79234603047371 
Train [6/6] | Epoch [120/120] |	nca: 2.1675653848797083, flat: 1.8804796878248453, pod: 26.941132307052612, loss: 30.989177376031876 
Fine-tuning
Building & updating memory.
Train [6/6] | Epoch [121/140] |	nca: 6.536689877510071, flat: 1.5539762079715729, pod: 18.66848349571228, loss: 26.75914967060089 
Train [6/6] | Epoch [122/140] |	nca: 2.186600513756275, flat: 1.6186039932072163, pod: 18.952203929424286, loss: 22.757408380508423 
Train [6/6] | Epoch [123/140] |	nca: 1.4227062910795212, flat: 1.5866025164723396, pod: 18.950781166553497, loss: 21.960090041160583 
Train [6/6] | Epoch [124/140] |	nca: 1.3855373039841652, flat: 1.5879728943109512, pod: 18.828369855880737, loss: 21.80188012123108 
Train [6/6] | Epoch [125/140] |	nca: 1.2579641304910183, flat: 1.5481549128890038, pod: 18.714763164520264, loss: 21.52088212966919 
Train [6/6] | Epoch [126/140] |	nca: 1.271671298891306, flat: 1.6013901606202126, pod: 18.99006152153015, loss: 21.863123059272766 
Train [6/6] | Epoch [127/140] |	nca: 1.4268690943717957, flat: 1.6280509233474731, pod: 19.121331214904785, loss: 22.17625117301941 
Train [6/6] | Epoch [128/140] |	nca: 1.234024304896593, flat: 1.611563466489315, pod: 18.764377534389496, loss: 21.609965324401855 
Train [6/6] | Epoch [129/140] |	nca: 1.2322966158390045, flat: 1.5882988944649696, pod: 18.78974747657776, loss: 21.610342979431152 
Train [6/6] | Epoch [130/140] |	nca: 1.2400855123996735, flat: 1.5942594408988953, pod: 18.860852897167206, loss: 21.695197701454163 
Train [6/6] | Epoch [131/140] |	nca: 1.16881862282753, flat: 1.6222981959581375, pod: 19.166047632694244, loss: 21.957164585590363 
Train [6/6] | Epoch [132/140] |	nca: 1.2294947504997253, flat: 1.6275069937109947, pod: 18.94319796562195, loss: 21.80019974708557 
Train [6/6] | Epoch [133/140] |	nca: 1.2585326470434666, flat: 1.622787356376648, pod: 19.082663357257843, loss: 21.9639835357666 
Train [6/6] | Epoch [134/140] |	nca: 1.1243736371397972, flat: 1.6088470295071602, pod: 18.995968103408813, loss: 21.729188919067383 
Train [6/6] | Epoch [135/140] |	nca: 1.116373535245657, flat: 1.6068740412592888, pod: 18.959685564041138, loss: 21.6829332113266 
Train [6/6] | Epoch [136/140] |	nca: 1.109947096556425, flat: 1.5962600409984589, pod: 18.87118273973465, loss: 21.57738983631134 
Train [6/6] | Epoch [137/140] |	nca: 1.1094215847551823, flat: 1.5512967854738235, pod: 18.737452149391174, loss: 21.398170351982117 
Train [6/6] | Epoch [138/140] |	nca: 1.103403426706791, flat: 1.6485679224133492, pod: 19.13845193386078, loss: 21.89042317867279 
Train [6/6] | Epoch [139/140] |	nca: 1.126916341483593, flat: 1.6046065390110016, pod: 19.00499051809311, loss: 21.736513376235962 
Train [6/6] | Epoch [140/140] |	nca: 1.0771394222974777, flat: 1.622323714196682, pod: 18.9841365814209, loss: 21.683599591255188 
after task
Building & updating memory.
after task
Saving model at results\dev\podnet\202401\week_1\20240102_podnet_nme_cifar10_5steps\net_0_task_5.pth.
Saving metadata at results\dev\podnet\202401\week_1\20240102_podnet_nme_cifar10_5steps\meta_0_task_5.pkl.
Eval on 0->10.
eval task
podnet_nme_cifar10_5steps
Avg inc acc: 0.831.
Current acc: {'total': 0.747, '00-09': 0.747}.
Avg inc acc top5: 0.9951666666666666.
Current acc top5: {'total': 0.987}.
Forgetting: 0.11199999999999999.
Cord metric: 0.78.
Old accuracy: 0.76, mean: 0.82.
New accuracy: 0.61, mean: 0.70.
Average Incremental Accuracy: 0.831.
Label was: podnet_nme_cifar10_5steps
Results done on 1 seeds: avg: 83.1, last: 74.7, forgetting: 11.2
Individual results avg: [83.1]
Individual results last: [74.7]
Individual results forget: [11.2]
Command was D:/go_to_D/ML/Final/LibContinual/run_trainer.py
Time cost :  5186.33190870285
