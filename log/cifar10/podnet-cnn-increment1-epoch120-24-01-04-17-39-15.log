Label: podnet_cnn_cifar10_5steps
orders : None
{'model': 'podnet', 'convnet': 'rebuffi', 'dropout': 0.0, 'herding': None, 'memory_size': 2000, 'temperature': 1, 'fixed_memory': True, 'dataset': 'cifar10', 'increment': 1, 'batch_size': 128, 'workers': 0, 'threads': 1, 'validation': 0.0, 'random_classes': True, 'max_task': None, 'onehot': False, 'initial_increment': 5, 'sampler': None, 'data_path': '/data/douillard/', 'lr': 0.1, 'weight_decay': 0.0005, 'scheduling': 'cosine', 'lr_decay': 0.1, 'optimizer': 'sgd', 'epochs': 120, 'device': [0], 'label': 'podnet_cnn_cifar10_5steps', 'autolabel': False, 'seed': [1], 'seed_range': None, 'options': None, 'save_model': 'last', 'dump_predictions': False, 'logging': 'info', 'resume': None, 'resume_first': False, 'recompute_meta': False, 'no_benchmark': False, 'detect_anomaly': False, 'dummy': 1, 'includes': ['headers/dummy.yaml'], 'data_root': 'D:/data/douillard/cifar10/cifar10', 'save_path': '.', 'eval_type': 'cnn', 'backbone': {'name': 'resnet18'}, 'classifier': {'name': 'PODNet'}, 'classifier_config': {'type': 'cosine', 'proxy_per_class': 10, 'distance': 'neg_stable_cosine_distance'}, 'postprocessor_config': {'type': 'learned_scaling', 'initial_value': 1.0}, 'pod_flat': {'scheduled_factor': 1.0}, 'pod_spatial': {'scheduled_factor': 3.0, 'collapse_channels': 'spatial'}, 'nca': {'margin': 0.6, 'scale': 1.0, 'exclude_pos_denominator': True}, 'groupwise_factors': {'old_weights': 0.0}, 'finetuning_config': {'sampling': 'undersampling', 'tuning': 'classifier', 'lr': 0.05, 'epochs': 20, 'scaling': None}, 'proxy_per_class': 1, 'weight_generation': {'type': 'imprinted', 'multi_class_diff': 'kmeans'}, 'dataset_transforms': {'color_jitter': True}}
Launching run 1/1
Set seed 1
CUDA algos are determinists but very slow!
Files already downloaded and verified
Files already downloaded and verified
Dataset iCIFAR10: class ordering: [6, 8, 9, 7, 5, 3, 0, 4, 1, 2].
Downsampling type stride
Using 10 proxies per class.
Model will be save at this rythm: last.
================Task 0 Start!================
Testing on False unseen tasks (max class = 5).
Before task
Now 200 examplars per class.
Group: convnet, lr: 0.1.
Group: postprocessing, lr: 0.1.
Group: new_weights, lr: 0.1.
================Task 0 Training!================
The training samples number: 25000
Train on 0->5.
train task
nb 25000.
Train [1/6] | Epoch [1/120] |	nca: 245.8408352136612, loss: 245.8408352136612 
Train [1/6] | Epoch [2/120] |	nca: 172.5943865776062, loss: 172.5943865776062 
Train [1/6] | Epoch [3/120] |	nca: 122.78007876873016, loss: 122.78007876873016 
Train [1/6] | Epoch [4/120] |	nca: 102.02858290076256, loss: 102.02858290076256 
Train [1/6] | Epoch [5/120] |	nca: 89.43182381987572, loss: 89.43182381987572 
Train [1/6] | Epoch [6/120] |	nca: 81.16078592836857, loss: 81.16078592836857 
Train [1/6] | Epoch [7/120] |	nca: 77.56302607059479, loss: 77.56302607059479 
Train [1/6] | Epoch [8/120] |	nca: 69.65983571112156, loss: 69.65983571112156 
Train [1/6] | Epoch [9/120] |	nca: 67.30038060247898, loss: 67.30038060247898 
Train [1/6] | Epoch [10/120] |	nca: 63.35206197202206, loss: 63.35206197202206 
Train [1/6] | Epoch [11/120] |	nca: 63.4706047475338, loss: 63.4706047475338 
Train [1/6] | Epoch [12/120] |	nca: 61.91594834625721, loss: 61.91594834625721 
Train [1/6] | Epoch [13/120] |	nca: 58.834900572896004, loss: 58.834900572896004 
Train [1/6] | Epoch [14/120] |	nca: 56.784416645765305, loss: 56.784416645765305 
Train [1/6] | Epoch [15/120] |	nca: 54.47796542942524, loss: 54.47796542942524 
Train [1/6] | Epoch [16/120] |	nca: 55.559927716851234, loss: 55.559927716851234 
Train [1/6] | Epoch [17/120] |	nca: 54.12913544476032, loss: 54.12913544476032 
Train [1/6] | Epoch [18/120] |	nca: 53.073642402887344, loss: 53.073642402887344 
Train [1/6] | Epoch [19/120] |	nca: 50.87010081857443, loss: 50.87010081857443 
Train [1/6] | Epoch [20/120] |	nca: 50.47608771920204, loss: 50.47608771920204 
Train [1/6] | Epoch [21/120] |	nca: 51.25454207509756, loss: 51.25454207509756 
Train [1/6] | Epoch [22/120] |	nca: 49.460700169205666, loss: 49.460700169205666 
Train [1/6] | Epoch [23/120] |	nca: 49.17236062884331, loss: 49.17236062884331 
Train [1/6] | Epoch [24/120] |	nca: 46.83349861949682, loss: 46.83349861949682 
Train [1/6] | Epoch [25/120] |	nca: 47.089063577353954, loss: 47.089063577353954 
Train [1/6] | Epoch [26/120] |	nca: 47.94596654176712, loss: 47.94596654176712 
Train [1/6] | Epoch [27/120] |	nca: 45.37578894942999, loss: 45.37578894942999 
Train [1/6] | Epoch [28/120] |	nca: 44.7356171682477, loss: 44.7356171682477 
Train [1/6] | Epoch [29/120] |	nca: 45.168326146900654, loss: 45.168326146900654 
Train [1/6] | Epoch [30/120] |	nca: 43.84719205647707, loss: 43.84719205647707 
Train [1/6] | Epoch [31/120] |	nca: 42.72599148750305, loss: 42.72599148750305 
Train [1/6] | Epoch [32/120] |	nca: 43.578373700380325, loss: 43.578373700380325 
Train [1/6] | Epoch [33/120] |	nca: 42.7602099403739, loss: 42.7602099403739 
Train [1/6] | Epoch [34/120] |	nca: 41.44649402052164, loss: 41.44649402052164 
Train [1/6] | Epoch [35/120] |	nca: 41.23208089917898, loss: 41.23208089917898 
Train [1/6] | Epoch [36/120] |	nca: 41.45045995339751, loss: 41.45045995339751 
Train [1/6] | Epoch [37/120] |	nca: 39.988542944192886, loss: 39.988542944192886 
Train [1/6] | Epoch [38/120] |	nca: 39.93265783786774, loss: 39.93265783786774 
Train [1/6] | Epoch [39/120] |	nca: 41.36157989501953, loss: 41.36157989501953 
Train [1/6] | Epoch [40/120] |	nca: 39.25457309931517, loss: 39.25457309931517 
Train [1/6] | Epoch [41/120] |	nca: 37.54802066087723, loss: 37.54802066087723 
Train [1/6] | Epoch [42/120] |	nca: 37.44420774281025, loss: 37.44420774281025 
Train [1/6] | Epoch [43/120] |	nca: 37.67340023070574, loss: 37.67340023070574 
Train [1/6] | Epoch [44/120] |	nca: 37.58645989745855, loss: 37.58645989745855 
Train [1/6] | Epoch [45/120] |	nca: 36.49546932429075, loss: 36.49546932429075 
Train [1/6] | Epoch [46/120] |	nca: 35.04204720258713, loss: 35.04204720258713 
Train [1/6] | Epoch [47/120] |	nca: 35.664037972688675, loss: 35.664037972688675 
Train [1/6] | Epoch [48/120] |	nca: 34.65353090316057, loss: 34.65353090316057 
Train [1/6] | Epoch [49/120] |	nca: 35.572185568511486, loss: 35.572185568511486 
Train [1/6] | Epoch [50/120] |	nca: 33.81679506227374, loss: 33.81679506227374 
Train [1/6] | Epoch [51/120] |	nca: 32.9052422195673, loss: 32.9052422195673 
Train [1/6] | Epoch [52/120] |	nca: 33.15567522868514, loss: 33.15567522868514 
Train [1/6] | Epoch [53/120] |	nca: 31.450403779745102, loss: 31.450403779745102 
Train [1/6] | Epoch [54/120] |	nca: 34.26010449975729, loss: 34.26010449975729 
Train [1/6] | Epoch [55/120] |	nca: 31.601949632167816, loss: 31.601949632167816 
Train [1/6] | Epoch [56/120] |	nca: 31.725672975182533, loss: 31.725672975182533 
Train [1/6] | Epoch [57/120] |	nca: 28.952415395528078, loss: 28.952415395528078 
Train [1/6] | Epoch [58/120] |	nca: 29.77424867451191, loss: 29.77424867451191 
Train [1/6] | Epoch [59/120] |	nca: 30.800806496292353, loss: 30.800806496292353 
Train [1/6] | Epoch [60/120] |	nca: 28.181162133812904, loss: 28.181162133812904 
Train [1/6] | Epoch [61/120] |	nca: 28.18985367566347, loss: 28.18985367566347 
Train [1/6] | Epoch [62/120] |	nca: 26.925289779901505, loss: 26.925289779901505 
Train [1/6] | Epoch [63/120] |	nca: 27.081361396238208, loss: 27.081361396238208 
Train [1/6] | Epoch [64/120] |	nca: 26.434019286185503, loss: 26.434019286185503 
Train [1/6] | Epoch [65/120] |	nca: 26.650334242731333, loss: 26.650334242731333 
Train [1/6] | Epoch [66/120] |	nca: 26.487534064799547, loss: 26.487534064799547 
Train [1/6] | Epoch [67/120] |	nca: 23.778376234695315, loss: 23.778376234695315 
Train [1/6] | Epoch [68/120] |	nca: 24.291168808937073, loss: 24.291168808937073 
Train [1/6] | Epoch [69/120] |	nca: 24.489956106990576, loss: 24.489956106990576 
Train [1/6] | Epoch [70/120] |	nca: 22.476315023377538, loss: 22.476315023377538 
Train [1/6] | Epoch [71/120] |	nca: 22.503997141495347, loss: 22.503997141495347 
Train [1/6] | Epoch [72/120] |	nca: 21.6598435100168, loss: 21.6598435100168 
Train [1/6] | Epoch [73/120] |	nca: 21.587385354563594, loss: 21.587385354563594 
Train [1/6] | Epoch [74/120] |	nca: 20.210880786180496, loss: 20.210880786180496 
Train [1/6] | Epoch [75/120] |	nca: 19.625069089233875, loss: 19.625069089233875 
Train [1/6] | Epoch [76/120] |	nca: 21.642834179103374, loss: 21.642834179103374 
Train [1/6] | Epoch [77/120] |	nca: 18.291334059089422, loss: 18.291334059089422 
Train [1/6] | Epoch [78/120] |	nca: 18.65569807961583, loss: 18.65569807961583 
Train [1/6] | Epoch [79/120] |	nca: 17.62219910696149, loss: 17.62219910696149 
Train [1/6] | Epoch [80/120] |	nca: 17.407912705093622, loss: 17.407912705093622 
Train [1/6] | Epoch [81/120] |	nca: 16.496454492211342, loss: 16.496454492211342 
Train [1/6] | Epoch [82/120] |	nca: 16.820061057806015, loss: 16.820061057806015 
Train [1/6] | Epoch [83/120] |	nca: 15.35195083450526, loss: 15.35195083450526 
Train [1/6] | Epoch [84/120] |	nca: 13.914684473536909, loss: 13.914684473536909 
Train [1/6] | Epoch [85/120] |	nca: 14.0109041351825, loss: 14.0109041351825 
Train [1/6] | Epoch [86/120] |	nca: 12.465625306591392, loss: 12.465625306591392 
Train [1/6] | Epoch [87/120] |	nca: 12.355045438744128, loss: 12.355045438744128 
Train [1/6] | Epoch [88/120] |	nca: 11.348202416673303, loss: 11.348202416673303 
Train [1/6] | Epoch [89/120] |	nca: 11.009868800640106, loss: 11.009868800640106 
Train [1/6] | Epoch [90/120] |	nca: 10.398885025642812, loss: 10.398885025642812 
Train [1/6] | Epoch [91/120] |	nca: 11.372860364150256, loss: 11.372860364150256 
Train [1/6] | Epoch [92/120] |	nca: 9.965923971962184, loss: 9.965923971962184 
Train [1/6] | Epoch [93/120] |	nca: 8.111091959290206, loss: 8.111091959290206 
Train [1/6] | Epoch [94/120] |	nca: 7.646015346981585, loss: 7.646015346981585 
Train [1/6] | Epoch [95/120] |	nca: 6.757473370293155, loss: 6.757473370293155 
Train [1/6] | Epoch [96/120] |	nca: 6.746314025949687, loss: 6.746314025949687 
Train [1/6] | Epoch [97/120] |	nca: 5.69044786458835, loss: 5.69044786458835 
Train [1/6] | Epoch [98/120] |	nca: 5.551049451343715, loss: 5.551049451343715 
Train [1/6] | Epoch [99/120] |	nca: 4.650478226249106, loss: 4.650478226249106 
Train [1/6] | Epoch [100/120] |	nca: 4.592842740938067, loss: 4.592842740938067 
Train [1/6] | Epoch [101/120] |	nca: 3.962735577719286, loss: 3.962735577719286 
Train [1/6] | Epoch [102/120] |	nca: 3.7106836666353047, loss: 3.7106836666353047 
Train [1/6] | Epoch [103/120] |	nca: 3.0817868828307837, loss: 3.0817868828307837 
Train [1/6] | Epoch [104/120] |	nca: 2.8189788802992553, loss: 2.8189788802992553 
Train [1/6] | Epoch [105/120] |	nca: 2.195655744872056, loss: 2.195655744872056 
Train [1/6] | Epoch [106/120] |	nca: 1.8336870921775699, loss: 1.8336870921775699 
Train [1/6] | Epoch [107/120] |	nca: 1.8560217798221856, loss: 1.8560217798221856 
Train [1/6] | Epoch [108/120] |	nca: 1.4504967533284798, loss: 1.4504967533284798 
Train [1/6] | Epoch [109/120] |	nca: 1.6059455482754856, loss: 1.6059455482754856 
Train [1/6] | Epoch [110/120] |	nca: 1.335516064427793, loss: 1.335516064427793 
Train [1/6] | Epoch [111/120] |	nca: 1.2380568476510234, loss: 1.2380568476510234 
Train [1/6] | Epoch [112/120] |	nca: 1.103980946354568, loss: 1.103980946354568 
Train [1/6] | Epoch [113/120] |	nca: 1.1307565013412386, loss: 1.1307565013412386 
Train [1/6] | Epoch [114/120] |	nca: 1.3132521962979808, loss: 1.3132521962979808 
Train [1/6] | Epoch [115/120] |	nca: 0.8999430210096762, loss: 0.8999430210096762 
Train [1/6] | Epoch [116/120] |	nca: 0.9052222461323254, loss: 0.9052222461323254 
Train [1/6] | Epoch [117/120] |	nca: 0.9571318146772683, loss: 0.9571318146772683 
Train [1/6] | Epoch [118/120] |	nca: 1.060318163363263, loss: 1.060318163363263 
Train [1/6] | Epoch [119/120] |	nca: 0.9505865636165254, loss: 0.9505865636165254 
Train [1/6] | Epoch [120/120] |	nca: 0.9351504602236673, loss: 0.9351504602236673 
after task
Building & updating memory.
after task
Eval on 0->5.
eval task
podnet_cnn_cifar10_5steps
Avg inc acc: 0.972.
Current acc: {'total': 0.972, '00-09': 0.972}.
Avg inc acc top5: 1.0.
Current acc top5: {'total': 1.0}.
Forgetting: 0.0.
Cord metric: 0.97.
================Task 1 Start!================
Testing on False unseen tasks (max class = 6).
Set memory of size: 1000.
Before task
Generating imprinted weights
Multi class diff kmeans.
Now 200 examplars per class.
Group: convnet, lr: 0.1.
Group: postprocessing, lr: 0.1.
Group: new_weights, lr: 0.1.
================Task 1 Training!================
The training samples number: 6000
Train on 5->6.
train task
nb 6000.
Train [2/6] | Epoch [1/120] |	nca: 36.04101550579071, flat: 46.482607543468475, pod: 169.88191151618958, loss: 252.40553498268127 
Train [2/6] | Epoch [2/120] |	nca: 19.61983436346054, flat: 29.537445902824402, pod: 126.13361191749573, loss: 175.2908914089203 
Train [2/6] | Epoch [3/120] |	nca: 16.18419098854065, flat: 24.17779365181923, pod: 109.31939435005188, loss: 149.68137884140015 
Train [2/6] | Epoch [4/120] |	nca: 14.65604755282402, flat: 21.515769809484482, pod: 98.3851717710495, loss: 134.5569887161255 
Train [2/6] | Epoch [5/120] |	nca: 13.531181618571281, flat: 20.127381503582, pod: 92.04278373718262, loss: 125.70134687423706 
Train [2/6] | Epoch [6/120] |	nca: 13.051017940044403, flat: 19.66931927204132, pod: 90.21838688850403, loss: 122.93872475624084 
Train [2/6] | Epoch [7/120] |	nca: 11.896543517708778, flat: 18.449926048517227, pod: 84.31202161312103, loss: 114.65848970413208 
Train [2/6] | Epoch [8/120] |	nca: 11.43812195956707, flat: 17.881551802158356, pod: 82.19014656543732, loss: 111.50982022285461 
Train [2/6] | Epoch [9/120] |	nca: 10.31055024266243, flat: 16.946986079216003, pod: 75.69993269443512, loss: 102.9574682712555 
Train [2/6] | Epoch [10/120] |	nca: 10.741516306996346, flat: 16.982094526290894, pod: 76.69370234012604, loss: 104.41731238365173 
Train [2/6] | Epoch [11/120] |	nca: 10.46779190003872, flat: 17.20857524871826, pod: 76.44177258014679, loss: 104.11813926696777 
Train [2/6] | Epoch [12/120] |	nca: 10.096491917967796, flat: 17.505816787481308, pod: 78.35099339485168, loss: 105.95330262184143 
Train [2/6] | Epoch [13/120] |	nca: 9.912909232079983, flat: 16.09235829114914, pod: 71.57135248184204, loss: 97.57661986351013 
Train [2/6] | Epoch [14/120] |	nca: 10.682165324687958, flat: 16.29113519191742, pod: 72.5912275314331, loss: 99.56452870368958 
Train [2/6] | Epoch [15/120] |	nca: 9.613340303301811, flat: 16.570715695619583, pod: 73.22221493721008, loss: 99.40627038478851 
Train [2/6] | Epoch [16/120] |	nca: 8.971835754811764, flat: 16.20774155855179, pod: 70.97846126556396, loss: 96.15803921222687 
Train [2/6] | Epoch [17/120] |	nca: 9.045908473432064, flat: 15.827674597501755, pod: 68.86511182785034, loss: 93.73869514465332 
Train [2/6] | Epoch [18/120] |	nca: 8.728370286524296, flat: 15.375938832759857, pod: 67.59747862815857, loss: 91.70178818702698 
Train [2/6] | Epoch [19/120] |	nca: 8.884965226054192, flat: 15.165338844060898, pod: 64.89391267299652, loss: 88.94421708583832 
Train [2/6] | Epoch [20/120] |	nca: 8.578559629619122, flat: 15.39264103770256, pod: 66.55160820484161, loss: 90.52280867099762 
Train [2/6] | Epoch [21/120] |	nca: 8.409754946827888, flat: 14.804860055446625, pod: 63.174299001693726, loss: 86.38891434669495 
Train [2/6] | Epoch [22/120] |	nca: 8.181243486702442, flat: 15.317606568336487, pod: 65.93926405906677, loss: 89.43811440467834 
Train [2/6] | Epoch [23/120] |	nca: 7.36413498967886, flat: 14.54874125123024, pod: 62.06402277946472, loss: 83.9768990278244 
Train [2/6] | Epoch [24/120] |	nca: 8.919353239238262, flat: 15.202577233314514, pod: 65.55059909820557, loss: 89.67252969741821 
Train [2/6] | Epoch [25/120] |	nca: 7.8032882288098335, flat: 14.925397396087646, pod: 62.843037128448486, loss: 85.5717226266861 
Train [2/6] | Epoch [26/120] |	nca: 8.632902167737484, flat: 14.737500458955765, pod: 63.51083815097809, loss: 86.88124096393585 
Train [2/6] | Epoch [27/120] |	nca: 7.450771242380142, flat: 14.92182970046997, pod: 61.90079843997955, loss: 84.27339959144592 
Train [2/6] | Epoch [28/120] |	nca: 8.278852134943008, flat: 14.943316400051117, pod: 64.53962051868439, loss: 87.76178908348083 
Train [2/6] | Epoch [29/120] |	nca: 8.399885646998882, flat: 15.14214038848877, pod: 64.62606501579285, loss: 88.16809177398682 
Train [2/6] | Epoch [30/120] |	nca: 7.73680504411459, flat: 15.222017139196396, pod: 64.99796390533447, loss: 87.9567860364914 
Train [2/6] | Epoch [31/120] |	nca: 7.624832235276699, flat: 14.507849767804146, pod: 61.20239317417145, loss: 83.33507490158081 
Train [2/6] | Epoch [32/120] |	nca: 7.710867814719677, flat: 14.517030462622643, pod: 61.8729430437088, loss: 84.1008415222168 
Train [2/6] | Epoch [33/120] |	nca: 7.521573685109615, flat: 14.805765345692635, pod: 61.74182200431824, loss: 84.06916081905365 
Train [2/6] | Epoch [34/120] |	nca: 7.746741019189358, flat: 14.390672534704208, pod: 60.08767855167389, loss: 82.22509181499481 
Train [2/6] | Epoch [35/120] |	nca: 9.046153672039509, flat: 15.432362228631973, pod: 62.84692692756653, loss: 87.32544267177582 
Train [2/6] | Epoch [36/120] |	nca: 7.661173827946186, flat: 14.778049930930138, pod: 61.6712886095047, loss: 84.11051225662231 
Train [2/6] | Epoch [37/120] |	nca: 7.197543315589428, flat: 14.38567091524601, pod: 60.39116859436035, loss: 81.97438287734985 
Train [2/6] | Epoch [38/120] |	nca: 6.8834293484687805, flat: 14.004642233252525, pod: 57.795459508895874, loss: 78.6835310459137 
Train [2/6] | Epoch [39/120] |	nca: 7.530790194869041, flat: 13.850061103701591, pod: 57.40450835227966, loss: 78.78535962104797 
Train [2/6] | Epoch [40/120] |	nca: 6.8976559564471245, flat: 13.65117034316063, pod: 56.81634747982025, loss: 77.36517333984375 
Train [2/6] | Epoch [41/120] |	nca: 6.897700682282448, flat: 13.698962688446045, pod: 57.6690958738327, loss: 78.26575899124146 
Train [2/6] | Epoch [42/120] |	nca: 7.006901443004608, flat: 14.196851879358292, pod: 59.481276631355286, loss: 80.6850301027298 
Train [2/6] | Epoch [43/120] |	nca: 6.965685918927193, flat: 14.067296504974365, pod: 58.323726415634155, loss: 79.35670900344849 
Train [2/6] | Epoch [44/120] |	nca: 6.910766489803791, flat: 14.093767642974854, pod: 57.75751972198486, loss: 78.76205360889435 
Train [2/6] | Epoch [45/120] |	nca: 6.387319773435593, flat: 13.255570828914642, pod: 54.5608674287796, loss: 74.20375800132751 
Train [2/6] | Epoch [46/120] |	nca: 6.7507884204387665, flat: 13.780650690197945, pod: 57.9215145111084, loss: 78.45295369625092 
Train [2/6] | Epoch [47/120] |	nca: 6.444046884775162, flat: 13.573826730251312, pod: 56.38442349433899, loss: 76.4022969007492 
Train [2/6] | Epoch [48/120] |	nca: 6.447265561670065, flat: 13.380630999803543, pod: 54.713520526885986, loss: 74.54141747951508 
Train [2/6] | Epoch [49/120] |	nca: 6.4246740862727165, flat: 14.10773654282093, pod: 56.39504837989807, loss: 76.92745876312256 
Train [2/6] | Epoch [50/120] |	nca: 6.498421341180801, flat: 13.737611517310143, pod: 57.36254942417145, loss: 77.59858191013336 
Train [2/6] | Epoch [51/120] |	nca: 6.064381763339043, flat: 13.075634375214577, pod: 52.34671473503113, loss: 71.48673105239868 
Train [2/6] | Epoch [52/120] |	nca: 5.89865504950285, flat: 12.910624474287033, pod: 53.13311576843262, loss: 71.9423953294754 
Train [2/6] | Epoch [53/120] |	nca: 6.048738949000835, flat: 13.343664944171906, pod: 53.931973934173584, loss: 73.32437789440155 
Train [2/6] | Epoch [54/120] |	nca: 6.075917422771454, flat: 13.23427402973175, pod: 53.639695167541504, loss: 72.9498862028122 
Train [2/6] | Epoch [55/120] |	nca: 5.928511783480644, flat: 12.949175238609314, pod: 51.64730226993561, loss: 70.52498888969421 
Train [2/6] | Epoch [56/120] |	nca: 6.39025704190135, flat: 13.029717355966568, pod: 52.91725480556488, loss: 72.33722949028015 
Train [2/6] | Epoch [57/120] |	nca: 5.690056078135967, flat: 12.916714951395988, pod: 50.838953256607056, loss: 69.44572412967682 
Train [2/6] | Epoch [58/120] |	nca: 6.58809819072485, flat: 13.239595249295235, pod: 51.60910826921463, loss: 71.43680167198181 
Train [2/6] | Epoch [59/120] |	nca: 5.760707225650549, flat: 13.288266584277153, pod: 52.27946650981903, loss: 71.32844054698944 
Train [2/6] | Epoch [60/120] |	nca: 6.400369502604008, flat: 12.9956573843956, pod: 50.87864750623703, loss: 70.27467441558838 
Train [2/6] | Epoch [61/120] |	nca: 5.383445650339127, flat: 13.034352168440819, pod: 50.366924941539764, loss: 68.7847226858139 
Train [2/6] | Epoch [62/120] |	nca: 5.723222814500332, flat: 12.817912504076958, pod: 50.609693229198456, loss: 69.15082848072052 
Train [2/6] | Epoch [63/120] |	nca: 5.8639639392495155, flat: 12.585622176527977, pod: 49.152961909770966, loss: 67.60254800319672 
Train [2/6] | Epoch [64/120] |	nca: 5.404117491096258, flat: 12.492736667394638, pod: 49.20049774646759, loss: 67.09735178947449 
Train [2/6] | Epoch [65/120] |	nca: 5.274888649582863, flat: 12.90703934431076, pod: 51.103455662727356, loss: 69.28538370132446 
Train [2/6] | Epoch [66/120] |	nca: 5.938143916428089, flat: 12.477482974529266, pod: 48.998755395412445, loss: 67.41438221931458 
Train [2/6] | Epoch [67/120] |	nca: 5.676765896379948, flat: 12.563343852758408, pod: 49.54076284170151, loss: 67.7808723449707 
Train [2/6] | Epoch [68/120] |	nca: 5.243902917951345, flat: 12.320699959993362, pod: 47.19083744287491, loss: 64.75544047355652 
Train [2/6] | Epoch [69/120] |	nca: 6.130782671272755, flat: 13.019736260175705, pod: 50.6975377202034, loss: 69.84805750846863 
Train [2/6] | Epoch [70/120] |	nca: 4.912828043103218, flat: 12.408938556909561, pod: 47.81801277399063, loss: 65.13977921009064 
Train [2/6] | Epoch [71/120] |	nca: 5.011558577418327, flat: 12.09889306128025, pod: 45.85102862119675, loss: 62.961480140686035 
Train [2/6] | Epoch [72/120] |	nca: 4.785036139190197, flat: 12.102057054638863, pod: 45.64317321777344, loss: 62.530266523361206 
Train [2/6] | Epoch [73/120] |	nca: 5.803749527782202, flat: 12.248149514198303, pod: 46.818039298057556, loss: 64.86993825435638 
Train [2/6] | Epoch [74/120] |	nca: 4.68107270821929, flat: 11.963837414979935, pod: 46.4420303106308, loss: 63.08694112300873 
Train [2/6] | Epoch [75/120] |	nca: 5.014989014714956, flat: 12.111305743455887, pod: 45.34101223945618, loss: 62.46730673313141 
Train [2/6] | Epoch [76/120] |	nca: 5.18507618829608, flat: 12.17389614880085, pod: 46.67739588022232, loss: 64.03636801242828 
Train [2/6] | Epoch [77/120] |	nca: 4.861336346715689, flat: 11.671693995594978, pod: 43.101323544979095, loss: 59.63435423374176 
Train [2/6] | Epoch [78/120] |	nca: 4.620272573083639, flat: 11.753870189189911, pod: 43.337840139865875, loss: 59.71198236942291 
Train [2/6] | Epoch [79/120] |	nca: 4.043708268553019, flat: 11.798861160874367, pod: 43.29763424396515, loss: 59.14020359516144 
Train [2/6] | Epoch [80/120] |	nca: 4.520778100937605, flat: 11.5586496591568, pod: 42.26489979028702, loss: 58.344327449798584 
Train [2/6] | Epoch [81/120] |	nca: 4.560935106128454, flat: 11.71517762541771, pod: 42.482469975948334, loss: 58.75858247280121 
Train [2/6] | Epoch [82/120] |	nca: 4.621900025755167, flat: 11.859666153788567, pod: 41.88552367687225, loss: 58.367090344429016 
Train [2/6] | Epoch [83/120] |	nca: 4.75419158488512, flat: 11.639696687459946, pod: 41.14402973651886, loss: 57.537917494773865 
Train [2/6] | Epoch [84/120] |	nca: 4.169960483908653, flat: 11.467166110873222, pod: 39.67897456884384, loss: 55.31610143184662 
Train [2/6] | Epoch [85/120] |	nca: 4.047209572046995, flat: 11.441442608833313, pod: 40.29772436618805, loss: 55.78637671470642 
Train [2/6] | Epoch [86/120] |	nca: 4.193597614765167, flat: 11.15027491748333, pod: 38.788613080978394, loss: 54.13248574733734 
Train [2/6] | Epoch [87/120] |	nca: 4.002392064779997, flat: 11.23752336204052, pod: 39.10608673095703, loss: 54.34600239992142 
Train [2/6] | Epoch [88/120] |	nca: 4.095737714320421, flat: 11.155873149633408, pod: 39.09152102470398, loss: 54.34313201904297 
Train [2/6] | Epoch [89/120] |	nca: 4.137002069503069, flat: 11.390819698572159, pod: 39.21568542718887, loss: 54.74350702762604 
Train [2/6] | Epoch [90/120] |	nca: 4.006270296871662, flat: 11.035218998789787, pod: 37.85098421573639, loss: 52.89247274398804 
Train [2/6] | Epoch [91/120] |	nca: 4.282800894230604, flat: 10.98784476518631, pod: 36.71274173259735, loss: 51.983387768268585 
Train [2/6] | Epoch [92/120] |	nca: 3.95871901512146, flat: 11.017709404230118, pod: 37.09871679544449, loss: 52.07514572143555 
Train [2/6] | Epoch [93/120] |	nca: 3.8823540695011616, flat: 11.164943650364876, pod: 37.642033755779266, loss: 52.689331233501434 
Train [2/6] | Epoch [94/120] |	nca: 3.7570381946861744, flat: 10.814224407076836, pod: 35.756505250930786, loss: 50.32776790857315 
Train [2/6] | Epoch [95/120] |	nca: 3.92592728510499, flat: 10.91988579928875, pod: 35.291177332401276, loss: 50.136990785598755 
Train [2/6] | Epoch [96/120] |	nca: 3.7193122021853924, flat: 10.722846120595932, pod: 35.58150327205658, loss: 50.02366226911545 
Train [2/6] | Epoch [97/120] |	nca: 3.427467495203018, flat: 10.838156998157501, pod: 35.1523312330246, loss: 49.41795599460602 
Train [2/6] | Epoch [98/120] |	nca: 3.742862742394209, flat: 10.719786658883095, pod: 34.72098833322525, loss: 49.18363755941391 
Train [2/6] | Epoch [99/120] |	nca: 3.5355957187712193, flat: 10.82710137963295, pod: 34.79402631521225, loss: 49.15672355890274 
Train [2/6] | Epoch [100/120] |	nca: 3.561589900404215, flat: 10.538492262363434, pod: 33.823778569698334, loss: 47.92386037111282 
Train [2/6] | Epoch [101/120] |	nca: 3.660038448870182, flat: 10.648206248879433, pod: 34.06443977355957, loss: 48.37268388271332 
Train [2/6] | Epoch [102/120] |	nca: 3.5996902994811535, flat: 10.74321086704731, pod: 33.833742797374725, loss: 48.176644027233124 
Train [2/6] | Epoch [103/120] |	nca: 3.4753624126315117, flat: 10.604853942990303, pod: 34.157458782196045, loss: 48.237674713134766 
Train [2/6] | Epoch [104/120] |	nca: 3.3022288605570793, flat: 10.534881815314293, pod: 32.749985337257385, loss: 46.58709555864334 
Train [2/6] | Epoch [105/120] |	nca: 3.5334628000855446, flat: 10.31975094974041, pod: 32.78112608194351, loss: 46.63434016704559 
Train [2/6] | Epoch [106/120] |	nca: 3.6088061034679413, flat: 10.493689611554146, pod: 32.95131653547287, loss: 47.05381232500076 
Train [2/6] | Epoch [107/120] |	nca: 3.187635000795126, flat: 10.572405934333801, pod: 32.24661070108414, loss: 46.00665158033371 
Train [2/6] | Epoch [108/120] |	nca: 3.3548448383808136, flat: 10.471713736653328, pod: 32.36519682407379, loss: 46.19175571203232 
Train [2/6] | Epoch [109/120] |	nca: 3.1943060234189034, flat: 10.381821930408478, pod: 32.08146768808365, loss: 45.657595455646515 
Train [2/6] | Epoch [110/120] |	nca: 3.182197816669941, flat: 10.287999466061592, pod: 31.766738712787628, loss: 45.23693609237671 
Train [2/6] | Epoch [111/120] |	nca: 3.1860483959317207, flat: 10.303634732961655, pod: 31.700611650943756, loss: 45.19029486179352 
Train [2/6] | Epoch [112/120] |	nca: 3.015036141499877, flat: 10.378505945205688, pod: 30.90668946504593, loss: 44.30023139715195 
Train [2/6] | Epoch [113/120] |	nca: 3.164041370153427, flat: 10.165888354182243, pod: 31.1409033536911, loss: 44.47083306312561 
Train [2/6] | Epoch [114/120] |	nca: 3.131989222019911, flat: 10.202104389667511, pod: 30.96131205558777, loss: 44.295405626297 
Train [2/6] | Epoch [115/120] |	nca: 3.277825277298689, flat: 10.40127745270729, pod: 31.4733447432518, loss: 45.152447521686554 
Train [2/6] | Epoch [116/120] |	nca: 3.032496940344572, flat: 10.218719616532326, pod: 31.503045439720154, loss: 44.75426238775253 
Train [2/6] | Epoch [117/120] |	nca: 3.204907104372978, flat: 10.368658319115639, pod: 30.760676860809326, loss: 44.33424198627472 
Train [2/6] | Epoch [118/120] |	nca: 3.1069431267678738, flat: 10.16490387916565, pod: 30.589227974414825, loss: 43.861074924468994 
Train [2/6] | Epoch [119/120] |	nca: 3.2365231588482857, flat: 10.257728174328804, pod: 30.950547695159912, loss: 44.44479912519455 
Train [2/6] | Epoch [120/120] |	nca: 3.229841072112322, flat: 10.152921363711357, pod: 30.47834688425064, loss: 43.86110931634903 
Fine-tuning
Building & updating memory.
Train [2/6] | Epoch [121/140] |	nca: 3.488358110189438, flat: 4.696588754653931, pod: 14.674431920051575, loss: 22.859378576278687 
Train [2/6] | Epoch [122/140] |	nca: 1.9856044948101044, flat: 4.647395521402359, pod: 14.648653507232666, loss: 21.28165340423584 
Train [2/6] | Epoch [123/140] |	nca: 1.5468051731586456, flat: 4.724279165267944, pod: 14.86642050743103, loss: 21.137504816055298 
Train [2/6] | Epoch [124/140] |	nca: 1.4118364453315735, flat: 4.827010631561279, pod: 14.940624117851257, loss: 21.179471254348755 
Train [2/6] | Epoch [125/140] |	nca: 1.522234559059143, flat: 4.676926642656326, pod: 14.743377089500427, loss: 20.942538499832153 
Train [2/6] | Epoch [126/140] |	nca: 1.1097786128520966, flat: 4.688268929719925, pod: 14.588509321212769, loss: 20.3865567445755 
Train [2/6] | Epoch [127/140] |	nca: 1.1971606761217117, flat: 4.657831996679306, pod: 14.866835117340088, loss: 20.72182786464691 
Train [2/6] | Epoch [128/140] |	nca: 1.015659660100937, flat: 4.712917625904083, pod: 14.688961625099182, loss: 20.41753888130188 
Train [2/6] | Epoch [129/140] |	nca: 1.0583194196224213, flat: 4.760295361280441, pod: 14.898017048835754, loss: 20.716631650924683 
Train [2/6] | Epoch [130/140] |	nca: 1.0770787596702576, flat: 4.776904135942459, pod: 14.875557661056519, loss: 20.729540705680847 
Train [2/6] | Epoch [131/140] |	nca: 1.1207223571836948, flat: 4.756918787956238, pod: 14.948146224021912, loss: 20.82578694820404 
Train [2/6] | Epoch [132/140] |	nca: 0.9535336829721928, flat: 4.663668274879456, pod: 14.618406534194946, loss: 20.235608458518982 
Train [2/6] | Epoch [133/140] |	nca: 1.053149227052927, flat: 4.64974844455719, pod: 14.710896968841553, loss: 20.41379451751709 
Train [2/6] | Epoch [134/140] |	nca: 0.9885164201259613, flat: 4.692927420139313, pod: 14.760255098342896, loss: 20.441698908805847 
Train [2/6] | Epoch [135/140] |	nca: 0.9447014406323433, flat: 4.766922652721405, pod: 14.806040644645691, loss: 20.517664551734924 
Train [2/6] | Epoch [136/140] |	nca: 0.9298300817608833, flat: 4.599773019552231, pod: 14.527105212211609, loss: 20.056708335876465 
Train [2/6] | Epoch [137/140] |	nca: 1.2358558997511864, flat: 4.654661297798157, pod: 14.730548024177551, loss: 20.621065139770508 
Train [2/6] | Epoch [138/140] |	nca: 1.2569578029215336, flat: 4.854844123125076, pod: 15.105133533477783, loss: 21.216935396194458 
Train [2/6] | Epoch [139/140] |	nca: 0.9771645441651344, flat: 4.8178596794605255, pod: 15.045615434646606, loss: 20.84063994884491 
Train [2/6] | Epoch [140/140] |	nca: 0.9929477497935295, flat: 4.879577785730362, pod: 15.167214751243591, loss: 21.039740085601807 
after task
Building & updating memory.
after task
Eval on 0->6.
eval task
podnet_cnn_cifar10_5steps
Avg inc acc: 0.9199999999999999.
Current acc: {'total': 0.868, '00-09': 0.868}.
Avg inc acc top5: 1.0.
Current acc top5: {'total': 1.0}.
Forgetting: 0.05199999999999999.
Cord metric: 0.91.
Old accuracy: 0.88, mean: 0.88.
New accuracy: 0.82, mean: 0.82.
================Task 2 Start!================
Testing on False unseen tasks (max class = 7).
Set memory of size: 1200.
Before task
Generating imprinted weights
Multi class diff kmeans.
Now 200 examplars per class.
Group: convnet, lr: 0.1.
Group: postprocessing, lr: 0.1.
Group: new_weights, lr: 0.1.
================Task 2 Training!================
The training samples number: 6200
Train on 6->7.
train task
nb 6200.
Train [3/6] | Epoch [1/120] |	nca: 18.969757229089737, flat: 20.4732186794281, pod: 97.54072678089142, loss: 136.98370254039764 
Train [3/6] | Epoch [2/120] |	nca: 9.911916457116604, flat: 9.71414789557457, pod: 65.35934019088745, loss: 84.98540484905243 
Train [3/6] | Epoch [3/120] |	nca: 7.905829668045044, flat: 8.16408023238182, pod: 59.14884269237518, loss: 75.21875274181366 
Train [3/6] | Epoch [4/120] |	nca: 7.429944381117821, flat: 7.690850481390953, pod: 58.000476717948914, loss: 73.12127125263214 
Train [3/6] | Epoch [5/120] |	nca: 8.292223960161209, flat: 7.709859475493431, pod: 58.8085480928421, loss: 74.81063139438629 
Train [3/6] | Epoch [6/120] |	nca: 7.2764270305633545, flat: 7.22435737401247, pod: 55.1527578830719, loss: 69.65354180335999 
Train [3/6] | Epoch [7/120] |	nca: 6.840803347527981, flat: 7.260318793356419, pod: 55.8926705121994, loss: 69.99379289150238 
Train [3/6] | Epoch [8/120] |	nca: 6.670963928103447, flat: 7.056805707514286, pod: 55.044085085392, loss: 68.77185463905334 
Train [3/6] | Epoch [9/120] |	nca: 6.08361229300499, flat: 6.707732357084751, pod: 52.5795823931694, loss: 65.37092685699463 
Train [3/6] | Epoch [10/120] |	nca: 6.1722342222929, flat: 6.4913499802351, pod: 51.50543361902237, loss: 64.16901767253876 
Train [3/6] | Epoch [11/120] |	nca: 6.2902891635894775, flat: 6.685321554541588, pod: 53.85173141956329, loss: 66.82734227180481 
Train [3/6] | Epoch [12/120] |	nca: 5.260775715112686, flat: 6.042897202074528, pod: 50.34594929218292, loss: 61.64962148666382 
Train [3/6] | Epoch [13/120] |	nca: 5.731934688985348, flat: 6.480056196451187, pod: 52.77596598863602, loss: 64.98795688152313 
Train [3/6] | Epoch [14/120] |	nca: 6.24298682436347, flat: 6.641404375433922, pod: 53.44764494895935, loss: 66.33203649520874 
Train [3/6] | Epoch [15/120] |	nca: 5.4630008190870285, flat: 6.569832772016525, pod: 53.41191512346268, loss: 65.44474875926971 
Train [3/6] | Epoch [16/120] |	nca: 5.4993906468153, flat: 6.347603306174278, pod: 52.575728714466095, loss: 64.422722697258 
Train [3/6] | Epoch [17/120] |	nca: 5.6378877609968185, flat: 6.069552652537823, pod: 50.50235593318939, loss: 62.20979630947113 
Train [3/6] | Epoch [18/120] |	nca: 5.459868382662535, flat: 5.980479680001736, pod: 49.645969450473785, loss: 61.08631718158722 
Train [3/6] | Epoch [19/120] |	nca: 5.744370091706514, flat: 6.572107248008251, pod: 52.82965499162674, loss: 65.1461318731308 
Train [3/6] | Epoch [20/120] |	nca: 5.766399841755629, flat: 6.036128878593445, pod: 50.0227444767952, loss: 61.82527315616608 
Train [3/6] | Epoch [21/120] |	nca: 4.996971391141415, flat: 6.25551138818264, pod: 51.13675779104233, loss: 62.38924062252045 
Train [3/6] | Epoch [22/120] |	nca: 4.7002445459365845, flat: 5.9368671625852585, pod: 48.94777834415436, loss: 59.584890365600586 
Train [3/6] | Epoch [23/120] |	nca: 4.957973055541515, flat: 5.974617376923561, pod: 49.258953869342804, loss: 60.19154405593872 
Train [3/6] | Epoch [24/120] |	nca: 4.904096636921167, flat: 5.8330459371209145, pod: 49.20060878992081, loss: 59.93775129318237 
Train [3/6] | Epoch [25/120] |	nca: 5.17585738748312, flat: 5.888162307441235, pod: 48.01422816514969, loss: 59.07824742794037 
Train [3/6] | Epoch [26/120] |	nca: 5.038230881094933, flat: 6.3396730571985245, pod: 51.89875787496567, loss: 63.27666139602661 
Train [3/6] | Epoch [27/120] |	nca: 4.773681055754423, flat: 5.989831246435642, pod: 49.587015986442566, loss: 60.35052800178528 
Train [3/6] | Epoch [28/120] |	nca: 4.658333715051413, flat: 5.871256597340107, pod: 49.16022849082947, loss: 59.68981897830963 
Train [3/6] | Epoch [29/120] |	nca: 5.026499256491661, flat: 5.91257418692112, pod: 49.72872370481491, loss: 60.667797327041626 
Train [3/6] | Epoch [30/120] |	nca: 5.417535912245512, flat: 6.066180899739265, pod: 49.85606050491333, loss: 61.33977711200714 
Train [3/6] | Epoch [31/120] |	nca: 4.293650824576616, flat: 5.7438593581318855, pod: 48.017171144485474, loss: 58.054680943489075 
Train [3/6] | Epoch [32/120] |	nca: 4.761194080114365, flat: 5.853803090751171, pod: 49.126776456832886, loss: 59.74177348613739 
Train [3/6] | Epoch [33/120] |	nca: 5.202500816434622, flat: 5.95422749966383, pod: 49.40812599658966, loss: 60.56485462188721 
Train [3/6] | Epoch [34/120] |	nca: 4.538383569568396, flat: 5.567084759473801, pod: 46.90722644329071, loss: 57.01269483566284 
Train [3/6] | Epoch [35/120] |	nca: 4.842496454715729, flat: 6.093655996024609, pod: 50.37499439716339, loss: 61.31114649772644 
Train [3/6] | Epoch [36/120] |	nca: 4.4626644514501095, flat: 5.899120047688484, pod: 48.26617282629013, loss: 58.627957344055176 
Train [3/6] | Epoch [37/120] |	nca: 4.232413589954376, flat: 5.650439061224461, pod: 47.018194913864136, loss: 56.901047348976135 
Train [3/6] | Epoch [38/120] |	nca: 4.345113728195429, flat: 5.675209186971188, pod: 47.973911821842194, loss: 57.994234800338745 
Train [3/6] | Epoch [39/120] |	nca: 4.6512470953166485, flat: 5.618260718882084, pod: 46.68793714046478, loss: 56.95744502544403 
Train [3/6] | Epoch [40/120] |	nca: 5.122486162930727, flat: 6.222916848957539, pod: 50.184614062309265, loss: 61.530017614364624 
Train [3/6] | Epoch [41/120] |	nca: 4.118941204622388, flat: 5.662454798817635, pod: 47.87897610664368, loss: 57.660372257232666 
Train [3/6] | Epoch [42/120] |	nca: 4.15858718380332, flat: 5.406196720898151, pod: 46.6508064866066, loss: 56.215590715408325 
Train [3/6] | Epoch [43/120] |	nca: 3.940037112683058, flat: 5.665198475122452, pod: 46.106661677360535, loss: 55.711896896362305 
Train [3/6] | Epoch [44/120] |	nca: 4.357112273573875, flat: 5.400031223893166, pod: 45.60235399007797, loss: 55.35949742794037 
Train [3/6] | Epoch [45/120] |	nca: 4.0044576320797205, flat: 5.643861413002014, pod: 46.42316871881485, loss: 56.07148766517639 
Train [3/6] | Epoch [46/120] |	nca: 4.193335231393576, flat: 5.494022518396378, pod: 46.85421812534332, loss: 56.54157626628876 
Train [3/6] | Epoch [47/120] |	nca: 3.8773426860570908, flat: 5.520108744502068, pod: 45.31816130876541, loss: 54.71561276912689 
Train [3/6] | Epoch [48/120] |	nca: 4.120220128446817, flat: 5.265965536236763, pod: 45.799447774887085, loss: 55.1856335401535 
Train [3/6] | Epoch [49/120] |	nca: 4.108541417866945, flat: 5.460745923221111, pod: 45.52590811252594, loss: 55.09519553184509 
Train [3/6] | Epoch [50/120] |	nca: 3.909040030092001, flat: 5.313261307775974, pod: 44.94253146648407, loss: 54.16483277082443 
Train [3/6] | Epoch [51/120] |	nca: 3.958459945395589, flat: 5.390788361430168, pod: 43.67547959089279, loss: 53.02472800016403 
Train [3/6] | Epoch [52/120] |	nca: 3.7477211970835924, flat: 5.32803550362587, pod: 44.652619421482086, loss: 53.72837609052658 
Train [3/6] | Epoch [53/120] |	nca: 3.606460204347968, flat: 5.356392942368984, pod: 43.88622182607651, loss: 52.84907525777817 
Train [3/6] | Epoch [54/120] |	nca: 3.827121578156948, flat: 5.073826938867569, pod: 42.162437438964844, loss: 51.06338566541672 
Train [3/6] | Epoch [55/120] |	nca: 4.009313017129898, flat: 5.124900348484516, pod: 42.129873156547546, loss: 51.26408660411835 
Train [3/6] | Epoch [56/120] |	nca: 3.8513236436992884, flat: 5.21295391023159, pod: 42.70930391550064, loss: 51.773581743240356 
Train [3/6] | Epoch [57/120] |	nca: 3.157386764883995, flat: 4.95461880415678, pod: 41.288368701934814, loss: 49.40037429332733 
Train [3/6] | Epoch [58/120] |	nca: 3.847317785024643, flat: 5.051391951739788, pod: 42.052917420864105, loss: 50.95162731409073 
Train [3/6] | Epoch [59/120] |	nca: 4.500737551599741, flat: 5.809415943920612, pod: 45.48909866809845, loss: 55.79925227165222 
Train [3/6] | Epoch [60/120] |	nca: 4.053039276972413, flat: 5.123416639864445, pod: 42.25532066822052, loss: 51.431777000427246 
Train [3/6] | Epoch [61/120] |	nca: 3.5626465529203415, flat: 4.813054114580154, pod: 39.74600267410278, loss: 48.121703147888184 
Train [3/6] | Epoch [62/120] |	nca: 3.5050622075796127, flat: 4.921250835061073, pod: 40.656824588775635, loss: 49.08313763141632 
Train [3/6] | Epoch [63/120] |	nca: 3.314410176128149, flat: 4.8906386867165565, pod: 40.582875311374664, loss: 48.78792440891266 
Train [3/6] | Epoch [64/120] |	nca: 3.2965632304549217, flat: 4.869084797799587, pod: 40.123613595962524, loss: 48.289261758327484 
Train [3/6] | Epoch [65/120] |	nca: 3.1461713947355747, flat: 4.788685530424118, pod: 39.48403072357178, loss: 47.41888779401779 
Train [3/6] | Epoch [66/120] |	nca: 3.4231610354036093, flat: 4.698051668703556, pod: 38.20246243476868, loss: 46.32367521524429 
Train [3/6] | Epoch [67/120] |	nca: 3.257009632885456, flat: 4.687037609517574, pod: 38.804082453250885, loss: 46.74813002347946 
Train [3/6] | Epoch [68/120] |	nca: 3.4850657396018505, flat: 4.610145680606365, pod: 38.73181104660034, loss: 46.8270223736763 
Train [3/6] | Epoch [69/120] |	nca: 3.4289575666189194, flat: 4.715127877891064, pod: 38.24132478237152, loss: 46.385410249233246 
Train [3/6] | Epoch [70/120] |	nca: 2.8235534075647593, flat: 4.542829915881157, pod: 37.83533954620361, loss: 45.201722860336304 
Train [3/6] | Epoch [71/120] |	nca: 3.254743982106447, flat: 4.713164404034615, pod: 38.73472499847412, loss: 46.70263344049454 
Train [3/6] | Epoch [72/120] |	nca: 3.1451154947280884, flat: 4.569006554782391, pod: 36.93577814102173, loss: 44.649899780750275 
Train [3/6] | Epoch [73/120] |	nca: 3.0101758502423763, flat: 4.462588794529438, pod: 37.661046266555786, loss: 45.13381063938141 
Train [3/6] | Epoch [74/120] |	nca: 2.957167360931635, flat: 4.4963934645056725, pod: 37.36890560388565, loss: 44.82246655225754 
Train [3/6] | Epoch [75/120] |	nca: 3.0076726023107767, flat: 4.338608682155609, pod: 35.856069564819336, loss: 43.2023509144783 
Train [3/6] | Epoch [76/120] |	nca: 2.668019615113735, flat: 4.310011304914951, pod: 35.68035155534744, loss: 42.65838247537613 
Train [3/6] | Epoch [77/120] |	nca: 2.6970649119466543, flat: 4.372432880103588, pod: 36.08120745420456, loss: 43.15070515871048 
Train [3/6] | Epoch [78/120] |	nca: 2.675186911597848, flat: 4.164167322218418, pod: 35.373036205768585, loss: 42.212390422821045 
Train [3/6] | Epoch [79/120] |	nca: 2.699302561581135, flat: 4.110950812697411, pod: 34.15850067138672, loss: 40.96875411272049 
Train [3/6] | Epoch [80/120] |	nca: 2.6125009693205357, flat: 4.002489801496267, pod: 33.23963534832001, loss: 39.854626178741455 
Train [3/6] | Epoch [81/120] |	nca: 2.304242728278041, flat: 3.919740669429302, pod: 32.57419377565384, loss: 38.79817718267441 
Train [3/6] | Epoch [82/120] |	nca: 2.4898072723299265, flat: 3.917913541197777, pod: 33.3357800245285, loss: 39.74350094795227 
Train [3/6] | Epoch [83/120] |	nca: 2.7389697451144457, flat: 4.242703445255756, pod: 34.26093626022339, loss: 41.242609322071075 
Train [3/6] | Epoch [84/120] |	nca: 2.5452933739870787, flat: 4.001294493675232, pod: 32.976631700992584, loss: 39.52321946620941 
Train [3/6] | Epoch [85/120] |	nca: 2.444799417629838, flat: 3.941755760461092, pod: 31.509658873081207, loss: 37.89621418714523 
Train [3/6] | Epoch [86/120] |	nca: 2.425688808783889, flat: 3.9494646601378918, pod: 31.70719587802887, loss: 38.08234941959381 
Train [3/6] | Epoch [87/120] |	nca: 2.457675900310278, flat: 3.855085324496031, pod: 32.035391092300415, loss: 38.34815227985382 
Train [3/6] | Epoch [88/120] |	nca: 2.410559928044677, flat: 3.9377060681581497, pod: 31.42151516675949, loss: 37.769780933856964 
Train [3/6] | Epoch [89/120] |	nca: 2.22454546764493, flat: 3.6816696040332317, pod: 29.229587256908417, loss: 35.13580232858658 
Train [3/6] | Epoch [90/120] |	nca: 2.56871304102242, flat: 3.8248248025774956, pod: 30.829908430576324, loss: 37.22344619035721 
Train [3/6] | Epoch [91/120] |	nca: 2.4563001058995724, flat: 3.8306324779987335, pod: 29.971819698810577, loss: 36.25875240564346 
Train [3/6] | Epoch [92/120] |	nca: 2.3538864739239216, flat: 3.8047569766640663, pod: 29.433507919311523, loss: 35.592151403427124 
Train [3/6] | Epoch [93/120] |	nca: 2.2066067531704903, flat: 3.634721428155899, pod: 29.43287894129753, loss: 35.274207055568695 
Train [3/6] | Epoch [94/120] |	nca: 2.310476504266262, flat: 3.814748127013445, pod: 30.085518717765808, loss: 36.21074324846268 
Train [3/6] | Epoch [95/120] |	nca: 2.1610857006162405, flat: 3.6359281167387962, pod: 28.398589253425598, loss: 34.19560307264328 
Train [3/6] | Epoch [96/120] |	nca: 2.241699570789933, flat: 3.6381227150559425, pod: 27.638002574443817, loss: 33.517824828624725 
Train [3/6] | Epoch [97/120] |	nca: 2.2737619802355766, flat: 3.5900777988135815, pod: 28.565161615610123, loss: 34.4290012717247 
Train [3/6] | Epoch [98/120] |	nca: 2.271051838994026, flat: 3.5526586063206196, pod: 27.29916152358055, loss: 33.12287187576294 
Train [3/6] | Epoch [99/120] |	nca: 2.17783011123538, flat: 3.587785966694355, pod: 27.0166517496109, loss: 32.782267928123474 
Train [3/6] | Epoch [100/120] |	nca: 2.064049495384097, flat: 3.5772336050868034, pod: 27.126997113227844, loss: 32.76828008890152 
Train [3/6] | Epoch [101/120] |	nca: 2.0611417423933744, flat: 3.410327311605215, pod: 26.32165426015854, loss: 31.793123245239258 
Train [3/6] | Epoch [102/120] |	nca: 1.877212729305029, flat: 3.490748729556799, pod: 26.86831769347191, loss: 32.236279249191284 
Train [3/6] | Epoch [103/120] |	nca: 2.0874448344111443, flat: 3.352682914584875, pod: 25.5515319108963, loss: 30.991659939289093 
Train [3/6] | Epoch [104/120] |	nca: 1.9907096643000841, flat: 3.3344768844544888, pod: 24.82457146048546, loss: 30.149757742881775 
Train [3/6] | Epoch [105/120] |	nca: 1.92479906976223, flat: 3.396538931876421, pod: 25.606068074703217, loss: 30.927406072616577 
Train [3/6] | Epoch [106/120] |	nca: 2.0464927442371845, flat: 3.3579583540558815, pod: 25.777785152196884, loss: 31.182236075401306 
Train [3/6] | Epoch [107/120] |	nca: 1.8758889138698578, flat: 3.379075039178133, pod: 24.814083456993103, loss: 30.069047421216965 
Train [3/6] | Epoch [108/120] |	nca: 2.101135917007923, flat: 3.2695425674319267, pod: 24.75262761116028, loss: 30.123305916786194 
Train [3/6] | Epoch [109/120] |	nca: 1.999270923435688, flat: 3.399891968816519, pod: 25.096433699131012, loss: 30.495596557855606 
Train [3/6] | Epoch [110/120] |	nca: 1.9753162991255522, flat: 3.235093582421541, pod: 23.913430511951447, loss: 29.12384021282196 
Train [3/6] | Epoch [111/120] |	nca: 1.9813346769660711, flat: 3.2576078809797764, pod: 24.085831582546234, loss: 29.32477405667305 
Train [3/6] | Epoch [112/120] |	nca: 1.9468762334436178, flat: 3.232492245733738, pod: 23.655548572540283, loss: 28.834917217493057 
Train [3/6] | Epoch [113/120] |	nca: 1.8987796921283007, flat: 3.211878292262554, pod: 23.42149755358696, loss: 28.532155573368073 
Train [3/6] | Epoch [114/120] |	nca: 1.8239627089351416, flat: 3.307195607572794, pod: 23.91839724779129, loss: 29.04955565929413 
Train [3/6] | Epoch [115/120] |	nca: 2.082660675048828, flat: 3.1671611331403255, pod: 22.81310275197029, loss: 28.06292423605919 
Train [3/6] | Epoch [116/120] |	nca: 1.8606516979634762, flat: 3.2376931086182594, pod: 23.718237549066544, loss: 28.816582441329956 
Train [3/6] | Epoch [117/120] |	nca: 1.8786951191723347, flat: 3.208856273442507, pod: 23.481189042329788, loss: 28.56874018907547 
Train [3/6] | Epoch [118/120] |	nca: 1.9382644202560186, flat: 3.205128576606512, pod: 22.913470923900604, loss: 28.05686381459236 
Train [3/6] | Epoch [119/120] |	nca: 2.057452853769064, flat: 3.1276725605130196, pod: 22.661324083805084, loss: 27.846449345350266 
Train [3/6] | Epoch [120/120] |	nca: 1.9662063401192427, flat: 3.251347955316305, pod: 23.54007115960121, loss: 28.757625341415405 
Fine-tuning
Building & updating memory.
Train [3/6] | Epoch [121/140] |	nca: 4.851612210273743, flat: 2.6690627187490463, pod: 20.06817102432251, loss: 27.58884620666504 
Train [3/6] | Epoch [122/140] |	nca: 2.280484914779663, flat: 2.7199674397706985, pod: 20.210632920265198, loss: 25.211085081100464 
Train [3/6] | Epoch [123/140] |	nca: 1.6831553056836128, flat: 2.6834086775779724, pod: 20.12253165245056, loss: 24.48909568786621 
Train [3/6] | Epoch [124/140] |	nca: 1.4575604945421219, flat: 2.664420798420906, pod: 20.07215666770935, loss: 24.194138050079346 
Train [3/6] | Epoch [125/140] |	nca: 1.3054398596286774, flat: 2.665397271513939, pod: 20.018948316574097, loss: 23.989785194396973 
Train [3/6] | Epoch [126/140] |	nca: 1.3170655965805054, flat: 2.6994565427303314, pod: 20.19097924232483, loss: 24.207501649856567 
Train [3/6] | Epoch [127/140] |	nca: 1.158030316233635, flat: 2.68539522588253, pod: 20.236477732658386, loss: 24.07990324497223 
Train [3/6] | Epoch [128/140] |	nca: 1.2713921293616295, flat: 2.7078006267547607, pod: 20.307563424110413, loss: 24.28675603866577 
Train [3/6] | Epoch [129/140] |	nca: 1.2273187711834908, flat: 2.6938918232917786, pod: 20.09676194190979, loss: 24.017972230911255 
Train [3/6] | Epoch [130/140] |	nca: 1.1598351001739502, flat: 2.655936896800995, pod: 20.02359628677368, loss: 23.83936834335327 
Train [3/6] | Epoch [131/140] |	nca: 1.1264740228652954, flat: 2.651158183813095, pod: 20.109074473381042, loss: 23.886706590652466 
Train [3/6] | Epoch [132/140] |	nca: 1.0384911224246025, flat: 2.663340747356415, pod: 20.01132619380951, loss: 23.713158011436462 
Train [3/6] | Epoch [133/140] |	nca: 1.0970294140279293, flat: 2.668999508023262, pod: 20.127715468406677, loss: 23.893744349479675 
Train [3/6] | Epoch [134/140] |	nca: 1.1380017697811127, flat: 2.7292700856924057, pod: 20.356465697288513, loss: 24.223737597465515 
Train [3/6] | Epoch [135/140] |	nca: 1.0850702300667763, flat: 2.683079779148102, pod: 20.26046645641327, loss: 24.028616666793823 
Train [3/6] | Epoch [136/140] |	nca: 1.1512063294649124, flat: 2.70713447034359, pod: 20.323799967765808, loss: 24.182140827178955 
Train [3/6] | Epoch [137/140] |	nca: 1.133097991347313, flat: 2.667254149913788, pod: 20.088130950927734, loss: 23.88848328590393 
Train [3/6] | Epoch [138/140] |	nca: 1.1769648157060146, flat: 2.6821893006563187, pod: 20.08822202682495, loss: 23.947376132011414 
Train [3/6] | Epoch [139/140] |	nca: 1.0061648562550545, flat: 2.682916834950447, pod: 20.291112422943115, loss: 23.980194091796875 
Train [3/6] | Epoch [140/140] |	nca: 1.0913127809762955, flat: 2.6419700980186462, pod: 20.017203330993652, loss: 23.750486493110657 
after task
Building & updating memory.
after task
Eval on 0->7.
eval task
podnet_cnn_cifar10_5steps
Avg inc acc: 0.8959999999999999.
Current acc: {'total': 0.848, '00-09': 0.848}.
Avg inc acc top5: 0.9993333333333334.
Current acc top5: {'total': 0.998}.
Forgetting: 0.062.
Cord metric: 0.89.
Old accuracy: 0.84, mean: 0.86.
New accuracy: 0.92, mean: 0.87.
================Task 3 Start!================
Testing on False unseen tasks (max class = 8).
Set memory of size: 1400.
Before task
Generating imprinted weights
Multi class diff kmeans.
Now 200 examplars per class.
Group: convnet, lr: 0.1.
Group: postprocessing, lr: 0.1.
Group: new_weights, lr: 0.1.
================Task 3 Training!================
The training samples number: 6400
Train on 7->8.
train task
nb 6400.
Train [4/6] | Epoch [1/120] |	nca: 19.590244844555855, flat: 7.5629673153162, pod: 74.65683877468109, loss: 101.81005024909973 
Train [4/6] | Epoch [2/120] |	nca: 12.252045914530754, flat: 4.983706325292587, pod: 64.57914745807648, loss: 81.8149003982544 
Train [4/6] | Epoch [3/120] |	nca: 11.421749845147133, flat: 4.764339454472065, pod: 62.243340611457825, loss: 78.4294296503067 
Train [4/6] | Epoch [4/120] |	nca: 10.254686690866947, flat: 4.2209270894527435, pod: 57.8644380569458, loss: 72.34005177021027 
Train [4/6] | Epoch [5/120] |	nca: 9.044502712786198, flat: 3.944886814802885, pod: 57.83386445045471, loss: 70.82325398921967 
Train [4/6] | Epoch [6/120] |	nca: 9.155926495790482, flat: 4.091363191604614, pod: 57.59932482242584, loss: 70.84661495685577 
Train [4/6] | Epoch [7/120] |	nca: 8.284470975399017, flat: 3.9173283837735653, pod: 56.10502207279205, loss: 68.30682218074799 
Train [4/6] | Epoch [8/120] |	nca: 8.114310815930367, flat: 3.824692063033581, pod: 54.256330251693726, loss: 66.19533288478851 
Train [4/6] | Epoch [9/120] |	nca: 8.467491127550602, flat: 3.854030478745699, pod: 54.28261399269104, loss: 66.60413551330566 
Train [4/6] | Epoch [10/120] |	nca: 7.222164511680603, flat: 3.7829115986824036, pod: 54.30040282011032, loss: 65.3054792881012 
Train [4/6] | Epoch [11/120] |	nca: 6.975281946361065, flat: 3.4908539317548275, pod: 50.05753701925278, loss: 60.52367293834686 
Train [4/6] | Epoch [12/120] |	nca: 6.805325709283352, flat: 3.461564652621746, pod: 50.80769670009613, loss: 61.074586153030396 
Train [4/6] | Epoch [13/120] |	nca: 7.5409411787986755, flat: 3.8772286511957645, pod: 54.47477447986603, loss: 65.89294421672821 
Train [4/6] | Epoch [14/120] |	nca: 7.115288078784943, flat: 3.630953211337328, pod: 50.903761982917786, loss: 61.65000319480896 
Train [4/6] | Epoch [15/120] |	nca: 6.074936076998711, flat: 3.4916976131498814, pod: 51.05454409122467, loss: 60.62117779254913 
Train [4/6] | Epoch [16/120] |	nca: 7.713021822273731, flat: 3.7846741378307343, pod: 53.22917538881302, loss: 64.72687137126923 
Train [4/6] | Epoch [17/120] |	nca: 6.052608214318752, flat: 3.5124660097062588, pod: 50.65263068675995, loss: 60.21770477294922 
Train [4/6] | Epoch [18/120] |	nca: 6.10049170255661, flat: 3.4609756655991077, pod: 50.73741400241852, loss: 60.2988817691803 
Train [4/6] | Epoch [19/120] |	nca: 6.3909918665885925, flat: 3.577430684119463, pod: 51.29887717962265, loss: 61.26729941368103 
Train [4/6] | Epoch [20/120] |	nca: 5.844806432723999, flat: 3.486002393066883, pod: 49.74166864156723, loss: 59.07247757911682 
Train [4/6] | Epoch [21/120] |	nca: 6.693778060376644, flat: 3.6027206890285015, pod: 51.36572253704071, loss: 61.66222143173218 
Train [4/6] | Epoch [22/120] |	nca: 5.963086552917957, flat: 3.477664813399315, pod: 48.227343678474426, loss: 57.668094873428345 
Train [4/6] | Epoch [23/120] |	nca: 6.07672430947423, flat: 3.5819637402892113, pod: 51.26733756065369, loss: 60.92602562904358 
Train [4/6] | Epoch [24/120] |	nca: 6.185788903385401, flat: 3.7034278959035873, pod: 50.88146090507507, loss: 60.77067732810974 
Train [4/6] | Epoch [25/120] |	nca: 6.095796998590231, flat: 3.52243135869503, pod: 48.58490717411041, loss: 58.20313549041748 
Train [4/6] | Epoch [26/120] |	nca: 5.567434620112181, flat: 3.557258766144514, pod: 49.43625456094742, loss: 58.56094837188721 
Train [4/6] | Epoch [27/120] |	nca: 5.808863282203674, flat: 3.388667743653059, pod: 49.173116624355316, loss: 58.37064737081528 
Train [4/6] | Epoch [28/120] |	nca: 5.487933613359928, flat: 3.3734346739947796, pod: 48.3978306055069, loss: 57.259199023246765 
Train [4/6] | Epoch [29/120] |	nca: 5.513720318675041, flat: 3.3155152462422848, pod: 48.870249569416046, loss: 57.699485421180725 
Train [4/6] | Epoch [30/120] |	nca: 5.521094959229231, flat: 3.557983547449112, pod: 49.64980363845825, loss: 58.72888207435608 
Train [4/6] | Epoch [31/120] |	nca: 6.3139473013579845, flat: 3.5965322963893414, pod: 49.6324337720871, loss: 59.54291355609894 
Train [4/6] | Epoch [32/120] |	nca: 5.427203416824341, flat: 3.3409696854650974, pod: 47.412946462631226, loss: 56.18111950159073 
Train [4/6] | Epoch [33/120] |	nca: 5.5837783217430115, flat: 3.50617553293705, pod: 49.62297177314758, loss: 58.71292579174042 
Train [4/6] | Epoch [34/120] |	nca: 4.784057263284922, flat: 3.2894537933170795, pod: 47.5195170044899, loss: 55.593027889728546 
Train [4/6] | Epoch [35/120] |	nca: 5.442876145243645, flat: 3.3069264590740204, pod: 47.40940624475479, loss: 56.15920925140381 
Train [4/6] | Epoch [36/120] |	nca: 4.741137288510799, flat: 3.1534796245396137, pod: 46.77778458595276, loss: 54.67240160703659 
Train [4/6] | Epoch [37/120] |	nca: 4.905064109712839, flat: 3.265235211700201, pod: 45.74125349521637, loss: 53.91155296564102 
Train [4/6] | Epoch [38/120] |	nca: 5.128858260810375, flat: 3.2947265319526196, pod: 47.5438569188118, loss: 55.967441380023956 
Train [4/6] | Epoch [39/120] |	nca: 5.041626125574112, flat: 3.078213971108198, pod: 45.21423453092575, loss: 53.33407437801361 
Train [4/6] | Epoch [40/120] |	nca: 4.556790821254253, flat: 3.010696452111006, pod: 43.683414041996, loss: 51.250901222229004 
Train [4/6] | Epoch [41/120] |	nca: 4.36258714646101, flat: 3.3380513191223145, pod: 47.499462723731995, loss: 55.200101375579834 
Train [4/6] | Epoch [42/120] |	nca: 4.55671102553606, flat: 2.969829488545656, pod: 43.24481236934662, loss: 50.77135306596756 
Train [4/6] | Epoch [43/120] |	nca: 4.669800810515881, flat: 3.112733267247677, pod: 44.75016492605209, loss: 52.53269922733307 
Train [4/6] | Epoch [44/120] |	nca: 4.5843311827629805, flat: 3.0989203713834286, pod: 44.45034855604172, loss: 52.13360023498535 
Train [4/6] | Epoch [45/120] |	nca: 4.976182006299496, flat: 3.0708627216517925, pod: 44.83464229106903, loss: 52.881687104701996 
Train [4/6] | Epoch [46/120] |	nca: 4.279783599078655, flat: 3.1677493788301945, pod: 45.151746928691864, loss: 52.59927988052368 
Train [4/6] | Epoch [47/120] |	nca: 4.03137793764472, flat: 2.9816931821405888, pod: 43.601891219615936, loss: 50.614962339401245 
Train [4/6] | Epoch [48/120] |	nca: 4.704207591712475, flat: 2.9212129190564156, pod: 43.66221171617508, loss: 51.28763246536255 
Train [4/6] | Epoch [49/120] |	nca: 4.9884541146457195, flat: 3.063537072390318, pod: 43.20191466808319, loss: 51.25390589237213 
Train [4/6] | Epoch [50/120] |	nca: 4.52180840075016, flat: 2.9978695325553417, pod: 42.46582704782486, loss: 49.98550498485565 
Train [4/6] | Epoch [51/120] |	nca: 4.088164936751127, flat: 2.8186174146831036, pod: 41.48754996061325, loss: 48.39433217048645 
Train [4/6] | Epoch [52/120] |	nca: 4.108142174780369, flat: 2.8946448341012, pod: 42.013265788555145, loss: 49.01605278253555 
Train [4/6] | Epoch [53/120] |	nca: 4.229212377220392, flat: 2.9282151460647583, pod: 42.39576697349548, loss: 49.55319446325302 
Train [4/6] | Epoch [54/120] |	nca: 4.104499876499176, flat: 2.7975048683583736, pod: 41.31892818212509, loss: 48.220932960510254 
Train [4/6] | Epoch [55/120] |	nca: 4.027448013424873, flat: 2.8559776805341244, pod: 41.444975554943085, loss: 48.3284010887146 
Train [4/6] | Epoch [56/120] |	nca: 3.81084056571126, flat: 2.6679469756782055, pod: 38.87297523021698, loss: 45.35176247358322 
Train [4/6] | Epoch [57/120] |	nca: 3.609623033553362, flat: 2.850278325378895, pod: 41.576927185058594, loss: 48.036828458309174 
Train [4/6] | Epoch [58/120] |	nca: 3.4460566379129887, flat: 2.7496669441461563, pod: 40.091647922992706, loss: 46.2873712182045 
Train [4/6] | Epoch [59/120] |	nca: 3.718523310497403, flat: 2.6628879830241203, pod: 39.40861612558365, loss: 45.790027499198914 
Train [4/6] | Epoch [60/120] |	nca: 3.631730906665325, flat: 2.734217830002308, pod: 40.92770928144455, loss: 47.29365825653076 
Train [4/6] | Epoch [61/120] |	nca: 3.476356156170368, flat: 2.7517982497811317, pod: 41.48317402601242, loss: 47.71132856607437 
Train [4/6] | Epoch [62/120] |	nca: 3.520939890295267, flat: 2.718997523188591, pod: 40.57206463813782, loss: 46.81200212240219 
Train [4/6] | Epoch [63/120] |	nca: 3.334293346852064, flat: 2.5817264951765537, pod: 38.473647594451904, loss: 44.38966745138168 
Train [4/6] | Epoch [64/120] |	nca: 3.193983543664217, flat: 2.5882328748703003, pod: 39.54463165998459, loss: 45.326848328113556 
Train [4/6] | Epoch [65/120] |	nca: 3.0769321881234646, flat: 2.4934788197278976, pod: 36.9256591796875, loss: 42.49607038497925 
Train [4/6] | Epoch [66/120] |	nca: 3.472588062286377, flat: 2.5817220620810986, pod: 37.27347391843796, loss: 43.32778388261795 
Train [4/6] | Epoch [67/120] |	nca: 3.2444105744361877, flat: 2.5170507356524467, pod: 36.680547297000885, loss: 42.442008793354034 
Train [4/6] | Epoch [68/120] |	nca: 3.2148842345923185, flat: 2.5879043862223625, pod: 38.26407915353775, loss: 44.06686782836914 
Train [4/6] | Epoch [69/120] |	nca: 3.4099966771900654, flat: 2.4361444413661957, pod: 36.536913096904755, loss: 42.383054196834564 
Train [4/6] | Epoch [70/120] |	nca: 2.767272349447012, flat: 2.4085684455931187, pod: 35.815778374671936, loss: 40.99161916971207 
Train [4/6] | Epoch [71/120] |	nca: 3.134059127420187, flat: 2.4745562449097633, pod: 37.766162514686584, loss: 43.37477791309357 
Train [4/6] | Epoch [72/120] |	nca: 3.0889959074556828, flat: 2.334593139588833, pod: 34.77817153930664, loss: 40.20176064968109 
Train [4/6] | Epoch [73/120] |	nca: 2.8855227772146463, flat: 2.427081935107708, pod: 36.14170378446579, loss: 41.454308211803436 
Train [4/6] | Epoch [74/120] |	nca: 3.16522067040205, flat: 2.397848665714264, pod: 34.80861234664917, loss: 40.371681451797485 
Train [4/6] | Epoch [75/120] |	nca: 3.012777391821146, flat: 2.389074482023716, pod: 34.44909203052521, loss: 39.850943863391876 
Train [4/6] | Epoch [76/120] |	nca: 2.916083987802267, flat: 2.170573115348816, pod: 32.57702475786209, loss: 37.66368180513382 
Train [4/6] | Epoch [77/120] |	nca: 2.6222643181681633, flat: 2.185619916766882, pod: 32.175417363643646, loss: 36.983301758766174 
Train [4/6] | Epoch [78/120] |	nca: 2.787243975326419, flat: 2.176539648324251, pod: 32.79002374410629, loss: 37.75380736589432 
Train [4/6] | Epoch [79/120] |	nca: 2.763570297509432, flat: 2.197893913835287, pod: 33.38686615228653, loss: 38.34833073616028 
Train [4/6] | Epoch [80/120] |	nca: 2.666896812617779, flat: 2.278306644409895, pod: 34.474245965480804, loss: 39.4194495677948 
Train [4/6] | Epoch [81/120] |	nca: 2.5460229087620974, flat: 2.0555599331855774, pod: 31.72281050682068, loss: 36.3243932723999 
Train [4/6] | Epoch [82/120] |	nca: 2.3910760432481766, flat: 2.107848893851042, pod: 31.812004327774048, loss: 36.310929238796234 
Train [4/6] | Epoch [83/120] |	nca: 2.25866493396461, flat: 2.137750905007124, pod: 32.5749876499176, loss: 36.971403658390045 
Train [4/6] | Epoch [84/120] |	nca: 2.3194634560495615, flat: 2.0077781453728676, pod: 30.829922705888748, loss: 35.1571643948555 
Train [4/6] | Epoch [85/120] |	nca: 2.3180890791118145, flat: 2.047197412699461, pod: 30.477654695510864, loss: 34.842940986156464 
Train [4/6] | Epoch [86/120] |	nca: 2.3509540650993586, flat: 1.9644692223519087, pod: 30.4677671790123, loss: 34.78319054841995 
Train [4/6] | Epoch [87/120] |	nca: 2.338180458173156, flat: 2.0379918478429317, pod: 30.815851509571075, loss: 35.19202387332916 
Train [4/6] | Epoch [88/120] |	nca: 2.4212479572743177, flat: 2.1653615944087505, pod: 32.691568434238434, loss: 37.27817815542221 
Train [4/6] | Epoch [89/120] |	nca: 2.2498895674943924, flat: 1.8855770602822304, pod: 28.614337772130966, loss: 32.74980443716049 
Train [4/6] | Epoch [90/120] |	nca: 2.1813265066593885, flat: 1.8473556879907846, pod: 29.092622876167297, loss: 33.12130492925644 
Train [4/6] | Epoch [91/120] |	nca: 1.9321053717285395, flat: 1.8824330046772957, pod: 28.846880972385406, loss: 32.66141927242279 
Train [4/6] | Epoch [92/120] |	nca: 2.264807255938649, flat: 1.9071180652827024, pod: 28.38799449801445, loss: 32.55991983413696 
Train [4/6] | Epoch [93/120] |	nca: 2.2519695591181517, flat: 1.836343614384532, pod: 27.742550313472748, loss: 31.83086359500885 
Train [4/6] | Epoch [94/120] |	nca: 2.01039001904428, flat: 1.787422826513648, pod: 26.519431859254837, loss: 30.31724452972412 
Train [4/6] | Epoch [95/120] |	nca: 2.1817357633262873, flat: 1.852745758369565, pod: 27.63923278450966, loss: 31.67371439933777 
Train [4/6] | Epoch [96/120] |	nca: 2.0805495865643024, flat: 1.780514171347022, pod: 26.688618540763855, loss: 30.549682170152664 
Train [4/6] | Epoch [97/120] |	nca: 1.9095377698540688, flat: 1.7894512433558702, pod: 26.658374309539795, loss: 30.35736334323883 
Train [4/6] | Epoch [98/120] |	nca: 2.073018489405513, flat: 1.7345931977033615, pod: 25.45747199654579, loss: 29.265083730220795 
Train [4/6] | Epoch [99/120] |	nca: 1.973997063934803, flat: 1.776254953816533, pod: 26.382748693227768, loss: 30.133000522851944 
Train [4/6] | Epoch [100/120] |	nca: 2.0055983290076256, flat: 1.7463114727288485, pod: 25.905092120170593, loss: 29.657001793384552 
Train [4/6] | Epoch [101/120] |	nca: 2.1713708620518446, flat: 1.7015466410666704, pod: 25.06339567899704, loss: 28.93631312251091 
Train [4/6] | Epoch [102/120] |	nca: 1.8708074036985636, flat: 1.663127699866891, pod: 24.67990881204605, loss: 28.21384385228157 
Train [4/6] | Epoch [103/120] |	nca: 1.8955793157219887, flat: 1.639535641297698, pod: 24.281551092863083, loss: 27.816666185855865 
Train [4/6] | Epoch [104/120] |	nca: 1.9386122561991215, flat: 1.6823086366057396, pod: 24.545226335525513, loss: 28.16614744067192 
Train [4/6] | Epoch [105/120] |	nca: 1.9488905612379313, flat: 1.6193759944289923, pod: 24.473234564065933, loss: 28.041500985622406 
Train [4/6] | Epoch [106/120] |	nca: 1.7967797350138426, flat: 1.60578778013587, pod: 23.487335592508316, loss: 26.889903336763382 
Train [4/6] | Epoch [107/120] |	nca: 1.7782303728163242, flat: 1.5804147813469172, pod: 22.563248306512833, loss: 25.921893417835236 
Train [4/6] | Epoch [108/120] |	nca: 1.9814535658806562, flat: 1.5785550568252802, pod: 23.21849250793457, loss: 26.77850118279457 
Train [4/6] | Epoch [109/120] |	nca: 1.6725188866257668, flat: 1.638876872137189, pod: 23.667242258787155, loss: 26.97863793373108 
Train [4/6] | Epoch [110/120] |	nca: 1.7670612055808306, flat: 1.5253998264670372, pod: 22.06398770213127, loss: 25.35644882917404 
Train [4/6] | Epoch [111/120] |	nca: 1.8628766741603613, flat: 1.5946303885430098, pod: 23.148318350315094, loss: 26.605825632810593 
Train [4/6] | Epoch [112/120] |	nca: 1.7049800846725702, flat: 1.5565335135906935, pod: 22.32150450348854, loss: 25.583018213510513 
Train [4/6] | Epoch [113/120] |	nca: 1.7009600847959518, flat: 1.5869842246174812, pod: 23.557554572820663, loss: 26.845499098300934 
Train [4/6] | Epoch [114/120] |	nca: 1.848799565806985, flat: 1.4805528409779072, pod: 21.251861691474915, loss: 24.581214100122452 
Train [4/6] | Epoch [115/120] |	nca: 1.7979922331869602, flat: 1.4602271560579538, pod: 21.27383777499199, loss: 24.532057136297226 
Train [4/6] | Epoch [116/120] |	nca: 1.7303148452192545, flat: 1.4928334131836891, pod: 21.35539212822914, loss: 24.57854026556015 
Train [4/6] | Epoch [117/120] |	nca: 1.6847297456115484, flat: 1.5037227924913168, pod: 21.568111777305603, loss: 24.75656431913376 
Train [4/6] | Epoch [118/120] |	nca: 1.7677063439041376, flat: 1.4874156415462494, pod: 21.671577602624893, loss: 24.926699548959732 
Train [4/6] | Epoch [119/120] |	nca: 1.856754282489419, flat: 1.500538356602192, pod: 21.503627061843872, loss: 24.860919684171677 
Train [4/6] | Epoch [120/120] |	nca: 1.6768078971654177, flat: 1.4915829077363014, pod: 20.994037002325058, loss: 24.16242790222168 
Fine-tuning
Building & updating memory.
Train [4/6] | Epoch [121/140] |	nca: 6.211171984672546, flat: 1.70524662733078, pod: 17.721394777297974, loss: 25.637813091278076 
Train [4/6] | Epoch [122/140] |	nca: 2.1075753048062325, flat: 1.6636960208415985, pod: 17.50853455066681, loss: 21.279805898666382 
Train [4/6] | Epoch [123/140] |	nca: 1.741939663887024, flat: 1.6529734432697296, pod: 17.48523700237274, loss: 20.880149841308594 
Train [4/6] | Epoch [124/140] |	nca: 1.4335865825414658, flat: 1.7196923419833183, pod: 17.73209512233734, loss: 20.885374188423157 
Train [4/6] | Epoch [125/140] |	nca: 1.421233132481575, flat: 1.6772213950753212, pod: 17.485031604766846, loss: 20.583485960960388 
Train [4/6] | Epoch [126/140] |	nca: 1.3761445060372353, flat: 1.6484776884317398, pod: 17.48295247554779, loss: 20.507574439048767 
Train [4/6] | Epoch [127/140] |	nca: 1.263675905764103, flat: 1.6595149114727974, pod: 17.459277153015137, loss: 20.3824679851532 
Train [4/6] | Epoch [128/140] |	nca: 1.2793406397104263, flat: 1.7013436928391457, pod: 17.526419639587402, loss: 20.50710391998291 
Train [4/6] | Epoch [129/140] |	nca: 1.1309232860803604, flat: 1.7197390496730804, pod: 17.509334206581116, loss: 20.359996676445007 
Train [4/6] | Epoch [130/140] |	nca: 1.2230582125484943, flat: 1.6733597218990326, pod: 17.56065320968628, loss: 20.45707106590271 
Train [4/6] | Epoch [131/140] |	nca: 1.175485223531723, flat: 1.7543911635875702, pod: 17.648864150047302, loss: 20.57874035835266 
Train [4/6] | Epoch [132/140] |	nca: 1.0750858709216118, flat: 1.6863623335957527, pod: 17.72154188156128, loss: 20.48299014568329 
Train [4/6] | Epoch [133/140] |	nca: 1.0778330639004707, flat: 1.6657335981726646, pod: 17.360519647598267, loss: 20.10408627986908 
Train [4/6] | Epoch [134/140] |	nca: 1.1574182137846947, flat: 1.7281085550785065, pod: 17.566555380821228, loss: 20.45208239555359 
Train [4/6] | Epoch [135/140] |	nca: 1.0875161215662956, flat: 1.694875419139862, pod: 17.55872404575348, loss: 20.341115474700928 
Train [4/6] | Epoch [136/140] |	nca: 1.1820390187203884, flat: 1.747179463505745, pod: 17.742145895957947, loss: 20.671364188194275 
Train [4/6] | Epoch [137/140] |	nca: 1.027937863022089, flat: 1.7105563580989838, pod: 17.655635237693787, loss: 20.394129514694214 
Train [4/6] | Epoch [138/140] |	nca: 1.0144298449158669, flat: 1.7016885802149773, pod: 17.686211824417114, loss: 20.40233051776886 
Train [4/6] | Epoch [139/140] |	nca: 1.035189162939787, flat: 1.700134590268135, pod: 17.718422532081604, loss: 20.45374619960785 
Train [4/6] | Epoch [140/140] |	nca: 1.0533640012145042, flat: 1.7368097677826881, pod: 17.758631348609924, loss: 20.548805236816406 
after task
Building & updating memory.
after task
Eval on 0->8.
eval task
podnet_cnn_cifar10_5steps
Avg inc acc: 0.8744999999999999.
Current acc: {'total': 0.81, '00-09': 0.81}.
Avg inc acc top5: 0.9982500000000001.
Current acc top5: {'total': 0.995}.
Forgetting: 0.08099999999999996.
Cord metric: 0.87.
Old accuracy: 0.79, mean: 0.83.
New accuracy: 0.96, mean: 0.90.
================Task 4 Start!================
Testing on False unseen tasks (max class = 9).
Set memory of size: 1600.
Before task
Generating imprinted weights
Multi class diff kmeans.
Now 200 examplars per class.
Group: convnet, lr: 0.1.
Group: postprocessing, lr: 0.1.
Group: new_weights, lr: 0.1.
================Task 4 Training!================
The training samples number: 6600
Train on 8->9.
train task
nb 6600.
Train [5/6] | Epoch [1/120] |	nca: 21.29753689467907, flat: 13.451812341809273, pod: 82.11066353321075, loss: 116.86001336574554 
Train [5/6] | Epoch [2/120] |	nca: 12.250540502369404, flat: 7.438508860766888, pod: 62.549196004867554, loss: 82.23824548721313 
Train [5/6] | Epoch [3/120] |	nca: 10.951631836593151, flat: 6.963587157428265, pod: 60.57825195789337, loss: 78.49347078800201 
Train [5/6] | Epoch [4/120] |	nca: 9.961955457925797, flat: 6.708020716905594, pod: 59.95434606075287, loss: 76.62432205677032 
Train [5/6] | Epoch [5/120] |	nca: 9.308610416948795, flat: 6.577995799481869, pod: 59.232186794281006, loss: 75.11879312992096 
Train [5/6] | Epoch [6/120] |	nca: 9.088703028857708, flat: 5.940687753260136, pod: 54.82683789730072, loss: 69.85622882843018 
Train [5/6] | Epoch [7/120] |	nca: 8.930205255746841, flat: 6.183517076075077, pod: 56.90190064907074, loss: 72.01562321186066 
Train [5/6] | Epoch [8/120] |	nca: 7.407513789832592, flat: 5.500870756804943, pod: 53.0368310213089, loss: 65.9452154636383 
Train [5/6] | Epoch [9/120] |	nca: 7.533832401037216, flat: 5.709517762064934, pod: 54.76829916238785, loss: 68.01164948940277 
Train [5/6] | Epoch [10/120] |	nca: 7.8558957278728485, flat: 5.661652386188507, pod: 53.58648043870926, loss: 67.10402882099152 
Train [5/6] | Epoch [11/120] |	nca: 7.294119969010353, flat: 5.680364415049553, pod: 52.809144735336304, loss: 65.78362894058228 
Train [5/6] | Epoch [12/120] |	nca: 6.35206264257431, flat: 5.26514195650816, pod: 50.69349443912506, loss: 62.310699105262756 
Train [5/6] | Epoch [13/120] |	nca: 6.976240985095501, flat: 5.438176594674587, pod: 51.475714683532715, loss: 63.890132546424866 
Train [5/6] | Epoch [14/120] |	nca: 6.507733479142189, flat: 5.236745588481426, pod: 51.66597980260849, loss: 63.41045904159546 
Train [5/6] | Epoch [15/120] |	nca: 7.072376821190119, flat: 5.3432609885931015, pod: 52.49179357290268, loss: 64.90743136405945 
Train [5/6] | Epoch [16/120] |	nca: 6.444778509438038, flat: 5.29731809347868, pod: 51.25989747047424, loss: 63.001994132995605 
Train [5/6] | Epoch [17/120] |	nca: 6.246149308979511, flat: 5.303670585155487, pod: 51.814879417419434, loss: 63.36469924449921 
Train [5/6] | Epoch [18/120] |	nca: 6.088791020214558, flat: 4.995566755533218, pod: 48.93621039390564, loss: 60.02056860923767 
Train [5/6] | Epoch [19/120] |	nca: 6.189499083906412, flat: 5.196292161941528, pod: 51.274986028671265, loss: 62.66077697277069 
Train [5/6] | Epoch [20/120] |	nca: 6.336093537509441, flat: 5.156733147799969, pod: 50.50313103199005, loss: 61.99595808982849 
Train [5/6] | Epoch [21/120] |	nca: 5.583255235105753, flat: 4.976004756987095, pod: 49.21547847986221, loss: 59.77473843097687 
Train [5/6] | Epoch [22/120] |	nca: 5.5305843241512775, flat: 5.114142410457134, pod: 49.09316509962082, loss: 59.737892150878906 
Train [5/6] | Epoch [23/120] |	nca: 5.8742010816931725, flat: 5.194699987769127, pod: 50.21002823114395, loss: 61.278929114341736 
Train [5/6] | Epoch [24/120] |	nca: 6.234120719134808, flat: 5.2000124007463455, pod: 49.11057448387146, loss: 60.544708013534546 
Train [5/6] | Epoch [25/120] |	nca: 5.049606911838055, flat: 5.030399300158024, pod: 49.13808125257492, loss: 59.2180871963501 
Train [5/6] | Epoch [26/120] |	nca: 5.5574175752699375, flat: 4.92395381629467, pod: 48.54998105764389, loss: 59.03135299682617 
Train [5/6] | Epoch [27/120] |	nca: 5.940669238567352, flat: 5.170290596783161, pod: 49.1077361702919, loss: 60.21869599819183 
Train [5/6] | Epoch [28/120] |	nca: 5.1051138788461685, flat: 4.768341779708862, pod: 47.21432375907898, loss: 57.087779462337494 
Train [5/6] | Epoch [29/120] |	nca: 4.951810289174318, flat: 4.752072088420391, pod: 48.80671161413193, loss: 58.51059412956238 
Train [5/6] | Epoch [30/120] |	nca: 5.670623309910297, flat: 4.725588351488113, pod: 46.907568633556366, loss: 57.30377995967865 
Train [5/6] | Epoch [31/120] |	nca: 5.415961138904095, flat: 4.866748608648777, pod: 48.11461919546127, loss: 58.397329330444336 
Train [5/6] | Epoch [32/120] |	nca: 5.259955782443285, flat: 4.817132383584976, pod: 47.670055627822876, loss: 57.74714386463165 
Train [5/6] | Epoch [33/120] |	nca: 5.001756392419338, flat: 4.824466213583946, pod: 46.63172674179077, loss: 56.457949221134186 
Train [5/6] | Epoch [34/120] |	nca: 5.131361585110426, flat: 4.638941943645477, pod: 45.879701256752014, loss: 55.65000528097153 
Train [5/6] | Epoch [35/120] |	nca: 5.2765310779213905, flat: 4.919666513800621, pod: 47.12540405988693, loss: 57.32160174846649 
Train [5/6] | Epoch [36/120] |	nca: 4.902147281914949, flat: 4.632688842713833, pod: 46.599146008491516, loss: 56.13398194313049 
Train [5/6] | Epoch [37/120] |	nca: 5.0261738039553165, flat: 4.619511067867279, pod: 46.52132546901703, loss: 56.16701006889343 
Train [5/6] | Epoch [38/120] |	nca: 5.18830257281661, flat: 4.6096760258078575, pod: 45.0074862241745, loss: 54.80546522140503 
Train [5/6] | Epoch [39/120] |	nca: 4.607571430504322, flat: 4.389451436698437, pod: 44.61539125442505, loss: 53.61241400241852 
Train [5/6] | Epoch [40/120] |	nca: 5.182594638317823, flat: 5.031690187752247, pod: 48.47779560089111, loss: 58.692080318927765 
Train [5/6] | Epoch [41/120] |	nca: 4.917516052722931, flat: 4.617055244743824, pod: 45.57424354553223, loss: 55.10881495475769 
Train [5/6] | Epoch [42/120] |	nca: 5.027163341641426, flat: 4.67392522841692, pod: 46.69855457544327, loss: 56.39964300394058 
Train [5/6] | Epoch [43/120] |	nca: 4.571025621145964, flat: 4.505976751446724, pod: 44.94263607263565, loss: 54.019638657569885 
Train [5/6] | Epoch [44/120] |	nca: 4.769517932087183, flat: 4.629604957997799, pod: 45.759834706783295, loss: 55.1589577794075 
Train [5/6] | Epoch [45/120] |	nca: 5.605876114219427, flat: 4.782697543501854, pod: 46.06207627058029, loss: 56.450650215148926 
Train [5/6] | Epoch [46/120] |	nca: 4.862572938203812, flat: 4.695591151714325, pod: 46.174249827861786, loss: 55.73241376876831 
Train [5/6] | Epoch [47/120] |	nca: 4.381591569632292, flat: 4.421949051320553, pod: 44.583710849285126, loss: 53.38725143671036 
Train [5/6] | Epoch [48/120] |	nca: 4.095608785748482, flat: 4.250985719263554, pod: 43.08879369497299, loss: 51.43538838624954 
Train [5/6] | Epoch [49/120] |	nca: 4.35641073808074, flat: 4.5062718987464905, pod: 44.35709369182587, loss: 53.21977639198303 
Train [5/6] | Epoch [50/120] |	nca: 4.465477287769318, flat: 4.230605237185955, pod: 43.029141902923584, loss: 51.7252242565155 
Train [5/6] | Epoch [51/120] |	nca: 4.1498839519917965, flat: 4.2223131619393826, pod: 41.86994129419327, loss: 50.242138504981995 
Train [5/6] | Epoch [52/120] |	nca: 3.720831997692585, flat: 4.098895758390427, pod: 40.92280328273773, loss: 48.742531180381775 
Train [5/6] | Epoch [53/120] |	nca: 4.355525519698858, flat: 4.247568920254707, pod: 42.417536318302155, loss: 51.020631074905396 
Train [5/6] | Epoch [54/120] |	nca: 3.809569176286459, flat: 4.069790717214346, pod: 40.89087474346161, loss: 48.77023482322693 
Train [5/6] | Epoch [55/120] |	nca: 4.320992909371853, flat: 4.3537339344620705, pod: 42.5855268239975, loss: 51.260253727436066 
Train [5/6] | Epoch [56/120] |	nca: 4.1737783551216125, flat: 4.011947818100452, pod: 40.51637303829193, loss: 48.702099442481995 
Train [5/6] | Epoch [57/120] |	nca: 3.9340556412935257, flat: 4.139604214578867, pod: 40.881440699100494, loss: 48.955100536346436 
Train [5/6] | Epoch [58/120] |	nca: 3.732564901933074, flat: 4.038732618093491, pod: 40.015409886837006, loss: 47.78670769929886 
Train [5/6] | Epoch [59/120] |	nca: 3.7878958247601986, flat: 3.979887370020151, pod: 38.46516174077988, loss: 46.23294496536255 
Train [5/6] | Epoch [60/120] |	nca: 3.367485612630844, flat: 3.7850018851459026, pod: 38.52252268791199, loss: 45.675010323524475 
Train [5/6] | Epoch [61/120] |	nca: 3.6634964533150196, flat: 3.8229690231382847, pod: 38.073996782302856, loss: 45.560462296009064 
Train [5/6] | Epoch [62/120] |	nca: 3.599829737097025, flat: 4.0486281886696815, pod: 39.60025030374527, loss: 47.248708605766296 
Train [5/6] | Epoch [63/120] |	nca: 3.453209538012743, flat: 3.7570849992334843, pod: 37.856249272823334, loss: 45.06654363870621 
Train [5/6] | Epoch [64/120] |	nca: 3.502080012112856, flat: 3.76736718416214, pod: 38.54023540019989, loss: 45.80968254804611 
Train [5/6] | Epoch [65/120] |	nca: 3.9698048792779446, flat: 3.836240269243717, pod: 38.73922419548035, loss: 46.54526925086975 
Train [5/6] | Epoch [66/120] |	nca: 3.391975414007902, flat: 3.6668127812445164, pod: 36.74252027273178, loss: 43.80130833387375 
Train [5/6] | Epoch [67/120] |	nca: 3.4130960516631603, flat: 3.7771111242473125, pod: 37.6639199256897, loss: 44.85412710905075 
Train [5/6] | Epoch [68/120] |	nca: 3.2464676424860954, flat: 3.693086802959442, pod: 37.22416174411774, loss: 44.163716077804565 
Train [5/6] | Epoch [69/120] |	nca: 3.0500856954604387, flat: 3.7680633701384068, pod: 37.7482453584671, loss: 44.56639438867569 
Train [5/6] | Epoch [70/120] |	nca: 3.448719821870327, flat: 3.6191460601985455, pod: 35.767441153526306, loss: 42.835306882858276 
Train [5/6] | Epoch [71/120] |	nca: 3.1056244149804115, flat: 3.5658849626779556, pod: 36.34077429771423, loss: 43.012283742427826 
Train [5/6] | Epoch [72/120] |	nca: 2.62324371188879, flat: 3.2957794032990932, pod: 33.25715684890747, loss: 39.17618000507355 
Train [5/6] | Epoch [73/120] |	nca: 3.111146556213498, flat: 3.4564242139458656, pod: 34.03544557094574, loss: 40.60301607847214 
Train [5/6] | Epoch [74/120] |	nca: 3.251911483705044, flat: 3.5965904518961906, pod: 36.1741589307785, loss: 43.02266085147858 
Train [5/6] | Epoch [75/120] |	nca: 2.9651448745280504, flat: 3.5064437203109264, pod: 34.74025106430054, loss: 41.21183943748474 
Train [5/6] | Epoch [76/120] |	nca: 2.659781664609909, flat: 3.203316792845726, pod: 33.48058921098709, loss: 39.3436878323555 
Train [5/6] | Epoch [77/120] |	nca: 2.8809739984571934, flat: 3.275624878704548, pod: 32.68887597322464, loss: 38.845475018024445 
Train [5/6] | Epoch [78/120] |	nca: 3.022876225411892, flat: 3.2624376378953457, pod: 33.65544658899307, loss: 39.94076031446457 
Train [5/6] | Epoch [79/120] |	nca: 2.5874838531017303, flat: 3.318489771336317, pod: 33.47084575891495, loss: 39.376819491386414 
Train [5/6] | Epoch [80/120] |	nca: 2.480694502592087, flat: 3.091892823576927, pod: 31.107516795396805, loss: 36.68010413646698 
Train [5/6] | Epoch [81/120] |	nca: 2.4809191897511482, flat: 3.222440432757139, pod: 32.46240532398224, loss: 38.165765047073364 
Train [5/6] | Epoch [82/120] |	nca: 2.6397698540240526, flat: 3.2441023401916027, pod: 32.17906665802002, loss: 38.06293869018555 
Train [5/6] | Epoch [83/120] |	nca: 2.5646965466439724, flat: 3.0439992286264896, pod: 30.945459842681885, loss: 36.554155707359314 
Train [5/6] | Epoch [84/120] |	nca: 2.4198087323457003, flat: 3.1698534227907658, pod: 32.03502982854843, loss: 37.62469184398651 
Train [5/6] | Epoch [85/120] |	nca: 2.495025446638465, flat: 2.9932598136365414, pod: 29.312447369098663, loss: 34.80073261260986 
Train [5/6] | Epoch [86/120] |	nca: 2.6894467771053314, flat: 3.0688993968069553, pod: 29.832694232463837, loss: 35.59104037284851 
Train [5/6] | Epoch [87/120] |	nca: 2.2933862321078777, flat: 3.0376997590065002, pod: 29.99973675608635, loss: 35.33082300424576 
Train [5/6] | Epoch [88/120] |	nca: 2.3769520465284586, flat: 2.9829631224274635, pod: 29.640537530183792, loss: 35.00045293569565 
Train [5/6] | Epoch [89/120] |	nca: 2.4791292138397694, flat: 3.020361542701721, pod: 29.88347265124321, loss: 35.38296335935593 
Train [5/6] | Epoch [90/120] |	nca: 2.315182527527213, flat: 3.0035837590694427, pod: 29.02098524570465, loss: 34.33975154161453 
Train [5/6] | Epoch [91/120] |	nca: 2.15347789414227, flat: 2.837869331240654, pod: 27.252110302448273, loss: 32.243457555770874 
Train [5/6] | Epoch [92/120] |	nca: 2.320422288030386, flat: 2.927800964564085, pod: 28.223217636346817, loss: 33.47144079208374 
Train [5/6] | Epoch [93/120] |	nca: 2.2613684944808483, flat: 2.8770476318895817, pod: 26.934314846992493, loss: 32.07273077964783 
Train [5/6] | Epoch [94/120] |	nca: 2.2188330963253975, flat: 2.7913203351199627, pod: 27.20169821381569, loss: 32.21185153722763 
Train [5/6] | Epoch [95/120] |	nca: 2.23112821765244, flat: 2.7891821078956127, pod: 26.691357791423798, loss: 31.711668014526367 
Train [5/6] | Epoch [96/120] |	nca: 2.136546680703759, flat: 2.7602626234292984, pod: 26.92318657040596, loss: 31.819995939731598 
Train [5/6] | Epoch [97/120] |	nca: 2.1623820550739765, flat: 2.7163587920367718, pod: 25.528334617614746, loss: 30.407075434923172 
Train [5/6] | Epoch [98/120] |	nca: 2.046806475147605, flat: 2.6663608253002167, pod: 24.959066957235336, loss: 29.672234058380127 
Train [5/6] | Epoch [99/120] |	nca: 2.204532478004694, flat: 2.6364204920828342, pod: 25.15425106883049, loss: 29.995204001665115 
Train [5/6] | Epoch [100/120] |	nca: 2.183216158300638, flat: 2.765736911445856, pod: 25.640319406986237, loss: 30.58927232027054 
Train [5/6] | Epoch [101/120] |	nca: 2.1232607308775187, flat: 2.7433143965899944, pod: 25.11274829506874, loss: 29.979323387145996 
Train [5/6] | Epoch [102/120] |	nca: 2.169335328042507, flat: 2.6763518899679184, pod: 24.817659825086594, loss: 29.663346886634827 
Train [5/6] | Epoch [103/120] |	nca: 2.177938750013709, flat: 2.688476413488388, pod: 23.728295356035233, loss: 28.59471043944359 
Train [5/6] | Epoch [104/120] |	nca: 2.083424288779497, flat: 2.62428804859519, pod: 23.73054066300392, loss: 28.438253074884415 
Train [5/6] | Epoch [105/120] |	nca: 2.119523650035262, flat: 2.6500273160636425, pod: 23.91580531001091, loss: 28.685356229543686 
Train [5/6] | Epoch [106/120] |	nca: 1.9981844127178192, flat: 2.55779941752553, pod: 23.028599619865417, loss: 27.58458349108696 
Train [5/6] | Epoch [107/120] |	nca: 2.1344912089407444, flat: 2.513616632670164, pod: 22.486506521701813, loss: 27.13461458683014 
Train [5/6] | Epoch [108/120] |	nca: 2.035845408216119, flat: 2.542788404971361, pod: 22.762673944234848, loss: 27.341307789087296 
Train [5/6] | Epoch [109/120] |	nca: 2.1523562613874674, flat: 2.5449693836271763, pod: 22.93309098482132, loss: 27.630416750907898 
Train [5/6] | Epoch [110/120] |	nca: 2.0619389954954386, flat: 2.570790559053421, pod: 22.34594601392746, loss: 26.978675663471222 
Train [5/6] | Epoch [111/120] |	nca: 1.914059003815055, flat: 2.511501707136631, pod: 21.779825270175934, loss: 26.205386102199554 
Train [5/6] | Epoch [112/120] |	nca: 2.010151647031307, flat: 2.5117202550172806, pod: 22.365091562271118, loss: 26.886963486671448 
Train [5/6] | Epoch [113/120] |	nca: 2.0223550871014595, flat: 2.518007591366768, pod: 22.513556391000748, loss: 27.053919047117233 
Train [5/6] | Epoch [114/120] |	nca: 2.104251181706786, flat: 2.4298723340034485, pod: 21.010960429906845, loss: 25.545083850622177 
Train [5/6] | Epoch [115/120] |	nca: 2.0603551790118217, flat: 2.482111234217882, pod: 21.199298202991486, loss: 25.74176451563835 
Train [5/6] | Epoch [116/120] |	nca: 2.059453446418047, flat: 2.489077802747488, pod: 20.82709291577339, loss: 25.37562420964241 
Train [5/6] | Epoch [117/120] |	nca: 1.892533726990223, flat: 2.4764916449785233, pod: 21.00063681602478, loss: 25.369662165641785 
Train [5/6] | Epoch [118/120] |	nca: 1.9639882259070873, flat: 2.4887691102921963, pod: 20.681085169315338, loss: 25.13384249806404 
Train [5/6] | Epoch [119/120] |	nca: 2.0810874439775944, flat: 2.5069191679358482, pod: 21.25805312395096, loss: 25.846059650182724 
Train [5/6] | Epoch [120/120] |	nca: 2.075789215043187, flat: 2.464868515729904, pod: 21.277965515851974, loss: 25.818623334169388 
Fine-tuning
Building & updating memory.
Train [5/6] | Epoch [121/140] |	nca: 9.53252001106739, flat: 4.192531168460846, pod: 25.78381836414337, loss: 39.50886952877045 
Train [5/6] | Epoch [122/140] |	nca: 3.278737962245941, flat: 3.9067540913820267, pod: 25.339707732200623, loss: 32.52520000934601 
Train [5/6] | Epoch [123/140] |	nca: 3.64596276730299, flat: 3.5825158059597015, pod: 24.375264406204224, loss: 31.603742837905884 
Train [5/6] | Epoch [124/140] |	nca: 2.1143937557935715, flat: 3.697727933526039, pod: 24.398295760154724, loss: 30.21041738986969 
Train [5/6] | Epoch [125/140] |	nca: 2.4629847332835197, flat: 3.50397427380085, pod: 23.93182897567749, loss: 29.89878809452057 
Train [5/6] | Epoch [126/140] |	nca: 3.5152266696095467, flat: 3.863830015063286, pod: 25.302318930625916, loss: 32.68137562274933 
Train [5/6] | Epoch [127/140] |	nca: 2.6431673243641853, flat: 3.7932967245578766, pod: 25.17284345626831, loss: 31.609307646751404 
Train [5/6] | Epoch [128/140] |	nca: 2.1052786484360695, flat: 3.8780020773410797, pod: 24.585142731666565, loss: 30.56842350959778 
Train [5/6] | Epoch [129/140] |	nca: 1.4820015281438828, flat: 3.601632222533226, pod: 24.317355513572693, loss: 29.400988936424255 
Train [5/6] | Epoch [130/140] |	nca: 1.4996281154453754, flat: 3.6306358724832535, pod: 24.939049005508423, loss: 30.069312810897827 
Train [5/6] | Epoch [131/140] |	nca: 1.5310711190104485, flat: 3.7234823554754257, pod: 24.552491664886475, loss: 29.807044744491577 
Train [5/6] | Epoch [132/140] |	nca: 1.4400160685181618, flat: 3.9102925956249237, pod: 25.676082372665405, loss: 31.02639126777649 
Train [5/6] | Epoch [133/140] |	nca: 1.5929411873221397, flat: 3.7152320444583893, pod: 24.741313099861145, loss: 30.04948616027832 
Train [5/6] | Epoch [134/140] |	nca: 1.2965196259319782, flat: 3.6785327792167664, pod: 24.456181287765503, loss: 29.431233644485474 
Train [5/6] | Epoch [135/140] |	nca: 1.3952208161354065, flat: 3.703867480158806, pod: 25.09934663772583, loss: 30.198434829711914 
Train [5/6] | Epoch [136/140] |	nca: 1.3404389172792435, flat: 3.6659192591905594, pod: 24.201370120048523, loss: 29.207728147506714 
Train [5/6] | Epoch [137/140] |	nca: 1.2315647341310978, flat: 3.809930145740509, pod: 24.869139313697815, loss: 29.91063416004181 
Train [5/6] | Epoch [138/140] |	nca: 1.5159027203917503, flat: 3.6250782161951065, pod: 24.259239077568054, loss: 29.400219798088074 
Train [5/6] | Epoch [139/140] |	nca: 1.6034148037433624, flat: 3.7467490136623383, pod: 25.306038856506348, loss: 30.65620243549347 
Train [5/6] | Epoch [140/140] |	nca: 1.622973494231701, flat: 3.515017420053482, pod: 23.71033775806427, loss: 28.848328828811646 
after task
Building & updating memory.
after task
Eval on 0->9.
eval task
podnet_cnn_cifar10_5steps
Avg inc acc: 0.8622.
Current acc: {'total': 0.813, '00-09': 0.813}.
Avg inc acc top5: 0.9970000000000001.
Current acc top5: {'total': 0.992}.
Forgetting: 0.07950000000000002.
Cord metric: 0.86.
Old accuracy: 0.80, mean: 0.82.
New accuracy: 0.95, mean: 0.91.
================Task 5 Start!================
Testing on False unseen tasks (max class = 10).
Set memory of size: 1800.
Before task
Generating imprinted weights
Multi class diff kmeans.
Now 200 examplars per class.
Group: convnet, lr: 0.1.
Group: postprocessing, lr: 0.1.
Group: new_weights, lr: 0.1.
================Task 5 Training!================
The training samples number: 6800
Train on 9->10.
train task
nb 6800.
Train [6/6] | Epoch [1/120] |	nca: 28.06380805373192, flat: 8.019225060939789, pod: 85.60043954849243, loss: 121.68347263336182 
Train [6/6] | Epoch [2/120] |	nca: 22.267005994915962, flat: 7.9122757241129875, pod: 87.26966261863708, loss: 117.44894337654114 
Train [6/6] | Epoch [3/120] |	nca: 18.797583296895027, flat: 7.160055100917816, pod: 83.18659901618958, loss: 109.14423704147339 
Train [6/6] | Epoch [4/120] |	nca: 16.041202679276466, flat: 5.971401244401932, pod: 74.6959935426712, loss: 96.70859754085541 
Train [6/6] | Epoch [5/120] |	nca: 14.3504299223423, flat: 5.60676196962595, pod: 72.35850965976715, loss: 92.31570148468018 
Train [6/6] | Epoch [6/120] |	nca: 14.807097241282463, flat: 5.378022342920303, pod: 69.46476626396179, loss: 89.64988577365875 
Train [6/6] | Epoch [7/120] |	nca: 14.250085905194283, flat: 5.244875594973564, pod: 67.56815195083618, loss: 87.06311368942261 
Train [6/6] | Epoch [8/120] |	nca: 12.513664066791534, flat: 4.93799464404583, pod: 63.622424483299255, loss: 81.07408308982849 
Train [6/6] | Epoch [9/120] |	nca: 12.469050869345665, flat: 4.888025552034378, pod: 63.90885651111603, loss: 81.26593291759491 
Train [6/6] | Epoch [10/120] |	nca: 12.923663899302483, flat: 5.365806274116039, pod: 67.12201488018036, loss: 85.4114853143692 
Train [6/6] | Epoch [11/120] |	nca: 14.296133443713188, flat: 6.125427760183811, pod: 71.03945827484131, loss: 91.46101951599121 
Train [6/6] | Epoch [12/120] |	nca: 10.837567679584026, flat: 4.700268045067787, pod: 60.53885006904602, loss: 76.07668554782867 
Train [6/6] | Epoch [13/120] |	nca: 12.145873732864857, flat: 5.155000597238541, pod: 67.41409385204315, loss: 84.71496784687042 
Train [6/6] | Epoch [14/120] |	nca: 10.613072253763676, flat: 5.028777867555618, pod: 65.06586372852325, loss: 80.70771372318268 
Train [6/6] | Epoch [15/120] |	nca: 10.497826531529427, flat: 4.566625185310841, pod: 59.83608376979828, loss: 74.9005354642868 
Train [6/6] | Epoch [16/120] |	nca: 9.998253554105759, flat: 4.704247057437897, pod: 61.89414584636688, loss: 76.59664642810822 
Train [6/6] | Epoch [17/120] |	nca: 10.50681934505701, flat: 4.790494926273823, pod: 63.237081944942474, loss: 78.53439581394196 
Train [6/6] | Epoch [18/120] |	nca: 13.221634596586227, flat: 6.101396203041077, pod: 71.1789618730545, loss: 90.50199294090271 
Train [6/6] | Epoch [19/120] |	nca: 10.76002748310566, flat: 5.202277049422264, pod: 65.56912016868591, loss: 81.5314245223999 
Train [6/6] | Epoch [20/120] |	nca: 9.127768091857433, flat: 4.687696717679501, pod: 60.28551083803177, loss: 74.10097563266754 
Train [6/6] | Epoch [21/120] |	nca: 9.49332658201456, flat: 4.455266326665878, pod: 59.24623221158981, loss: 73.19482553005219 
Train [6/6] | Epoch [22/120] |	nca: 10.76703741401434, flat: 4.980397813022137, pod: 63.51427239179611, loss: 79.26170790195465 
Train [6/6] | Epoch [23/120] |	nca: 9.552353419363499, flat: 4.707836650311947, pod: 60.45510792732239, loss: 74.71529805660248 
Train [6/6] | Epoch [24/120] |	nca: 10.377817273139954, flat: 4.618358410894871, pod: 59.998924016952515, loss: 74.99509990215302 
Train [6/6] | Epoch [25/120] |	nca: 10.053311690688133, flat: 5.027028977870941, pod: 61.8360710144043, loss: 76.91641128063202 
Train [6/6] | Epoch [26/120] |	nca: 9.454919256269932, flat: 4.778467953205109, pod: 60.42603975534439, loss: 74.65942668914795 
Train [6/6] | Epoch [27/120] |	nca: 8.128619648516178, flat: 4.317069977521896, pod: 57.19985055923462, loss: 69.64554059505463 
Train [6/6] | Epoch [28/120] |	nca: 9.291035674512386, flat: 4.699730843305588, pod: 62.26265233755112, loss: 76.25341868400574 
Train [6/6] | Epoch [29/120] |	nca: 8.030798122286797, flat: 4.486297227442265, pod: 59.5691334605217, loss: 72.0862284898758 
Train [6/6] | Epoch [30/120] |	nca: 8.638441383838654, flat: 4.374009370803833, pod: 58.05756515264511, loss: 71.07001614570618 
Train [6/6] | Epoch [31/120] |	nca: 9.47715762257576, flat: 4.3122728317976, pod: 56.63912099599838, loss: 70.42855143547058 
Train [6/6] | Epoch [32/120] |	nca: 9.0780626013875, flat: 4.886832885444164, pod: 60.3210791349411, loss: 74.28597450256348 
Train [6/6] | Epoch [33/120] |	nca: 8.912485353648663, flat: 4.764506697654724, pod: 60.44027954339981, loss: 74.11727154254913 
Train [6/6] | Epoch [34/120] |	nca: 9.148977354168892, flat: 4.661932118237019, pod: 59.201483488082886, loss: 73.01239275932312 
Train [6/6] | Epoch [35/120] |	nca: 9.288221329450607, flat: 5.232464358210564, pod: 62.36161136627197, loss: 76.88229715824127 
Train [6/6] | Epoch [36/120] |	nca: 7.7913051173090935, flat: 4.274092495441437, pod: 54.946331799030304, loss: 67.01172935962677 
Train [6/6] | Epoch [37/120] |	nca: 8.567728661000729, flat: 4.219100505113602, pod: 55.15923273563385, loss: 67.94606232643127 
Train [6/6] | Epoch [38/120] |	nca: 8.259023562073708, flat: 4.365923602133989, pod: 56.756374180316925, loss: 69.38132095336914 
Train [6/6] | Epoch [39/120] |	nca: 9.140961840748787, flat: 4.803621977567673, pod: 59.76890981197357, loss: 73.71349358558655 
Train [6/6] | Epoch [40/120] |	nca: 7.163130611181259, flat: 3.9677835069596767, pod: 53.855247497558594, loss: 64.9861615896225 
Train [6/6] | Epoch [41/120] |	nca: 6.7025522366166115, flat: 3.7662458047270775, pod: 51.09871190786362, loss: 61.56751036643982 
Train [6/6] | Epoch [42/120] |	nca: 8.129808500409126, flat: 4.004662554711103, pod: 54.49096721410751, loss: 66.62543797492981 
Train [6/6] | Epoch [43/120] |	nca: 9.396236598491669, flat: 5.062289446592331, pod: 62.40490937232971, loss: 76.86343538761139 
Train [6/6] | Epoch [44/120] |	nca: 7.813946060836315, flat: 4.619552753865719, pod: 58.69869351387024, loss: 71.13219201564789 
Train [6/6] | Epoch [45/120] |	nca: 6.441884398460388, flat: 4.004021935164928, pod: 54.263152718544006, loss: 64.70905923843384 
Train [6/6] | Epoch [46/120] |	nca: 6.569316554814577, flat: 3.9223256707191467, pod: 53.41918510198593, loss: 63.91082715988159 
Train [6/6] | Epoch [47/120] |	nca: 6.861664280295372, flat: 3.8903273306787014, pod: 52.20319378376007, loss: 62.955185532569885 
Train [6/6] | Epoch [48/120] |	nca: 7.153488226234913, flat: 4.025574713945389, pod: 53.10136526823044, loss: 64.28042805194855 
Train [6/6] | Epoch [49/120] |	nca: 7.196860782802105, flat: 4.17829480022192, pod: 55.478464901447296, loss: 66.8536206483841 
Train [6/6] | Epoch [50/120] |	nca: 6.529515817761421, flat: 4.106661066412926, pod: 53.336381912231445, loss: 63.97255849838257 
Train [6/6] | Epoch [51/120] |	nca: 5.563126429915428, flat: 3.6084954515099525, pod: 50.69750928878784, loss: 59.86913138628006 
Train [6/6] | Epoch [52/120] |	nca: 6.011375084519386, flat: 3.6762069165706635, pod: 50.228120267391205, loss: 59.91570210456848 
Train [6/6] | Epoch [53/120] |	nca: 6.9901106506586075, flat: 3.952148862183094, pod: 52.67877173423767, loss: 63.621031165122986 
Train [6/6] | Epoch [54/120] |	nca: 5.636249616742134, flat: 3.7137530371546745, pod: 50.69008320569992, loss: 60.04008603096008 
Train [6/6] | Epoch [55/120] |	nca: 9.298345141112804, flat: 4.689364165067673, pod: 58.28915113210678, loss: 72.27686035633087 
Train [6/6] | Epoch [56/120] |	nca: 6.604903399944305, flat: 3.9444509893655777, pod: 52.40346509218216, loss: 62.95281958580017 
Train [6/6] | Epoch [57/120] |	nca: 5.968456778675318, flat: 3.796889901161194, pod: 51.72438943386078, loss: 61.48973608016968 
Train [6/6] | Epoch [58/120] |	nca: 5.599749203771353, flat: 3.374426331371069, pod: 46.51448380947113, loss: 55.48865991830826 
Train [6/6] | Epoch [59/120] |	nca: 7.369751028716564, flat: 4.093303859233856, pod: 53.75692307949066, loss: 65.21997785568237 
Train [6/6] | Epoch [60/120] |	nca: 6.282329220324755, flat: 3.6175141222774982, pod: 49.9734063744545, loss: 59.873249650001526 
Train [6/6] | Epoch [61/120] |	nca: 5.221044186502695, flat: 3.3664606660604477, pod: 47.5264527797699, loss: 56.11395740509033 
Train [6/6] | Epoch [62/120] |	nca: 5.712342727929354, flat: 3.485949408262968, pod: 47.89082819223404, loss: 57.089120388031006 
Train [6/6] | Epoch [63/120] |	nca: 4.526802562177181, flat: 3.193265065550804, pod: 45.270190715789795, loss: 52.99025821685791 
Train [6/6] | Epoch [64/120] |	nca: 4.389498293399811, flat: 3.260739590972662, pod: 46.553543746471405, loss: 54.2037815451622 
Train [6/6] | Epoch [65/120] |	nca: 4.462310824543238, flat: 3.10651645809412, pod: 43.71359992027283, loss: 51.28242701292038 
Train [6/6] | Epoch [66/120] |	nca: 5.334351137280464, flat: 3.3064102828502655, pod: 45.17912644147873, loss: 53.81988829374313 
Train [6/6] | Epoch [67/120] |	nca: 6.30421407520771, flat: 4.060755874961615, pod: 49.84670662879944, loss: 60.21167701482773 
Train [6/6] | Epoch [68/120] |	nca: 4.320490408688784, flat: 3.26308860629797, pod: 45.43626940250397, loss: 53.019848346710205 
Train [6/6] | Epoch [69/120] |	nca: 4.191836208105087, flat: 2.9664016738533974, pod: 42.96943074464798, loss: 50.12766867876053 
Train [6/6] | Epoch [70/120] |	nca: 4.625080406665802, flat: 3.172573521733284, pod: 44.13045912981033, loss: 51.92811334133148 
Train [6/6] | Epoch [71/120] |	nca: 4.076679486781359, flat: 2.9755381233990192, pod: 43.02309972047806, loss: 50.075317442417145 
Train [6/6] | Epoch [72/120] |	nca: 4.642027240246534, flat: 3.0101397298276424, pod: 42.898518204689026, loss: 50.55068510770798 
Train [6/6] | Epoch [73/120] |	nca: 4.070923738181591, flat: 2.8934419378638268, pod: 41.86687982082367, loss: 48.831245601177216 
Train [6/6] | Epoch [74/120] |	nca: 3.8915885500609875, flat: 2.84938907250762, pod: 40.61692029237747, loss: 47.35789781808853 
Train [6/6] | Epoch [75/120] |	nca: 3.5361242201179266, flat: 2.9747894667088985, pod: 43.29600530862808, loss: 49.80691921710968 
Train [6/6] | Epoch [76/120] |	nca: 3.937657456845045, flat: 2.812698468565941, pod: 40.77236223220825, loss: 47.52271819114685 
Train [6/6] | Epoch [77/120] |	nca: 3.469374667853117, flat: 2.7567109391093254, pod: 39.755938947200775, loss: 45.98202466964722 
Train [6/6] | Epoch [78/120] |	nca: 3.769222144037485, flat: 2.593213949352503, pod: 37.90271270275116, loss: 44.26514881849289 
Train [6/6] | Epoch [79/120] |	nca: 3.4884557258337736, flat: 2.6622399501502514, pod: 39.40399479866028, loss: 45.554690301418304 
Train [6/6] | Epoch [80/120] |	nca: 3.317154858261347, flat: 2.585672751069069, pod: 38.11882698535919, loss: 44.02165478467941 
Train [6/6] | Epoch [81/120] |	nca: 4.046072922646999, flat: 2.6340313367545605, pod: 38.128532111644745, loss: 44.80863642692566 
Train [6/6] | Epoch [82/120] |	nca: 3.9886930752545595, flat: 2.6346778608858585, pod: 38.13325595855713, loss: 44.75662696361542 
Train [6/6] | Epoch [83/120] |	nca: 4.023138143122196, flat: 2.636854249984026, pod: 37.59117132425308, loss: 44.25116389989853 
Train [6/6] | Epoch [84/120] |	nca: 3.296651590615511, flat: 2.5555993244051933, pod: 37.26029026508331, loss: 43.112541019916534 
Train [6/6] | Epoch [85/120] |	nca: 3.079651977866888, flat: 2.389246132224798, pod: 35.30899351835251, loss: 40.777891755104065 
Train [6/6] | Epoch [86/120] |	nca: 3.409144528210163, flat: 2.5874525532126427, pod: 37.03454625606537, loss: 43.03114324808121 
Train [6/6] | Epoch [87/120] |	nca: 3.237200751900673, flat: 2.4440727941691875, pod: 35.365946531295776, loss: 41.04721987247467 
Train [6/6] | Epoch [88/120] |	nca: 2.9652892984449863, flat: 2.3248087130486965, pod: 34.920892000198364, loss: 40.21098989248276 
Train [6/6] | Epoch [89/120] |	nca: 2.7184187844395638, flat: 2.176057644188404, pod: 32.66254049539566, loss: 37.55701678991318 
Train [6/6] | Epoch [90/120] |	nca: 2.503414196893573, flat: 2.291718363761902, pod: 33.9402135014534, loss: 38.73534619808197 
Train [6/6] | Epoch [91/120] |	nca: 2.9002689570188522, flat: 2.333144448697567, pod: 33.93152615427971, loss: 39.16493946313858 
Train [6/6] | Epoch [92/120] |	nca: 2.7984947115182877, flat: 2.206292286515236, pod: 32.43620041012764, loss: 37.4409875869751 
Train [6/6] | Epoch [93/120] |	nca: 2.8101252615451813, flat: 2.2428531125187874, pod: 33.80070140957832, loss: 38.85367971658707 
Train [6/6] | Epoch [94/120] |	nca: 2.5021785087883472, flat: 2.24910756573081, pod: 33.90767705440521, loss: 38.658963203430176 
Train [6/6] | Epoch [95/120] |	nca: 2.4893506076186895, flat: 2.0645146872848272, pod: 31.300591349601746, loss: 35.85445708036423 
Train [6/6] | Epoch [96/120] |	nca: 2.5622590836137533, flat: 2.0590822715312243, pod: 30.364312201738358, loss: 34.985653668642044 
Train [6/6] | Epoch [97/120] |	nca: 2.7017932906746864, flat: 2.2028014939278364, pod: 32.131597489118576, loss: 37.03619235754013 
Train [6/6] | Epoch [98/120] |	nca: 2.681282799690962, flat: 2.0838368460536003, pod: 31.459188491106033, loss: 36.224308013916016 
Train [6/6] | Epoch [99/120] |	nca: 3.29187167622149, flat: 2.109952360391617, pod: 30.601841777563095, loss: 36.003665775060654 
Train [6/6] | Epoch [100/120] |	nca: 2.33861611969769, flat: 2.0805695094168186, pod: 30.580901324748993, loss: 35.00008684396744 
Train [6/6] | Epoch [101/120] |	nca: 2.604892548173666, flat: 1.9423953909426928, pod: 28.77978253364563, loss: 33.32707041501999 
Train [6/6] | Epoch [102/120] |	nca: 2.3359556943178177, flat: 2.0501505341380835, pod: 29.604068785905838, loss: 33.99017491936684 
Train [6/6] | Epoch [103/120] |	nca: 2.780945571139455, flat: 1.9948291070759296, pod: 29.98283678293228, loss: 34.758611261844635 
Train [6/6] | Epoch [104/120] |	nca: 2.3761119544506073, flat: 1.9298420045524836, pod: 27.77914336323738, loss: 32.08509749174118 
Train [6/6] | Epoch [105/120] |	nca: 2.308962667360902, flat: 1.9565556161105633, pod: 28.064773499965668, loss: 32.330291867256165 
Train [6/6] | Epoch [106/120] |	nca: 2.668254869058728, flat: 2.130197862163186, pod: 30.058210521936417, loss: 34.856663554906845 
Train [6/6] | Epoch [107/120] |	nca: 2.350365011021495, flat: 1.9309255760163069, pod: 27.450271546840668, loss: 31.73156225681305 
Train [6/6] | Epoch [108/120] |	nca: 2.261280318722129, flat: 1.815331568941474, pod: 26.748156517744064, loss: 30.82476842403412 
Train [6/6] | Epoch [109/120] |	nca: 2.150613494217396, flat: 1.7888856530189514, pod: 26.468118995428085, loss: 30.407618194818497 
Train [6/6] | Epoch [110/120] |	nca: 2.1580712851136923, flat: 1.8541381042450666, pod: 27.42575216293335, loss: 31.43796119093895 
Train [6/6] | Epoch [111/120] |	nca: 2.1726552676409483, flat: 1.8260164130479097, pod: 26.40007174015045, loss: 30.398743480443954 
Train [6/6] | Epoch [112/120] |	nca: 2.338738266378641, flat: 1.8394659217447042, pod: 27.318962931632996, loss: 31.49716705083847 
Train [6/6] | Epoch [113/120] |	nca: 2.2197216749191284, flat: 1.8245474249124527, pod: 26.174501925706863, loss: 30.21877110004425 
Train [6/6] | Epoch [114/120] |	nca: 2.290002103894949, flat: 1.8260895051062107, pod: 26.79719629883766, loss: 30.91328790783882 
Train [6/6] | Epoch [115/120] |	nca: 2.0595727376639843, flat: 1.7662126254290342, pod: 25.48151007294655, loss: 29.307295352220535 
Train [6/6] | Epoch [116/120] |	nca: 2.2944071013480425, flat: 1.7875502035021782, pod: 26.256806522607803, loss: 30.338763624429703 
Train [6/6] | Epoch [117/120] |	nca: 2.158490940928459, flat: 1.7181334923952818, pod: 24.685622066259384, loss: 28.56224638223648 
Train [6/6] | Epoch [118/120] |	nca: 2.4013629723340273, flat: 1.7404132839292288, pod: 25.141464561223984, loss: 29.28324082493782 
Train [6/6] | Epoch [119/120] |	nca: 2.093242958188057, flat: 1.8706653714179993, pod: 27.10744634270668, loss: 31.071354806423187 
Train [6/6] | Epoch [120/120] |	nca: 2.1654693633317947, flat: 1.847255565226078, pod: 26.759805917739868, loss: 30.772530734539032 
Fine-tuning
Building & updating memory.
Train [6/6] | Epoch [121/140] |	nca: 6.219404026865959, flat: 1.4898832589387894, pod: 18.689982175827026, loss: 26.399269342422485 
Train [6/6] | Epoch [122/140] |	nca: 2.034608669579029, flat: 1.5742518231272697, pod: 18.92870157957077, loss: 22.537562012672424 
Train [6/6] | Epoch [123/140] |	nca: 1.4712056890130043, flat: 1.5186215788125992, pod: 18.868669867515564, loss: 21.858497381210327 
Train [6/6] | Epoch [124/140] |	nca: 1.515625037252903, flat: 1.5449665561318398, pod: 18.935637593269348, loss: 21.99622929096222 
Train [6/6] | Epoch [125/140] |	nca: 1.2670802734792233, flat: 1.510272778570652, pod: 18.696105241775513, loss: 21.473458170890808 
Train [6/6] | Epoch [126/140] |	nca: 1.2404773980379105, flat: 1.57005225867033, pod: 19.09602040052414, loss: 21.9065500497818 
Train [6/6] | Epoch [127/140] |	nca: 1.290131788700819, flat: 1.5526185259222984, pod: 18.916794002056122, loss: 21.759544372558594 
Train [6/6] | Epoch [128/140] |	nca: 1.2048222944140434, flat: 1.4899232238531113, pod: 18.732951641082764, loss: 21.42769694328308 
Train [6/6] | Epoch [129/140] |	nca: 1.222994789481163, flat: 1.5255686044692993, pod: 18.709637999534607, loss: 21.45820116996765 
Train [6/6] | Epoch [130/140] |	nca: 1.133616354316473, flat: 1.5387798622250557, pod: 18.926513612270355, loss: 21.598909735679626 
Train [6/6] | Epoch [131/140] |	nca: 1.1807804889976978, flat: 1.530172549188137, pod: 18.87501472234726, loss: 21.585967898368835 
Train [6/6] | Epoch [132/140] |	nca: 1.338464830070734, flat: 1.5750704631209373, pod: 18.94576907157898, loss: 21.859304189682007 
Train [6/6] | Epoch [133/140] |	nca: 1.2501910328865051, flat: 1.5565792992711067, pod: 18.944057881832123, loss: 21.75082814693451 
Train [6/6] | Epoch [134/140] |	nca: 1.1574442200362682, flat: 1.5532636567950249, pod: 19.023125171661377, loss: 21.733832955360413 
Train [6/6] | Epoch [135/140] |	nca: 1.2303261794149876, flat: 1.5453543215990067, pod: 19.014694213867188, loss: 21.790374755859375 
Train [6/6] | Epoch [136/140] |	nca: 1.106082797050476, flat: 1.4940673373639584, pod: 18.821714520454407, loss: 21.42186462879181 
Train [6/6] | Epoch [137/140] |	nca: 1.0378112941980362, flat: 1.5160790607333183, pod: 18.856972992420197, loss: 21.410863518714905 
Train [6/6] | Epoch [138/140] |	nca: 1.1316571831703186, flat: 1.5601056665182114, pod: 19.060159742832184, loss: 21.751922845840454 
Train [6/6] | Epoch [139/140] |	nca: 1.1653333827853203, flat: 1.549942821264267, pod: 19.03545093536377, loss: 21.75072705745697 
Train [6/6] | Epoch [140/140] |	nca: 1.154340885579586, flat: 1.525078408420086, pod: 18.78950160741806, loss: 21.468920707702637 
after task
Building & updating memory.
after task
Saving model at results\dev\podnet\202401\week_1\20240104_podnet_cnn_cifar10_5steps\net_0_task_5.pth.
Saving metadata at results\dev\podnet\202401\week_1\20240104_podnet_cnn_cifar10_5steps\meta_0_task_5.pkl.
Eval on 0->10.
eval task
podnet_cnn_cifar10_5steps
Avg inc acc: 0.8453333333333334.
Current acc: {'total': 0.761, '00-09': 0.761}.
Avg inc acc top5: 0.9956666666666667.
Current acc top5: {'total': 0.989}.
Forgetting: 0.10549999999999998.
Cord metric: 0.84.
Old accuracy: 0.74, mean: 0.81.
New accuracy: 0.93, mean: 0.92.
Average Incremental Accuracy: 0.8453333333333334.
Label was: podnet_cnn_cifar10_5steps
Results done on 1 seeds: avg: 84.53, last: 76.1, forgetting: 10.55
Individual results avg: [84.53]
Individual results last: [76.1]
Individual results forget: [10.55]
Command was D:/go_to_D/ML/Final/LibContinual/run_trainer.py
Time cost :  4797.317293167114
