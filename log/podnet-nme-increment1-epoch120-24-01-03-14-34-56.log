Label: podnet_nme_cifar10_xsteps
orders : None
{'model': 'podnet', 'convnet': 'rebuffi', 'dropout': 0.0, 'herding': None, 'memory_size': 2000, 'temperature': 1, 'fixed_memory': True, 'dataset': 'cifar10', 'increment': 1, 'batch_size': 128, 'workers': 0, 'threads': 1, 'validation': 0.0, 'random_classes': True, 'max_task': None, 'onehot': False, 'initial_increment': 5, 'sampler': None, 'data_path': '/data/douillard/', 'lr': 0.1, 'weight_decay': 0.0005, 'scheduling': 'cosine', 'lr_decay': 0.1, 'optimizer': 'sgd', 'epochs': 120, 'device': [0], 'label': 'podnet_nme_cifar10_xsteps', 'autolabel': False, 'seed': [1], 'seed_range': None, 'options': None, 'save_model': 'last', 'dump_predictions': False, 'logging': 'info', 'resume': None, 'resume_first': False, 'recompute_meta': False, 'no_benchmark': False, 'detect_anomaly': False, 'dummy': 1, 'includes': ['headers/dummy.yaml'], 'data_root': 'D:/data/douillard/cifar10/cifar10', 'save_path': '.', 'eval_type': 'nme', 'backbone': {'name': 'resnet18'}, 'classifier': {'name': 'PODNet'}, 'classifier_config': {'type': 'cosine', 'proxy_per_class': 10, 'distance': 'neg_stable_cosine_distance'}, 'postprocessor_config': {'type': 'learned_scaling', 'initial_value': 1.0}, 'pod_flat': {'scheduled_factor': 1.0}, 'pod_spatial': {'scheduled_factor': 3.0, 'collapse_channels': 'spatial'}, 'nca': {'margin': 0.6, 'scale': 1.0, 'exclude_pos_denominator': True}, 'groupwise_factors': {'old_weights': 0.0}, 'finetuning_config': {'sampling': 'undersampling', 'tuning': 'classifier', 'lr': 0.05, 'epochs': 20, 'scaling': None}, 'proxy_per_class': 1, 'weight_generation': {'type': 'imprinted', 'multi_class_diff': 'kmeans'}, 'dataset_transforms': {'color_jitter': True}}
Launching run 1/1
Set seed 1
CUDA algos are determinists but very slow!
Files already downloaded and verified
Files already downloaded and verified
Dataset iCIFAR10: class ordering: [6, 8, 9, 7, 5, 3, 0, 4, 1, 2].
Downsampling type stride
Using 10 proxies per class.
Model will be save at this rythm: last.
================Task 0 Start!================
Testing on False unseen tasks (max class = 5).
Before task
Now 200 examplars per class.
Group: convnet, lr: 0.1.
Group: postprocessing, lr: 0.1.
Group: new_weights, lr: 0.1.
================Task 0 Training!================
The training samples number: 25000
Train on 0->5.
train task
nb 25000.
Train [1/6] | Epoch [1/120] |	nca: 245.8408352136612, loss: 245.8408352136612 
Train [1/6] | Epoch [2/120] |	nca: 172.5943865776062, loss: 172.5943865776062 
Train [1/6] | Epoch [3/120] |	nca: 122.78007876873016, loss: 122.78007876873016 
Train [1/6] | Epoch [4/120] |	nca: 102.02858290076256, loss: 102.02858290076256 
Train [1/6] | Epoch [5/120] |	nca: 89.43182381987572, loss: 89.43182381987572 
Train [1/6] | Epoch [6/120] |	nca: 81.16078592836857, loss: 81.16078592836857 
Train [1/6] | Epoch [7/120] |	nca: 77.56302607059479, loss: 77.56302607059479 
Train [1/6] | Epoch [8/120] |	nca: 69.65983571112156, loss: 69.65983571112156 
Train [1/6] | Epoch [9/120] |	nca: 67.30038060247898, loss: 67.30038060247898 
Train [1/6] | Epoch [10/120] |	nca: 63.35206197202206, loss: 63.35206197202206 
Train [1/6] | Epoch [11/120] |	nca: 63.4706047475338, loss: 63.4706047475338 
Train [1/6] | Epoch [12/120] |	nca: 61.91594834625721, loss: 61.91594834625721 
Train [1/6] | Epoch [13/120] |	nca: 58.834900572896004, loss: 58.834900572896004 
Train [1/6] | Epoch [14/120] |	nca: 56.784416645765305, loss: 56.784416645765305 
Train [1/6] | Epoch [15/120] |	nca: 54.47796542942524, loss: 54.47796542942524 
Train [1/6] | Epoch [16/120] |	nca: 55.559927716851234, loss: 55.559927716851234 
Train [1/6] | Epoch [17/120] |	nca: 54.12913544476032, loss: 54.12913544476032 
Train [1/6] | Epoch [18/120] |	nca: 53.073642402887344, loss: 53.073642402887344 
Train [1/6] | Epoch [19/120] |	nca: 50.87010081857443, loss: 50.87010081857443 
Train [1/6] | Epoch [20/120] |	nca: 50.47608771920204, loss: 50.47608771920204 
Train [1/6] | Epoch [21/120] |	nca: 51.25454207509756, loss: 51.25454207509756 
Train [1/6] | Epoch [22/120] |	nca: 49.460700169205666, loss: 49.460700169205666 
Train [1/6] | Epoch [23/120] |	nca: 49.17236062884331, loss: 49.17236062884331 
Train [1/6] | Epoch [24/120] |	nca: 46.83349861949682, loss: 46.83349861949682 
Train [1/6] | Epoch [25/120] |	nca: 47.089063577353954, loss: 47.089063577353954 
Train [1/6] | Epoch [26/120] |	nca: 47.94596654176712, loss: 47.94596654176712 
Train [1/6] | Epoch [27/120] |	nca: 45.37578894942999, loss: 45.37578894942999 
Train [1/6] | Epoch [28/120] |	nca: 44.7356171682477, loss: 44.7356171682477 
Train [1/6] | Epoch [29/120] |	nca: 45.168326146900654, loss: 45.168326146900654 
Train [1/6] | Epoch [30/120] |	nca: 43.84719205647707, loss: 43.84719205647707 
Train [1/6] | Epoch [31/120] |	nca: 42.72599148750305, loss: 42.72599148750305 
Train [1/6] | Epoch [32/120] |	nca: 43.578373700380325, loss: 43.578373700380325 
Train [1/6] | Epoch [33/120] |	nca: 42.7602099403739, loss: 42.7602099403739 
Train [1/6] | Epoch [34/120] |	nca: 41.44649402052164, loss: 41.44649402052164 
Train [1/6] | Epoch [35/120] |	nca: 41.23208089917898, loss: 41.23208089917898 
Train [1/6] | Epoch [36/120] |	nca: 41.45045995339751, loss: 41.45045995339751 
Train [1/6] | Epoch [37/120] |	nca: 39.988542944192886, loss: 39.988542944192886 
Train [1/6] | Epoch [38/120] |	nca: 39.93265783786774, loss: 39.93265783786774 
Train [1/6] | Epoch [39/120] |	nca: 41.36157989501953, loss: 41.36157989501953 
Train [1/6] | Epoch [40/120] |	nca: 39.25457309931517, loss: 39.25457309931517 
Train [1/6] | Epoch [41/120] |	nca: 37.54802066087723, loss: 37.54802066087723 
Train [1/6] | Epoch [42/120] |	nca: 37.44420774281025, loss: 37.44420774281025 
Train [1/6] | Epoch [43/120] |	nca: 37.67340023070574, loss: 37.67340023070574 
Train [1/6] | Epoch [44/120] |	nca: 37.58645989745855, loss: 37.58645989745855 
Train [1/6] | Epoch [45/120] |	nca: 36.49546932429075, loss: 36.49546932429075 
Train [1/6] | Epoch [46/120] |	nca: 35.04204720258713, loss: 35.04204720258713 
Train [1/6] | Epoch [47/120] |	nca: 35.664037972688675, loss: 35.664037972688675 
Train [1/6] | Epoch [48/120] |	nca: 34.65353090316057, loss: 34.65353090316057 
Train [1/6] | Epoch [49/120] |	nca: 35.572185568511486, loss: 35.572185568511486 
Train [1/6] | Epoch [50/120] |	nca: 33.81679506227374, loss: 33.81679506227374 
Train [1/6] | Epoch [51/120] |	nca: 32.9052422195673, loss: 32.9052422195673 
Train [1/6] | Epoch [52/120] |	nca: 33.15567522868514, loss: 33.15567522868514 
Train [1/6] | Epoch [53/120] |	nca: 31.450403779745102, loss: 31.450403779745102 
Train [1/6] | Epoch [54/120] |	nca: 34.26010449975729, loss: 34.26010449975729 
Train [1/6] | Epoch [55/120] |	nca: 31.601949632167816, loss: 31.601949632167816 
Train [1/6] | Epoch [56/120] |	nca: 31.725672975182533, loss: 31.725672975182533 
Train [1/6] | Epoch [57/120] |	nca: 28.952415395528078, loss: 28.952415395528078 
Train [1/6] | Epoch [58/120] |	nca: 29.77424867451191, loss: 29.77424867451191 
Train [1/6] | Epoch [59/120] |	nca: 30.800806496292353, loss: 30.800806496292353 
Train [1/6] | Epoch [60/120] |	nca: 28.181162133812904, loss: 28.181162133812904 
Train [1/6] | Epoch [61/120] |	nca: 28.18985367566347, loss: 28.18985367566347 
Train [1/6] | Epoch [62/120] |	nca: 26.925289779901505, loss: 26.925289779901505 
Train [1/6] | Epoch [63/120] |	nca: 27.081361396238208, loss: 27.081361396238208 
Train [1/6] | Epoch [64/120] |	nca: 26.434019286185503, loss: 26.434019286185503 
Train [1/6] | Epoch [65/120] |	nca: 26.650334242731333, loss: 26.650334242731333 
Train [1/6] | Epoch [66/120] |	nca: 26.487534064799547, loss: 26.487534064799547 
Train [1/6] | Epoch [67/120] |	nca: 23.778376234695315, loss: 23.778376234695315 
Train [1/6] | Epoch [68/120] |	nca: 24.291168808937073, loss: 24.291168808937073 
Train [1/6] | Epoch [69/120] |	nca: 24.489956106990576, loss: 24.489956106990576 
Train [1/6] | Epoch [70/120] |	nca: 22.476315023377538, loss: 22.476315023377538 
Train [1/6] | Epoch [71/120] |	nca: 22.503997141495347, loss: 22.503997141495347 
Train [1/6] | Epoch [72/120] |	nca: 21.6598435100168, loss: 21.6598435100168 
Train [1/6] | Epoch [73/120] |	nca: 21.587385354563594, loss: 21.587385354563594 
Train [1/6] | Epoch [74/120] |	nca: 20.210880786180496, loss: 20.210880786180496 
Train [1/6] | Epoch [75/120] |	nca: 19.625069089233875, loss: 19.625069089233875 
Train [1/6] | Epoch [76/120] |	nca: 21.642834179103374, loss: 21.642834179103374 
Train [1/6] | Epoch [77/120] |	nca: 18.291334059089422, loss: 18.291334059089422 
Train [1/6] | Epoch [78/120] |	nca: 18.65569807961583, loss: 18.65569807961583 
Train [1/6] | Epoch [79/120] |	nca: 17.62219910696149, loss: 17.62219910696149 
Train [1/6] | Epoch [80/120] |	nca: 17.407912705093622, loss: 17.407912705093622 
Train [1/6] | Epoch [81/120] |	nca: 16.496454492211342, loss: 16.496454492211342 
Train [1/6] | Epoch [82/120] |	nca: 16.820061057806015, loss: 16.820061057806015 
Train [1/6] | Epoch [83/120] |	nca: 15.35195083450526, loss: 15.35195083450526 
Train [1/6] | Epoch [84/120] |	nca: 13.914684473536909, loss: 13.914684473536909 
Train [1/6] | Epoch [85/120] |	nca: 14.0109041351825, loss: 14.0109041351825 
Train [1/6] | Epoch [86/120] |	nca: 12.465625306591392, loss: 12.465625306591392 
Train [1/6] | Epoch [87/120] |	nca: 12.355045438744128, loss: 12.355045438744128 
Train [1/6] | Epoch [88/120] |	nca: 11.348202416673303, loss: 11.348202416673303 
Train [1/6] | Epoch [89/120] |	nca: 11.009868800640106, loss: 11.009868800640106 
Train [1/6] | Epoch [90/120] |	nca: 10.398885025642812, loss: 10.398885025642812 
Train [1/6] | Epoch [91/120] |	nca: 11.372860364150256, loss: 11.372860364150256 
Train [1/6] | Epoch [92/120] |	nca: 9.965923971962184, loss: 9.965923971962184 
Train [1/6] | Epoch [93/120] |	nca: 8.111091959290206, loss: 8.111091959290206 
Train [1/6] | Epoch [94/120] |	nca: 7.646015346981585, loss: 7.646015346981585 
Train [1/6] | Epoch [95/120] |	nca: 6.757473370293155, loss: 6.757473370293155 
Train [1/6] | Epoch [96/120] |	nca: 6.746314025949687, loss: 6.746314025949687 
Train [1/6] | Epoch [97/120] |	nca: 5.69044786458835, loss: 5.69044786458835 
Train [1/6] | Epoch [98/120] |	nca: 5.551049451343715, loss: 5.551049451343715 
Train [1/6] | Epoch [99/120] |	nca: 4.650478226249106, loss: 4.650478226249106 
Train [1/6] | Epoch [100/120] |	nca: 4.592842740938067, loss: 4.592842740938067 
Train [1/6] | Epoch [101/120] |	nca: 3.962735577719286, loss: 3.962735577719286 
Train [1/6] | Epoch [102/120] |	nca: 3.7106836666353047, loss: 3.7106836666353047 
Train [1/6] | Epoch [103/120] |	nca: 3.0817868828307837, loss: 3.0817868828307837 
Train [1/6] | Epoch [104/120] |	nca: 2.8189788802992553, loss: 2.8189788802992553 
Train [1/6] | Epoch [105/120] |	nca: 2.195655744872056, loss: 2.195655744872056 
Train [1/6] | Epoch [106/120] |	nca: 1.8336870921775699, loss: 1.8336870921775699 
Train [1/6] | Epoch [107/120] |	nca: 1.8560217798221856, loss: 1.8560217798221856 
Train [1/6] | Epoch [108/120] |	nca: 1.4504967533284798, loss: 1.4504967533284798 
Train [1/6] | Epoch [109/120] |	nca: 1.6059455482754856, loss: 1.6059455482754856 
Train [1/6] | Epoch [110/120] |	nca: 1.335516064427793, loss: 1.335516064427793 
Train [1/6] | Epoch [111/120] |	nca: 1.2380568476510234, loss: 1.2380568476510234 
Train [1/6] | Epoch [112/120] |	nca: 1.103980946354568, loss: 1.103980946354568 
Train [1/6] | Epoch [113/120] |	nca: 1.1307565013412386, loss: 1.1307565013412386 
Train [1/6] | Epoch [114/120] |	nca: 1.3132521962979808, loss: 1.3132521962979808 
Train [1/6] | Epoch [115/120] |	nca: 0.8999430210096762, loss: 0.8999430210096762 
Train [1/6] | Epoch [116/120] |	nca: 0.9052222461323254, loss: 0.9052222461323254 
Train [1/6] | Epoch [117/120] |	nca: 0.9571318146772683, loss: 0.9571318146772683 
Train [1/6] | Epoch [118/120] |	nca: 1.060318163363263, loss: 1.060318163363263 
Train [1/6] | Epoch [119/120] |	nca: 0.9505865636165254, loss: 0.9505865636165254 
Train [1/6] | Epoch [120/120] |	nca: 0.9351504602236673, loss: 0.9351504602236673 
after task
Building & updating memory.
after task
Eval on 0->5.
eval task
podnet_nme_cifar10_xsteps
Avg inc acc: 0.971.
Current acc: {'total': 0.971, '00-09': 0.971}.
Avg inc acc top5: 1.0.
Current acc top5: {'total': 1.0}.
Forgetting: 0.0.
Cord metric: 0.97.
================Task 1 Start!================
Testing on False unseen tasks (max class = 6).
Set memory of size: 1000.
Before task
Generating imprinted weights
Multi class diff kmeans.
Now 200 examplars per class.
Group: convnet, lr: 0.1.
Group: postprocessing, lr: 0.1.
Group: new_weights, lr: 0.1.
================Task 1 Training!================
The training samples number: 6000
Train on 5->6.
train task
nb 6000.
Train [2/6] | Epoch [1/120] |	nca: 36.036932200193405, flat: 46.49404442310333, pod: 169.93315887451172, loss: 252.46413469314575 
Train [2/6] | Epoch [2/120] |	nca: 19.71490342915058, flat: 29.598628342151642, pod: 126.74935579299927, loss: 176.06288814544678 
Train [2/6] | Epoch [3/120] |	nca: 17.184194415807724, flat: 25.099894732236862, pod: 112.29725098609924, loss: 154.58134031295776 
Train [2/6] | Epoch [4/120] |	nca: 14.949930593371391, flat: 21.30602240562439, pod: 97.92110216617584, loss: 134.17705488204956 
Train [2/6] | Epoch [5/120] |	nca: 13.405499666929245, flat: 20.065954625606537, pod: 91.80521857738495, loss: 125.27667307853699 
Train [2/6] | Epoch [6/120] |	nca: 12.946653455495834, flat: 19.701506853103638, pod: 90.0351049900055, loss: 122.68326592445374 
Train [2/6] | Epoch [7/120] |	nca: 11.633735239505768, flat: 18.76399925351143, pod: 83.91302728652954, loss: 114.31076192855835 
Train [2/6] | Epoch [8/120] |	nca: 11.09476813673973, flat: 17.79429081082344, pod: 80.47980725765228, loss: 109.3688657283783 
Train [2/6] | Epoch [9/120] |	nca: 10.560048773884773, flat: 17.308883845806122, pod: 76.87030220031738, loss: 104.7392349243164 
Train [2/6] | Epoch [10/120] |	nca: 11.234841302037239, flat: 17.779983162879944, pod: 79.01364457607269, loss: 108.02847051620483 
Train [2/6] | Epoch [11/120] |	nca: 10.321047112345695, flat: 17.24111121892929, pod: 74.96558713912964, loss: 102.52774572372437 
Train [2/6] | Epoch [12/120] |	nca: 9.807741202414036, flat: 16.65173977613449, pod: 73.23141062259674, loss: 99.69089138507843 
Train [2/6] | Epoch [13/120] |	nca: 10.148506380617619, flat: 16.36564862728119, pod: 71.81366634368896, loss: 98.32782113552094 
Train [2/6] | Epoch [14/120] |	nca: 9.684042237699032, flat: 16.50921443104744, pod: 71.54706799983978, loss: 97.74032497406006 
Train [2/6] | Epoch [15/120] |	nca: 9.134049281477928, flat: 15.792665302753448, pod: 68.65365433692932, loss: 93.58036887645721 
Train [2/6] | Epoch [16/120] |	nca: 8.823346316814423, flat: 16.313655853271484, pod: 70.13824427127838, loss: 95.2752468585968 
Train [2/6] | Epoch [17/120] |	nca: 9.111546784639359, flat: 16.14125007390976, pod: 69.97737777233124, loss: 95.23017513751984 
Train [2/6] | Epoch [18/120] |	nca: 9.258047856390476, flat: 16.320927500724792, pod: 71.64124572277069, loss: 97.22022128105164 
Train [2/6] | Epoch [19/120] |	nca: 8.660882636904716, flat: 16.141424596309662, pod: 69.19485259056091, loss: 93.99716007709503 
Train [2/6] | Epoch [20/120] |	nca: 8.625946454703808, flat: 15.637211292982101, pod: 66.53811156749725, loss: 90.80126941204071 
Train [2/6] | Epoch [21/120] |	nca: 8.301237538456917, flat: 15.380315661430359, pod: 64.28896045684814, loss: 87.97051405906677 
Train [2/6] | Epoch [22/120] |	nca: 8.25562409311533, flat: 15.392850756645203, pod: 65.87905061244965, loss: 89.52752530574799 
Train [2/6] | Epoch [23/120] |	nca: 7.830357760190964, flat: 15.28149950504303, pod: 64.65428626537323, loss: 87.76614344120026 
Train [2/6] | Epoch [24/120] |	nca: 8.428363241255283, flat: 15.127957880496979, pod: 63.53551363945007, loss: 87.09183478355408 
Train [2/6] | Epoch [25/120] |	nca: 7.699708558619022, flat: 14.942022770643234, pod: 62.348400473594666, loss: 84.99013209342957 
Train [2/6] | Epoch [26/120] |	nca: 8.140009179711342, flat: 14.734708279371262, pod: 62.45031034946442, loss: 85.3250275850296 
Train [2/6] | Epoch [27/120] |	nca: 8.083030350506306, flat: 15.464006558060646, pod: 63.60646915435791, loss: 87.15350592136383 
Train [2/6] | Epoch [28/120] |	nca: 8.193656735122204, flat: 15.414334833621979, pod: 66.36002504825592, loss: 89.96801686286926 
Train [2/6] | Epoch [29/120] |	nca: 8.708227127790451, flat: 15.4319708943367, pod: 66.40477979183197, loss: 90.5449777841568 
Train [2/6] | Epoch [30/120] |	nca: 7.476243995130062, flat: 15.344554215669632, pod: 64.87538349628448, loss: 87.69618201255798 
Train [2/6] | Epoch [31/120] |	nca: 7.815897434949875, flat: 14.742072492837906, pod: 61.453832149505615, loss: 84.01180160045624 
Train [2/6] | Epoch [32/120] |	nca: 7.487516924738884, flat: 14.585409611463547, pod: 60.10767436027527, loss: 82.18060100078583 
Train [2/6] | Epoch [33/120] |	nca: 7.087324351072311, flat: 14.430111527442932, pod: 59.05323123931885, loss: 80.57066738605499 
Train [2/6] | Epoch [34/120] |	nca: 7.072317540645599, flat: 14.266729712486267, pod: 58.91994261741638, loss: 80.25899016857147 
Train [2/6] | Epoch [35/120] |	nca: 7.94839783012867, flat: 15.034039318561554, pod: 61.353148221969604, loss: 84.33558642864227 
Train [2/6] | Epoch [36/120] |	nca: 7.762576833367348, flat: 15.007922887802124, pod: 62.763856410980225, loss: 85.53435587882996 
Train [2/6] | Epoch [37/120] |	nca: 7.361996442079544, flat: 14.296074479818344, pod: 58.570836663246155, loss: 80.2289080619812 
Train [2/6] | Epoch [38/120] |	nca: 6.9121066480875015, flat: 14.572527080774307, pod: 58.84210276603699, loss: 80.32673621177673 
Train [2/6] | Epoch [39/120] |	nca: 7.481284685432911, flat: 14.381019070744514, pod: 59.81031620502472, loss: 81.6726199388504 
Train [2/6] | Epoch [40/120] |	nca: 6.569530114531517, flat: 14.026404067873955, pod: 58.00602054595947, loss: 78.60195481777191 
Train [2/6] | Epoch [41/120] |	nca: 6.797905147075653, flat: 14.038006246089935, pod: 58.24380719661713, loss: 79.07971823215485 
Train [2/6] | Epoch [42/120] |	nca: 7.286017060279846, flat: 14.28937415778637, pod: 59.6922482252121, loss: 81.26763939857483 
Train [2/6] | Epoch [43/120] |	nca: 6.971805177628994, flat: 14.25434273481369, pod: 58.77847695350647, loss: 80.00462460517883 
Train [2/6] | Epoch [44/120] |	nca: 6.475755877792835, flat: 13.807135418057442, pod: 56.67687177658081, loss: 76.95976281166077 
Train [2/6] | Epoch [45/120] |	nca: 6.496005829423666, flat: 13.63278841972351, pod: 55.16995966434479, loss: 75.29875409603119 
Train [2/6] | Epoch [46/120] |	nca: 6.3653968796133995, flat: 13.72427299618721, pod: 56.7756632566452, loss: 76.86533296108246 
Train [2/6] | Epoch [47/120] |	nca: 6.433827202767134, flat: 13.622837781906128, pod: 56.135889768600464, loss: 76.19255471229553 
Train [2/6] | Epoch [48/120] |	nca: 6.3287356942892075, flat: 13.756865456700325, pod: 56.36094295978546, loss: 76.44654452800751 
Train [2/6] | Epoch [49/120] |	nca: 6.361703835427761, flat: 14.008962631225586, pod: 55.791709661483765, loss: 76.1623764038086 
Train [2/6] | Epoch [50/120] |	nca: 6.681696072220802, flat: 14.240638494491577, pod: 57.835050106048584, loss: 78.75738453865051 
Train [2/6] | Epoch [51/120] |	nca: 6.423515021800995, flat: 14.05188350379467, pod: 56.31700026988983, loss: 76.79239869117737 
Train [2/6] | Epoch [52/120] |	nca: 5.813162364065647, flat: 13.40942931175232, pod: 55.7130241394043, loss: 74.93561565876007 
Train [2/6] | Epoch [53/120] |	nca: 5.774299651384354, flat: 13.098223716020584, pod: 52.454933524131775, loss: 71.32745707035065 
Train [2/6] | Epoch [54/120] |	nca: 5.964489214122295, flat: 13.307627156376839, pod: 53.845299243927, loss: 73.11741578578949 
Train [2/6] | Epoch [55/120] |	nca: 6.307195454835892, flat: 13.151798710227013, pod: 51.65611147880554, loss: 71.11510598659515 
Train [2/6] | Epoch [56/120] |	nca: 6.040079668164253, flat: 13.410757765173912, pod: 54.332692980766296, loss: 73.78353023529053 
Train [2/6] | Epoch [57/120] |	nca: 6.204346016049385, flat: 13.271474286913872, pod: 52.54696178436279, loss: 72.02278184890747 
Train [2/6] | Epoch [58/120] |	nca: 5.869217902421951, flat: 13.20236288011074, pod: 51.726368725299835, loss: 70.7979496717453 
Train [2/6] | Epoch [59/120] |	nca: 6.002069942653179, flat: 13.372703418135643, pod: 52.866249561309814, loss: 72.24102294445038 
Train [2/6] | Epoch [60/120] |	nca: 5.79682681709528, flat: 13.01997534930706, pod: 51.341606855392456, loss: 70.15840899944305 
Train [2/6] | Epoch [61/120] |	nca: 5.7734367698431015, flat: 12.93267148733139, pod: 48.929739117622375, loss: 67.6358470916748 
Train [2/6] | Epoch [62/120] |	nca: 6.4154342263937, flat: 13.356610298156738, pod: 52.30027508735657, loss: 72.07231986522675 
Train [2/6] | Epoch [63/120] |	nca: 5.407659634947777, flat: 12.923286810517311, pod: 49.89122587442398, loss: 68.22217202186584 
Train [2/6] | Epoch [64/120] |	nca: 5.247726250439882, flat: 12.506308853626251, pod: 48.73182839155197, loss: 66.48586285114288 
Train [2/6] | Epoch [65/120] |	nca: 5.230219446122646, flat: 12.609747752547264, pod: 48.65164637565613, loss: 66.49161350727081 
Train [2/6] | Epoch [66/120] |	nca: 5.058278877288103, flat: 12.645833283662796, pod: 48.72232151031494, loss: 66.42643344402313 
Train [2/6] | Epoch [67/120] |	nca: 5.910897012799978, flat: 12.875484108924866, pod: 49.85178279876709, loss: 68.6381641626358 
Train [2/6] | Epoch [68/120] |	nca: 5.27766877412796, flat: 12.437454789876938, pod: 46.78013229370117, loss: 64.4952563047409 
Train [2/6] | Epoch [69/120] |	nca: 5.171040195971727, flat: 12.640865162014961, pod: 48.445099234580994, loss: 66.25700414180756 
Train [2/6] | Epoch [70/120] |	nca: 5.07686635106802, flat: 12.51571150124073, pod: 47.4939239025116, loss: 65.08650183677673 
Train [2/6] | Epoch [71/120] |	nca: 4.85087775439024, flat: 12.42985711991787, pod: 46.18124932050705, loss: 63.461984515190125 
Train [2/6] | Epoch [72/120] |	nca: 4.485585518181324, flat: 12.021939754486084, pod: 45.04179644584656, loss: 61.54932177066803 
Train [2/6] | Epoch [73/120] |	nca: 5.511756755411625, flat: 12.50824174284935, pod: 46.70435619354248, loss: 64.72435450553894 
Train [2/6] | Epoch [74/120] |	nca: 4.913368798792362, flat: 12.282407939434052, pod: 46.72504371404648, loss: 63.920820236206055 
Train [2/6] | Epoch [75/120] |	nca: 5.278736501932144, flat: 12.390156030654907, pod: 45.85369396209717, loss: 63.52258622646332 
Train [2/6] | Epoch [76/120] |	nca: 4.871056202799082, flat: 12.297615095973015, pod: 46.50106155872345, loss: 63.66973280906677 
Train [2/6] | Epoch [77/120] |	nca: 4.887054607272148, flat: 11.98491607606411, pod: 43.2414608001709, loss: 60.113431453704834 
Train [2/6] | Epoch [78/120] |	nca: 4.448175262659788, flat: 11.838774979114532, pod: 43.0736683011055, loss: 59.360618352890015 
Train [2/6] | Epoch [79/120] |	nca: 4.0768335945904255, flat: 12.05812107026577, pod: 43.14630687236786, loss: 59.281261563301086 
Train [2/6] | Epoch [80/120] |	nca: 4.280009992420673, flat: 11.867314904928207, pod: 42.61241924762726, loss: 58.75974464416504 
Train [2/6] | Epoch [81/120] |	nca: 4.3650344498455524, flat: 11.812729597091675, pod: 41.93432682752609, loss: 58.112091064453125 
Train [2/6] | Epoch [82/120] |	nca: 4.375375088304281, flat: 11.876315638422966, pod: 41.83602690696716, loss: 58.08771729469299 
Train [2/6] | Epoch [83/120] |	nca: 4.559600822627544, flat: 11.878491699695587, pod: 41.165913581848145, loss: 57.60400629043579 
Train [2/6] | Epoch [84/120] |	nca: 4.139578856527805, flat: 11.69070152938366, pod: 39.687530279159546, loss: 55.5178108215332 
Train [2/6] | Epoch [85/120] |	nca: 4.156785540282726, flat: 11.485016331076622, pod: 40.20983552932739, loss: 55.85163736343384 
Train [2/6] | Epoch [86/120] |	nca: 3.963594973087311, flat: 11.367360904812813, pod: 38.75602585077286, loss: 54.08698225021362 
Train [2/6] | Epoch [87/120] |	nca: 4.157356269657612, flat: 11.632092952728271, pod: 39.730937123298645, loss: 55.52038633823395 
Train [2/6] | Epoch [88/120] |	nca: 4.275192771106958, flat: 11.419434696435928, pod: 39.65738308429718, loss: 55.35201060771942 
Train [2/6] | Epoch [89/120] |	nca: 4.283444620668888, flat: 11.51279766857624, pod: 38.97892338037491, loss: 54.77516543865204 
Train [2/6] | Epoch [90/120] |	nca: 3.9032980017364025, flat: 11.150215700268745, pod: 37.46872365474701, loss: 52.52223765850067 
Train [2/6] | Epoch [91/120] |	nca: 4.079977162182331, flat: 11.129818394780159, pod: 36.97320467233658, loss: 52.183000564575195 
Train [2/6] | Epoch [92/120] |	nca: 4.09644328802824, flat: 11.160286232829094, pod: 36.964761197566986, loss: 52.221491038799286 
Train [2/6] | Epoch [93/120] |	nca: 4.053047604858875, flat: 11.292831465601921, pod: 37.73415958881378, loss: 53.08003854751587 
Train [2/6] | Epoch [94/120] |	nca: 3.5603704676032066, flat: 11.014654904603958, pod: 35.46994012594223, loss: 50.04496544599533 
Train [2/6] | Epoch [95/120] |	nca: 3.9120654687285423, flat: 11.101402997970581, pod: 35.28120481967926, loss: 50.294673442840576 
Train [2/6] | Epoch [96/120] |	nca: 3.824141949415207, flat: 10.918971210718155, pod: 35.495160698890686, loss: 50.23827350139618 
Train [2/6] | Epoch [97/120] |	nca: 3.57697182521224, flat: 11.026321694254875, pod: 35.22960406541824, loss: 49.832897305488586 
Train [2/6] | Epoch [98/120] |	nca: 3.582407232373953, flat: 10.8906729221344, pod: 34.839826345443726, loss: 49.31290662288666 
Train [2/6] | Epoch [99/120] |	nca: 3.4850781224668026, flat: 10.910946011543274, pod: 34.56411391496658, loss: 48.96013790369034 
Train [2/6] | Epoch [100/120] |	nca: 3.5917156040668488, flat: 10.806769609451294, pod: 33.889881014823914, loss: 48.2883665561676 
Train [2/6] | Epoch [101/120] |	nca: 3.615582674741745, flat: 10.880047872662544, pod: 33.92788815498352, loss: 48.42351847887039 
Train [2/6] | Epoch [102/120] |	nca: 3.57410641759634, flat: 11.004362791776657, pod: 33.646594524383545, loss: 48.22506386041641 
Train [2/6] | Epoch [103/120] |	nca: 3.5350885950028896, flat: 10.81616324186325, pod: 34.20761775970459, loss: 48.5588698387146 
Train [2/6] | Epoch [104/120] |	nca: 3.416956938803196, flat: 10.663985624909401, pod: 32.65678679943085, loss: 46.7377290725708 
Train [2/6] | Epoch [105/120] |	nca: 3.386523723602295, flat: 10.502973273396492, pod: 32.68620681762695, loss: 46.575703859329224 
Train [2/6] | Epoch [106/120] |	nca: 3.5834458358585835, flat: 10.633624151349068, pod: 32.8901327252388, loss: 47.107202768325806 
Train [2/6] | Epoch [107/120] |	nca: 3.0585717633366585, flat: 10.86187931895256, pod: 32.3487828373909, loss: 46.26923382282257 
Train [2/6] | Epoch [108/120] |	nca: 3.387466659769416, flat: 10.686465829610825, pod: 32.24833971261978, loss: 46.322271943092346 
Train [2/6] | Epoch [109/120] |	nca: 3.3029509969055653, flat: 10.640750125050545, pod: 32.110926151275635, loss: 46.05462688207626 
Train [2/6] | Epoch [110/120] |	nca: 3.2860421761870384, flat: 10.50654648244381, pod: 31.823796331882477, loss: 45.616384625434875 
Train [2/6] | Epoch [111/120] |	nca: 3.207043696194887, flat: 10.52660208940506, pod: 31.810669422149658, loss: 45.54431539773941 
Train [2/6] | Epoch [112/120] |	nca: 3.054684678092599, flat: 10.63389453291893, pod: 30.930230259895325, loss: 44.61880958080292 
Train [2/6] | Epoch [113/120] |	nca: 3.204455003142357, flat: 10.422354444861412, pod: 31.192546904087067, loss: 44.819356203079224 
Train [2/6] | Epoch [114/120] |	nca: 3.061245135962963, flat: 10.449897140264511, pod: 31.041067123413086, loss: 44.55220967531204 
Train [2/6] | Epoch [115/120] |	nca: 3.2314552888274193, flat: 10.66662847995758, pod: 31.430612981319427, loss: 45.328696608543396 
Train [2/6] | Epoch [116/120] |	nca: 3.0539452359080315, flat: 10.431161642074585, pod: 31.491935074329376, loss: 44.97704207897186 
Train [2/6] | Epoch [117/120] |	nca: 3.2286485508084297, flat: 10.594291284680367, pod: 30.79792892932892, loss: 44.62086880207062 
Train [2/6] | Epoch [118/120] |	nca: 3.051178753376007, flat: 10.398249015212059, pod: 30.581245720386505, loss: 44.03067356348038 
Train [2/6] | Epoch [119/120] |	nca: 3.2550075352191925, flat: 10.488012433052063, pod: 31.001459062099457, loss: 44.74447911977768 
Train [2/6] | Epoch [120/120] |	nca: 3.188426174223423, flat: 10.373311176896095, pod: 30.543237686157227, loss: 44.10497498512268 
Fine-tuning
Building & updating memory.
Train [2/6] | Epoch [121/140] |	nca: 3.2254074960947037, flat: 4.737391263246536, pod: 14.869379758834839, loss: 22.832178354263306 
Train [2/6] | Epoch [122/140] |	nca: 1.9146906286478043, flat: 4.615540385246277, pod: 14.764368295669556, loss: 21.294599175453186 
Train [2/6] | Epoch [123/140] |	nca: 1.4939749166369438, flat: 4.7160647213459015, pod: 15.054439544677734, loss: 21.264479637145996 
Train [2/6] | Epoch [124/140] |	nca: 1.5042011514306068, flat: 4.874040335416794, pod: 15.17673933506012, loss: 21.554980754852295 
Train [2/6] | Epoch [125/140] |	nca: 1.8558625429868698, flat: 4.650423645973206, pod: 14.836270689964294, loss: 21.342557072639465 
Train [2/6] | Epoch [126/140] |	nca: 1.0856508910655975, flat: 4.705178201198578, pod: 14.83326280117035, loss: 20.624091625213623 
Train [2/6] | Epoch [127/140] |	nca: 1.221931867301464, flat: 4.625294059514999, pod: 14.783189177513123, loss: 20.630415558815002 
Train [2/6] | Epoch [128/140] |	nca: 1.0385164767503738, flat: 4.737052798271179, pod: 14.87044084072113, loss: 20.646010398864746 
Train [2/6] | Epoch [129/140] |	nca: 1.0396718382835388, flat: 4.747100859880447, pod: 15.044726610183716, loss: 20.831499576568604 
Train [2/6] | Epoch [130/140] |	nca: 1.0501914992928505, flat: 4.7998171746730804, pod: 15.089382410049438, loss: 20.939390897750854 
Train [2/6] | Epoch [131/140] |	nca: 1.0513265505433083, flat: 4.775324642658234, pod: 15.021060228347778, loss: 20.84771156311035 
Train [2/6] | Epoch [132/140] |	nca: 1.1418699771165848, flat: 4.714773118495941, pod: 14.818236231803894, loss: 20.67487919330597 
Train [2/6] | Epoch [133/140] |	nca: 0.9524995610117912, flat: 4.625419557094574, pod: 14.857136726379395, loss: 20.43505620956421 
Train [2/6] | Epoch [134/140] |	nca: 1.008697897195816, flat: 4.711954057216644, pod: 14.999613881111145, loss: 20.720265984535217 
Train [2/6] | Epoch [135/140] |	nca: 0.8902697376906872, flat: 4.760386437177658, pod: 14.963114857673645, loss: 20.613771200180054 
Train [2/6] | Epoch [136/140] |	nca: 0.9882779717445374, flat: 4.659631162881851, pod: 14.783498525619507, loss: 20.431407570838928 
Train [2/6] | Epoch [137/140] |	nca: 1.1687405332922935, flat: 4.698074132204056, pod: 14.862549543380737, loss: 20.729363918304443 
Train [2/6] | Epoch [138/140] |	nca: 1.1276679672300816, flat: 4.865278333425522, pod: 15.175493478775024, loss: 21.168439984321594 
Train [2/6] | Epoch [139/140] |	nca: 0.9084055610001087, flat: 4.757326155900955, pod: 15.15739893913269, loss: 20.82313096523285 
Train [2/6] | Epoch [140/140] |	nca: 0.8968604132533073, flat: 4.868664383888245, pod: 15.27584981918335, loss: 21.041374444961548 
after task
Building & updating memory.
after task
Eval on 0->6.
eval task
podnet_nme_cifar10_xsteps
Avg inc acc: 0.9119999999999999.
Current acc: {'total': 0.853, '00-09': 0.853}.
Avg inc acc top5: 1.0.
Current acc top5: {'total': 1.0}.
Forgetting: 0.059.
Cord metric: 0.88.
Old accuracy: 0.90, mean: 0.90.
New accuracy: 0.60, mean: 0.60.
================Task 2 Start!================
Testing on False unseen tasks (max class = 7).
Set memory of size: 1200.
Before task
Generating imprinted weights
Multi class diff kmeans.
Now 200 examplars per class.
Group: convnet, lr: 0.1.
Group: postprocessing, lr: 0.1.
Group: new_weights, lr: 0.1.
================Task 2 Training!================
The training samples number: 6200
Train on 6->7.
train task
nb 6200.
Train [3/6] | Epoch [1/120] |	nca: 19.126209422945976, flat: 21.66602858901024, pod: 98.9140647649765, loss: 139.70630288124084 
Train [3/6] | Epoch [2/120] |	nca: 10.474622532725334, flat: 10.899092882871628, pod: 67.42869329452515, loss: 88.80240845680237 
Train [3/6] | Epoch [3/120] |	nca: 8.182314865291119, flat: 9.15976993739605, pod: 62.13171136379242, loss: 79.47379612922668 
Train [3/6] | Epoch [4/120] |	nca: 7.864654436707497, flat: 8.503812670707703, pod: 60.050753116607666, loss: 76.419220328331 
Train [3/6] | Epoch [5/120] |	nca: 7.964577808976173, flat: 8.175111383199692, pod: 59.057469844818115, loss: 75.19715905189514 
Train [3/6] | Epoch [6/120] |	nca: 7.113911494612694, flat: 7.530312940478325, pod: 54.84743595123291, loss: 69.49165987968445 
Train [3/6] | Epoch [7/120] |	nca: 6.850549571216106, flat: 7.819954134523869, pod: 57.08697319030762, loss: 71.7574771642685 
Train [3/6] | Epoch [8/120] |	nca: 6.772066526114941, flat: 7.595186181366444, pod: 56.57080829143524, loss: 70.93806087970734 
Train [3/6] | Epoch [9/120] |	nca: 5.962234139442444, flat: 7.162222854793072, pod: 52.433568596839905, loss: 65.55802595615387 
Train [3/6] | Epoch [10/120] |	nca: 6.392545863986015, flat: 7.131364032626152, pod: 52.51130121946335, loss: 66.0352109670639 
Train [3/6] | Epoch [11/120] |	nca: 6.368877176195383, flat: 7.360538087785244, pod: 55.13965928554535, loss: 68.86907410621643 
Train [3/6] | Epoch [12/120] |	nca: 5.655715763568878, flat: 6.757291942834854, pod: 52.11450558900833, loss: 64.52751338481903 
Train [3/6] | Epoch [13/120] |	nca: 6.702598892152309, flat: 7.669015020132065, pod: 56.24097788333893, loss: 70.61259233951569 
Train [3/6] | Epoch [14/120] |	nca: 6.232466399669647, flat: 7.326756000518799, pod: 53.865869760513306, loss: 67.4250922203064 
Train [3/6] | Epoch [15/120] |	nca: 5.773553650826216, flat: 7.082585923373699, pod: 53.7016139626503, loss: 66.5577540397644 
Train [3/6] | Epoch [16/120] |	nca: 5.576074063777924, flat: 7.120816260576248, pod: 53.17748665809631, loss: 65.87437701225281 
Train [3/6] | Epoch [17/120] |	nca: 5.791879016906023, flat: 6.688328571617603, pod: 51.56666612625122, loss: 64.04687333106995 
Train [3/6] | Epoch [18/120] |	nca: 5.852927323430777, flat: 7.011653251945972, pod: 52.66459387540817, loss: 65.52917397022247 
Train [3/6] | Epoch [19/120] |	nca: 5.521983727812767, flat: 7.074196487665176, pod: 53.55974751710892, loss: 66.15592813491821 
Train [3/6] | Epoch [20/120] |	nca: 5.54854566603899, flat: 6.570397354662418, pod: 49.99609762430191, loss: 62.11504137516022 
Train [3/6] | Epoch [21/120] |	nca: 5.328113228082657, flat: 6.860489249229431, pod: 51.62024945020676, loss: 63.80885171890259 
Train [3/6] | Epoch [22/120] |	nca: 4.940481081604958, flat: 6.692167207598686, pod: 50.74708867073059, loss: 62.37973701953888 
Train [3/6] | Epoch [23/120] |	nca: 4.607788905501366, flat: 6.202437452971935, pod: 48.655253648757935, loss: 59.465479612350464 
Train [3/6] | Epoch [24/120] |	nca: 5.395525384694338, flat: 6.4959588050842285, pod: 50.43662589788437, loss: 62.32810986042023 
Train [3/6] | Epoch [25/120] |	nca: 5.191345404833555, flat: 6.573153845965862, pod: 48.61446523666382, loss: 60.37896490097046 
Train [3/6] | Epoch [26/120] |	nca: 5.327815897762775, flat: 6.9552242159843445, pod: 52.70791292190552, loss: 64.99095261096954 
Train [3/6] | Epoch [27/120] |	nca: 4.787560999393463, flat: 6.502802237868309, pod: 49.97569316625595, loss: 61.266056537628174 
Train [3/6] | Epoch [28/120] |	nca: 4.973572738468647, flat: 6.575278587639332, pod: 50.37950038909912, loss: 61.92835199832916 
Train [3/6] | Epoch [29/120] |	nca: 5.210193682461977, flat: 6.8937999084591866, pod: 52.513447999954224, loss: 64.61744141578674 
Train [3/6] | Epoch [30/120] |	nca: 5.602636460214853, flat: 6.65733165293932, pod: 50.827140510082245, loss: 63.087109208106995 
Train [3/6] | Epoch [31/120] |	nca: 4.210855342447758, flat: 6.321655474603176, pod: 48.600226402282715, loss: 59.132737159729004 
Train [3/6] | Epoch [32/120] |	nca: 4.939606133848429, flat: 6.554326757788658, pod: 51.21366548538208, loss: 62.7075982093811 
Train [3/6] | Epoch [33/120] |	nca: 5.3765740767121315, flat: 6.673935577273369, pod: 50.966910898685455, loss: 63.017420530319214 
Train [3/6] | Epoch [34/120] |	nca: 4.894604913890362, flat: 6.345571093261242, pod: 48.08843755722046, loss: 59.32861375808716 
Train [3/6] | Epoch [35/120] |	nca: 5.0223398096859455, flat: 6.921876147389412, pod: 51.94319820404053, loss: 63.88741445541382 
Train [3/6] | Epoch [36/120] |	nca: 4.277930999174714, flat: 6.319197833538055, pod: 47.725259363651276, loss: 58.32238841056824 
Train [3/6] | Epoch [37/120] |	nca: 4.242305230349302, flat: 6.125826209783554, pod: 47.14676344394684, loss: 57.51489466428757 
Train [3/6] | Epoch [38/120] |	nca: 5.103674745187163, flat: 6.572781048715115, pod: 49.73706901073456, loss: 61.413525104522705 
Train [3/6] | Epoch [39/120] |	nca: 4.810100577771664, flat: 6.2525297701358795, pod: 48.46205550432205, loss: 59.524686217308044 
Train [3/6] | Epoch [40/120] |	nca: 4.775073669850826, flat: 6.623101286590099, pod: 50.11927127838135, loss: 61.517446637153625 
Train [3/6] | Epoch [41/120] |	nca: 4.054390266537666, flat: 6.25896941870451, pod: 48.15879309177399, loss: 58.47215259075165 
Train [3/6] | Epoch [42/120] |	nca: 4.282802911475301, flat: 6.046070389449596, pod: 47.566248655319214, loss: 57.895122051239014 
Train [3/6] | Epoch [43/120] |	nca: 4.187786098569632, flat: 6.274850949645042, pod: 47.10843896865845, loss: 57.57107603549957 
Train [3/6] | Epoch [44/120] |	nca: 4.463807016611099, flat: 5.886325471103191, pod: 45.64731454849243, loss: 55.997447192668915 
Train [3/6] | Epoch [45/120] |	nca: 4.443340972065926, flat: 6.303712464869022, pod: 47.97601443529129, loss: 58.7230681180954 
Train [3/6] | Epoch [46/120] |	nca: 4.17578961327672, flat: 6.036766968667507, pod: 46.91280281543732, loss: 57.125359296798706 
Train [3/6] | Epoch [47/120] |	nca: 4.26369920745492, flat: 6.139006420969963, pod: 46.049809873104095, loss: 56.45251524448395 
Train [3/6] | Epoch [48/120] |	nca: 4.635740630328655, flat: 6.176987454295158, pod: 48.0711395740509, loss: 58.88386785984039 
Train [3/6] | Epoch [49/120] |	nca: 4.077512342482805, flat: 5.888131141662598, pod: 46.23937529325485, loss: 56.205018639564514 
Train [3/6] | Epoch [50/120] |	nca: 3.984138149768114, flat: 5.7913196459412575, pod: 45.06825774908066, loss: 54.843715846538544 
Train [3/6] | Epoch [51/120] |	nca: 4.1085027530789375, flat: 5.9039435759186745, pod: 43.85212421417236, loss: 53.86457085609436 
Train [3/6] | Epoch [52/120] |	nca: 3.820080455392599, flat: 5.8169699385762215, pod: 44.361269891262054, loss: 53.99832046031952 
Train [3/6] | Epoch [53/120] |	nca: 4.140264626592398, flat: 5.973851889371872, pod: 45.0525768995285, loss: 55.16669321060181 
Train [3/6] | Epoch [54/120] |	nca: 4.04434222728014, flat: 5.845639832317829, pod: 43.918913304805756, loss: 53.80889528989792 
Train [3/6] | Epoch [55/120] |	nca: 4.363325729966164, flat: 5.68760621547699, pod: 42.59018713235855, loss: 52.64111918210983 
Train [3/6] | Epoch [56/120] |	nca: 3.812074564397335, flat: 5.687038026750088, pod: 42.43868160247803, loss: 51.937794506549835 
Train [3/6] | Epoch [57/120] |	nca: 3.460667597129941, flat: 5.485179141163826, pod: 41.416303396224976, loss: 50.36215007305145 
Train [3/6] | Epoch [58/120] |	nca: 4.0652199909091, flat: 5.654371067881584, pod: 43.01392287015915, loss: 52.733514070510864 
Train [3/6] | Epoch [59/120] |	nca: 4.206114523112774, flat: 6.0811701864004135, pod: 44.66229200363159, loss: 54.94957685470581 
Train [3/6] | Epoch [60/120] |	nca: 3.9810938239097595, flat: 5.578543230891228, pod: 42.53604805469513, loss: 52.09568512439728 
Train [3/6] | Epoch [61/120] |	nca: 3.770283952355385, flat: 5.335687153041363, pod: 40.113884687423706, loss: 49.21985548734665 
Train [3/6] | Epoch [62/120] |	nca: 3.644732752814889, flat: 5.50600004196167, pod: 41.18018192052841, loss: 50.33091467618942 
Train [3/6] | Epoch [63/120] |	nca: 3.625664357095957, flat: 5.5339536890387535, pod: 41.83114945888519, loss: 50.99076724052429 
Train [3/6] | Epoch [64/120] |	nca: 3.312566637992859, flat: 5.406311854720116, pod: 40.501297533512115, loss: 49.220176219940186 
Train [3/6] | Epoch [65/120] |	nca: 3.882935080677271, flat: 5.714115642011166, pod: 41.47147226333618, loss: 51.06852304935455 
Train [3/6] | Epoch [66/120] |	nca: 3.5912852734327316, flat: 5.440562270581722, pod: 39.70803236961365, loss: 48.73988002538681 
Train [3/6] | Epoch [67/120] |	nca: 3.2601234205067158, flat: 5.228683695197105, pod: 39.37101924419403, loss: 47.859826505184174 
Train [3/6] | Epoch [68/120] |	nca: 3.374008797109127, flat: 5.048510082066059, pod: 38.16358703374863, loss: 46.58610552549362 
Train [3/6] | Epoch [69/120] |	nca: 3.2949472945183516, flat: 5.258712470531464, pod: 38.477074563503265, loss: 47.03073400259018 
Train [3/6] | Epoch [70/120] |	nca: 2.9956678338348866, flat: 4.98703021556139, pod: 38.019019305706024, loss: 46.00171738862991 
Train [3/6] | Epoch [71/120] |	nca: 3.568685185164213, flat: 5.188760854303837, pod: 39.002095103263855, loss: 47.759541153907776 
Train [3/6] | Epoch [72/120] |	nca: 3.425549054518342, flat: 5.125164911150932, pod: 37.5885996222496, loss: 46.13931357860565 
Train [3/6] | Epoch [73/120] |	nca: 3.60321444272995, flat: 5.0669324696063995, pod: 38.383686542510986, loss: 47.05383348464966 
Train [3/6] | Epoch [74/120] |	nca: 2.9320041816681623, flat: 5.090638674795628, pod: 38.39752346277237, loss: 46.42016649246216 
Train [3/6] | Epoch [75/120] |	nca: 3.1692883148789406, flat: 4.822338335216045, pod: 35.743139803409576, loss: 43.734766125679016 
Train [3/6] | Epoch [76/120] |	nca: 2.9720334745943546, flat: 4.8494406417012215, pod: 36.166039168834686, loss: 43.98751336336136 
Train [3/6] | Epoch [77/120] |	nca: 2.923862462863326, flat: 4.989664874970913, pod: 37.151355504989624, loss: 45.06488263607025 
Train [3/6] | Epoch [78/120] |	nca: 2.813066851347685, flat: 4.759109444916248, pod: 35.928055584430695, loss: 43.50023204088211 
Train [3/6] | Epoch [79/120] |	nca: 2.696586910635233, flat: 4.586344502866268, pod: 34.421101450920105, loss: 41.70403295755386 
Train [3/6] | Epoch [80/120] |	nca: 2.840042544528842, flat: 4.519044354557991, pod: 33.49495601654053, loss: 40.85404288768768 
Train [3/6] | Epoch [81/120] |	nca: 2.4565894827246666, flat: 4.493180066347122, pod: 33.16602671146393, loss: 40.1157962679863 
Train [3/6] | Epoch [82/120] |	nca: 2.5404472425580025, flat: 4.384258516132832, pod: 33.39987677335739, loss: 40.324582278728485 
Train [3/6] | Epoch [83/120] |	nca: 3.0464237947016954, flat: 4.75888579338789, pod: 34.51713824272156, loss: 42.32244771718979 
Train [3/6] | Epoch [84/120] |	nca: 2.7190974932163954, flat: 4.589768126606941, pod: 33.63378405570984, loss: 40.94264978170395 
Train [3/6] | Epoch [85/120] |	nca: 2.6851836312562227, flat: 4.471560716629028, pod: 32.12666475772858, loss: 39.28340935707092 
Train [3/6] | Epoch [86/120] |	nca: 2.52351850643754, flat: 4.494280323386192, pod: 31.902434408664703, loss: 38.920233368873596 
Train [3/6] | Epoch [87/120] |	nca: 2.6449188459664583, flat: 4.4256632179021835, pod: 32.51712131500244, loss: 39.587703227996826 
Train [3/6] | Epoch [88/120] |	nca: 2.6531353928148746, flat: 4.475019998848438, pod: 31.87775182723999, loss: 39.0059072971344 
Train [3/6] | Epoch [89/120] |	nca: 2.454207757487893, flat: 4.212864473462105, pod: 29.86658000946045, loss: 36.53365212678909 
Train [3/6] | Epoch [90/120] |	nca: 2.588613376021385, flat: 4.314071819186211, pod: 31.074738442897797, loss: 37.977423787117004 
Train [3/6] | Epoch [91/120] |	nca: 2.364143207669258, flat: 4.4087013229727745, pod: 30.377148926258087, loss: 37.14999341964722 
Train [3/6] | Epoch [92/120] |	nca: 2.3998507112264633, flat: 4.267991133034229, pod: 29.803746104240417, loss: 36.471587896347046 
Train [3/6] | Epoch [93/120] |	nca: 2.393850039690733, flat: 4.1200719475746155, pod: 29.693612456321716, loss: 36.20753437280655 
Train [3/6] | Epoch [94/120] |	nca: 2.5804060474038124, flat: 4.367424860596657, pod: 30.406234353780746, loss: 37.35406541824341 
Train [3/6] | Epoch [95/120] |	nca: 2.3422364108264446, flat: 4.113754779100418, pod: 28.807095229625702, loss: 35.263086557388306 
Train [3/6] | Epoch [96/120] |	nca: 2.313849400728941, flat: 4.090929567813873, pod: 27.795538872480392, loss: 34.20031762123108 
Train [3/6] | Epoch [97/120] |	nca: 2.361868027597666, flat: 4.151104189455509, pod: 28.843352168798447, loss: 35.356324315071106 
Train [3/6] | Epoch [98/120] |	nca: 2.356356732547283, flat: 4.13387143984437, pod: 27.992414981126785, loss: 34.482643127441406 
Train [3/6] | Epoch [99/120] |	nca: 2.458535920828581, flat: 4.095167610794306, pod: 27.285941153764725, loss: 33.83964467048645 
Train [3/6] | Epoch [100/120] |	nca: 2.2394412849098444, flat: 4.08462705463171, pod: 27.519330710172653, loss: 33.84339910745621 
Train [3/6] | Epoch [101/120] |	nca: 2.1697085984051228, flat: 3.900233171880245, pod: 26.942138731479645, loss: 33.01208060979843 
Train [3/6] | Epoch [102/120] |	nca: 2.0516420993953943, flat: 3.996244117617607, pod: 27.03901770710945, loss: 33.08690369129181 
Train [3/6] | Epoch [103/120] |	nca: 2.168907841667533, flat: 3.8613407909870148, pod: 26.082833617925644, loss: 32.11308240890503 
Train [3/6] | Epoch [104/120] |	nca: 2.0379073563963175, flat: 3.830109864473343, pod: 25.36039173603058, loss: 31.22840905189514 
Train [3/6] | Epoch [105/120] |	nca: 2.1316995676606894, flat: 3.941059857606888, pod: 26.16684478521347, loss: 32.23960441350937 
Train [3/6] | Epoch [106/120] |	nca: 2.1873633041977882, flat: 3.81949769705534, pod: 26.17454442381859, loss: 32.18140518665314 
Train [3/6] | Epoch [107/120] |	nca: 2.068618729710579, flat: 3.888274110853672, pod: 25.24109661579132, loss: 31.197989642620087 
Train [3/6] | Epoch [108/120] |	nca: 2.2055262457579374, flat: 3.778652559965849, pod: 25.218824297189713, loss: 31.203003108501434 
Train [3/6] | Epoch [109/120] |	nca: 2.1240944769233465, flat: 3.9088331684470177, pod: 25.493735909461975, loss: 31.5266632437706 
Train [3/6] | Epoch [110/120] |	nca: 2.036428779363632, flat: 3.741970542818308, pod: 24.338853538036346, loss: 30.117253094911575 
Train [3/6] | Epoch [111/120] |	nca: 2.089613886550069, flat: 3.743603441864252, pod: 24.61210787296295, loss: 30.44532537460327 
Train [3/6] | Epoch [112/120] |	nca: 2.055861657485366, flat: 3.750052236020565, pod: 24.151333928108215, loss: 29.95724767446518 
Train [3/6] | Epoch [113/120] |	nca: 2.0667474884539843, flat: 3.675876460969448, pod: 23.642592191696167, loss: 29.385216176509857 
Train [3/6] | Epoch [114/120] |	nca: 1.9535115770995617, flat: 3.821955256164074, pod: 24.370000332593918, loss: 30.145467281341553 
Train [3/6] | Epoch [115/120] |	nca: 2.210011687129736, flat: 3.6578831672668457, pod: 23.190313816070557, loss: 29.05820870399475 
Train [3/6] | Epoch [116/120] |	nca: 2.029972180724144, flat: 3.7513407841324806, pod: 24.01779145002365, loss: 29.79910433292389 
Train [3/6] | Epoch [117/120] |	nca: 1.9209068398922682, flat: 3.7106005288660526, pod: 23.89755791425705, loss: 29.529065251350403 
Train [3/6] | Epoch [118/120] |	nca: 2.0584780871868134, flat: 3.703301664441824, pod: 23.40872374176979, loss: 29.170503437519073 
Train [3/6] | Epoch [119/120] |	nca: 2.130406141281128, flat: 3.6452014595270157, pod: 23.280473858118057, loss: 29.056081384420395 
Train [3/6] | Epoch [120/120] |	nca: 2.0469161346554756, flat: 3.7849623821675777, pod: 24.077471017837524, loss: 29.909349381923676 
Fine-tuning
Building & updating memory.
Train [3/6] | Epoch [121/140] |	nca: 4.984785184264183, flat: 2.7810018211603165, pod: 20.210567355155945, loss: 27.976354122161865 
Train [3/6] | Epoch [122/140] |	nca: 2.431212991476059, flat: 2.8212893307209015, pod: 20.275872588157654, loss: 25.528375148773193 
Train [3/6] | Epoch [123/140] |	nca: 1.8707068338990211, flat: 2.7871602922677994, pod: 20.33768332004547, loss: 24.99554991722107 
Train [3/6] | Epoch [124/140] |	nca: 1.5547042414546013, flat: 2.7642970979213715, pod: 20.253273725509644, loss: 24.572274923324585 
Train [3/6] | Epoch [125/140] |	nca: 1.4425526186823845, flat: 2.7568940073251724, pod: 20.203975558280945, loss: 24.403422236442566 
Train [3/6] | Epoch [126/140] |	nca: 1.5105197429656982, flat: 2.8012063950300217, pod: 20.32430326938629, loss: 24.636029481887817 
Train [3/6] | Epoch [127/140] |	nca: 1.1695122867822647, flat: 2.831037238240242, pod: 20.58630669116974, loss: 24.58685612678528 
Train [3/6] | Epoch [128/140] |	nca: 1.244705580174923, flat: 2.8202161341905594, pod: 20.41973114013672, loss: 24.484652757644653 
Train [3/6] | Epoch [129/140] |	nca: 1.2089036479592323, flat: 2.8084286600351334, pod: 20.212947487831116, loss: 24.230279803276062 
Train [3/6] | Epoch [130/140] |	nca: 1.2157558500766754, flat: 2.803517058491707, pod: 20.318750381469727, loss: 24.33802318572998 
Train [3/6] | Epoch [131/140] |	nca: 1.1241527795791626, flat: 2.7639710009098053, pod: 20.24492049217224, loss: 24.133044004440308 
Train [3/6] | Epoch [132/140] |	nca: 1.0601455196738243, flat: 2.7785677909851074, pod: 20.213858246803284, loss: 24.052571654319763 
Train [3/6] | Epoch [133/140] |	nca: 1.1188755258917809, flat: 2.8015205413103104, pod: 20.342015504837036, loss: 24.262411952018738 
Train [3/6] | Epoch [134/140] |	nca: 1.3371643722057343, flat: 2.855858623981476, pod: 20.629008054733276, loss: 24.822030901908875 
Train [3/6] | Epoch [135/140] |	nca: 1.0830726996064186, flat: 2.7894848585128784, pod: 20.48174011707306, loss: 24.354297518730164 
Train [3/6] | Epoch [136/140] |	nca: 1.2345715761184692, flat: 2.788108378648758, pod: 20.43016481399536, loss: 24.452844738960266 
Train [3/6] | Epoch [137/140] |	nca: 1.1336736232042313, flat: 2.7596737444400787, pod: 20.247863292694092, loss: 24.141210794448853 
Train [3/6] | Epoch [138/140] |	nca: 1.1474568545818329, flat: 2.772978112101555, pod: 20.224093556404114, loss: 24.14452862739563 
Train [3/6] | Epoch [139/140] |	nca: 0.9946062341332436, flat: 2.8007629811763763, pod: 20.48392426967621, loss: 24.279293298721313 
Train [3/6] | Epoch [140/140] |	nca: 1.0441268905997276, flat: 2.778308004140854, pod: 20.25406527519226, loss: 24.076499819755554 
after task
Building & updating memory.
after task
Eval on 0->7.
eval task
podnet_nme_cifar10_xsteps
Avg inc acc: 0.8839999999999999.
Current acc: {'total': 0.828, '00-09': 0.828}.
Avg inc acc top5: 0.999.
Current acc top5: {'total': 0.997}.
Forgetting: 0.07150000000000001.
Cord metric: 0.86.
Old accuracy: 0.83, mean: 0.87.
New accuracy: 0.82, mean: 0.71.
================Task 3 Start!================
Testing on False unseen tasks (max class = 8).
Set memory of size: 1400.
Before task
Generating imprinted weights
Multi class diff kmeans.
Now 200 examplars per class.
Group: convnet, lr: 0.1.
Group: postprocessing, lr: 0.1.
Group: new_weights, lr: 0.1.
================Task 3 Training!================
The training samples number: 6400
Train on 7->8.
train task
nb 6400.
Train [4/6] | Epoch [1/120] |	nca: 20.054931804537773, flat: 7.473908320069313, pod: 75.70941126346588, loss: 103.23825192451477 
Train [4/6] | Epoch [2/120] |	nca: 11.743783339858055, flat: 4.593400053679943, pod: 61.672008991241455, loss: 78.00919258594513 
Train [4/6] | Epoch [3/120] |	nca: 11.202398344874382, flat: 4.556225337088108, pod: 62.43175005912781, loss: 78.19037353992462 
Train [4/6] | Epoch [4/120] |	nca: 9.952191144227982, flat: 4.049053579568863, pod: 57.57303583621979, loss: 71.57428050041199 
Train [4/6] | Epoch [5/120] |	nca: 8.667445726692677, flat: 3.850710205733776, pod: 57.625024914741516, loss: 70.14318072795868 
Train [4/6] | Epoch [6/120] |	nca: 9.323426455259323, flat: 4.071391224861145, pod: 57.476943612098694, loss: 70.8717612028122 
Train [4/6] | Epoch [7/120] |	nca: 8.17555808275938, flat: 3.8035638853907585, pod: 55.953925371170044, loss: 67.93304741382599 
Train [4/6] | Epoch [8/120] |	nca: 8.622247874736786, flat: 3.780523955821991, pod: 55.48767626285553, loss: 67.89044797420502 
Train [4/6] | Epoch [9/120] |	nca: 8.530663803219795, flat: 3.9575935639441013, pod: 56.03406512737274, loss: 68.52232217788696 
Train [4/6] | Epoch [10/120] |	nca: 7.0736542865633965, flat: 3.685376737266779, pod: 54.49439758062363, loss: 65.25342857837677 
Train [4/6] | Epoch [11/120] |	nca: 6.544162668287754, flat: 3.3287307880818844, pod: 50.09757798910141, loss: 59.97047162055969 
Train [4/6] | Epoch [12/120] |	nca: 7.226132020354271, flat: 3.464528474956751, pod: 51.74775904417038, loss: 62.43841898441315 
Train [4/6] | Epoch [13/120] |	nca: 7.15649238973856, flat: 3.764220215380192, pod: 54.71911907196045, loss: 65.63983118534088 
Train [4/6] | Epoch [14/120] |	nca: 6.805553734302521, flat: 3.504435133188963, pod: 50.820150792598724, loss: 61.13013958930969 
Train [4/6] | Epoch [15/120] |	nca: 6.578373320400715, flat: 3.693311110138893, pod: 52.361185908317566, loss: 62.63287031650543 
Train [4/6] | Epoch [16/120] |	nca: 7.023417327553034, flat: 3.697985202074051, pod: 53.24208879470825, loss: 63.96349096298218 
Train [4/6] | Epoch [17/120] |	nca: 6.335995756089687, flat: 3.5804780162870884, pod: 51.74088454246521, loss: 61.65735840797424 
Train [4/6] | Epoch [18/120] |	nca: 6.269566021859646, flat: 3.5245381481945515, pod: 51.93015283346176, loss: 61.7242568731308 
Train [4/6] | Epoch [19/120] |	nca: 6.276937440037727, flat: 3.428759917616844, pod: 50.26228314638138, loss: 59.96798074245453 
Train [4/6] | Epoch [20/120] |	nca: 5.822393417358398, flat: 3.4135792143642902, pod: 49.505059123039246, loss: 58.741031646728516 
Train [4/6] | Epoch [21/120] |	nca: 7.009006500244141, flat: 3.6879244558513165, pod: 52.739228546619415, loss: 63.43615972995758 
Train [4/6] | Epoch [22/120] |	nca: 5.729020610451698, flat: 3.2256237529218197, pod: 46.764488220214844, loss: 55.71913284063339 
Train [4/6] | Epoch [23/120] |	nca: 6.086006075143814, flat: 3.4899400174617767, pod: 50.49695444107056, loss: 60.07290041446686 
Train [4/6] | Epoch [24/120] |	nca: 5.626133896410465, flat: 3.4411789663136005, pod: 49.76423782110214, loss: 58.83155083656311 
Train [4/6] | Epoch [25/120] |	nca: 5.842849586158991, flat: 3.368386536836624, pod: 48.0998991727829, loss: 57.311135053634644 
Train [4/6] | Epoch [26/120] |	nca: 5.079827036708593, flat: 3.5354301668703556, pod: 50.22228294610977, loss: 58.83754003047943 
Train [4/6] | Epoch [27/120] |	nca: 6.259026229381561, flat: 3.311724416911602, pod: 48.73255282640457, loss: 58.30330318212509 
Train [4/6] | Epoch [28/120] |	nca: 5.936539512127638, flat: 3.4545498564839363, pod: 48.592595517635345, loss: 57.9836847782135 
Train [4/6] | Epoch [29/120] |	nca: 5.666154768317938, flat: 3.494548998773098, pod: 50.126796782016754, loss: 59.287500739097595 
Train [4/6] | Epoch [30/120] |	nca: 5.493772756308317, flat: 3.529133412986994, pod: 49.765797317028046, loss: 58.78870338201523 
Train [4/6] | Epoch [31/120] |	nca: 5.494019899517298, flat: 3.316977236419916, pod: 47.08431887626648, loss: 55.89531570672989 
Train [4/6] | Epoch [32/120] |	nca: 5.268884837627411, flat: 3.263093378394842, pod: 47.33162695169449, loss: 55.863605201244354 
Train [4/6] | Epoch [33/120] |	nca: 5.73393839597702, flat: 3.470556527376175, pod: 50.09310954809189, loss: 59.2976051568985 
Train [4/6] | Epoch [34/120] |	nca: 5.03164354711771, flat: 3.392777983099222, pod: 48.25838488340378, loss: 56.682806730270386 
Train [4/6] | Epoch [35/120] |	nca: 5.04708069562912, flat: 3.2965735010802746, pod: 48.127763509750366, loss: 56.47141766548157 
Train [4/6] | Epoch [36/120] |	nca: 4.908092398196459, flat: 3.2546079717576504, pod: 48.581944823265076, loss: 56.74464547634125 
Train [4/6] | Epoch [37/120] |	nca: 4.755479738116264, flat: 3.100524201989174, pod: 44.64934200048447, loss: 52.50534588098526 
Train [4/6] | Epoch [38/120] |	nca: 5.267995327711105, flat: 3.2922178395092487, pod: 47.8436079621315, loss: 56.40382122993469 
Train [4/6] | Epoch [39/120] |	nca: 5.331756394356489, flat: 3.116093322634697, pod: 45.955146849155426, loss: 54.40299654006958 
Train [4/6] | Epoch [40/120] |	nca: 4.911840129643679, flat: 3.0717634558677673, pod: 44.56575256586075, loss: 52.54935646057129 
Train [4/6] | Epoch [41/120] |	nca: 4.6829050332307816, flat: 3.129347212612629, pod: 46.64800590276718, loss: 54.460257947444916 
Train [4/6] | Epoch [42/120] |	nca: 4.853402514010668, flat: 3.0683871135115623, pod: 44.646180868148804, loss: 52.56797093153 
Train [4/6] | Epoch [43/120] |	nca: 4.763064503669739, flat: 3.081188965588808, pod: 45.184903621673584, loss: 53.02915734052658 
Train [4/6] | Epoch [44/120] |	nca: 4.8443695195019245, flat: 3.132426604628563, pod: 45.118900418281555, loss: 53.09569674730301 
Train [4/6] | Epoch [45/120] |	nca: 4.892346411943436, flat: 3.007718827575445, pod: 44.70416194200516, loss: 52.60422724485397 
Train [4/6] | Epoch [46/120] |	nca: 4.439504258334637, flat: 3.018302161246538, pod: 43.93720579147339, loss: 51.395012855529785 
Train [4/6] | Epoch [47/120] |	nca: 4.320726156234741, flat: 2.9711163006722927, pod: 44.321824848651886, loss: 51.61366695165634 
Train [4/6] | Epoch [48/120] |	nca: 4.228942912071943, flat: 2.8907141350209713, pod: 43.89947921037674, loss: 51.019136130809784 
Train [4/6] | Epoch [49/120] |	nca: 4.497082028537989, flat: 2.9673700034618378, pod: 42.556658029556274, loss: 50.021109998226166 
Train [4/6] | Epoch [50/120] |	nca: 4.332496464252472, flat: 2.8180332481861115, pod: 41.61513394117355, loss: 48.76566368341446 
Train [4/6] | Epoch [51/120] |	nca: 4.398083813488483, flat: 2.8272868134081364, pod: 41.309047281742096, loss: 48.53441762924194 
Train [4/6] | Epoch [52/120] |	nca: 3.963199768215418, flat: 2.9102079048752785, pod: 42.551739037036896, loss: 49.42514646053314 
Train [4/6] | Epoch [53/120] |	nca: 4.333700343966484, flat: 2.978280082345009, pod: 42.883535385131836, loss: 50.19551545381546 
Train [4/6] | Epoch [54/120] |	nca: 3.6831647269427776, flat: 2.734596524387598, pod: 41.21623879671097, loss: 47.633999824523926 
Train [4/6] | Epoch [55/120] |	nca: 4.059212535619736, flat: 2.8078864626586437, pod: 41.20692241191864, loss: 48.074021339416504 
Train [4/6] | Epoch [56/120] |	nca: 4.240454785525799, flat: 2.731581974774599, pod: 40.65178108215332, loss: 47.623817801475525 
Train [4/6] | Epoch [57/120] |	nca: 3.8904504515230656, flat: 2.922545373439789, pod: 42.86416894197464, loss: 49.677164912223816 
Train [4/6] | Epoch [58/120] |	nca: 3.3340200148522854, flat: 2.7020591869950294, pod: 40.3340420126915, loss: 46.370121240615845 
Train [4/6] | Epoch [59/120] |	nca: 4.1278274692595005, flat: 2.731844123452902, pod: 40.29910272359848, loss: 47.15877431631088 
Train [4/6] | Epoch [60/120] |	nca: 3.585981175303459, flat: 2.6612223647534847, pod: 40.7579031586647, loss: 47.00510638952255 
Train [4/6] | Epoch [61/120] |	nca: 3.9424866512417793, flat: 2.702700447291136, pod: 41.56918877363205, loss: 48.21437567472458 
Train [4/6] | Epoch [62/120] |	nca: 3.7104722894728184, flat: 2.733154010027647, pod: 41.051475286483765, loss: 47.495101749897 
Train [4/6] | Epoch [63/120] |	nca: 3.1961838230490685, flat: 2.585625182837248, pod: 38.61674803495407, loss: 44.398557126522064 
Train [4/6] | Epoch [64/120] |	nca: 3.5924554113298655, flat: 2.6604573018848896, pod: 40.111226975917816, loss: 46.364139795303345 
Train [4/6] | Epoch [65/120] |	nca: 3.1735470183193684, flat: 2.456469614058733, pod: 37.148057878017426, loss: 42.778074502944946 
Train [4/6] | Epoch [66/120] |	nca: 3.362817581743002, flat: 2.5304977856576443, pod: 37.751139640808105, loss: 43.644454538822174 
Train [4/6] | Epoch [67/120] |	nca: 3.5541751347482204, flat: 2.5079622082412243, pod: 36.70768475532532, loss: 42.769822001457214 
Train [4/6] | Epoch [68/120] |	nca: 3.637697532773018, flat: 2.5798997096717358, pod: 38.632495760917664, loss: 44.85009300708771 
Train [4/6] | Epoch [69/120] |	nca: 3.3281314857304096, flat: 2.3681150302290916, pod: 35.86439901590347, loss: 41.56064522266388 
Train [4/6] | Epoch [70/120] |	nca: 2.808908350765705, flat: 2.33243690058589, pod: 35.56743836402893, loss: 40.70878356695175 
Train [4/6] | Epoch [71/120] |	nca: 3.234068311750889, flat: 2.399992562830448, pod: 37.18315124511719, loss: 42.81721216440201 
Train [4/6] | Epoch [72/120] |	nca: 3.2851048093289137, flat: 2.284810036420822, pod: 34.44047749042511, loss: 40.01039230823517 
Train [4/6] | Epoch [73/120] |	nca: 2.717859111726284, flat: 2.4034753926098347, pod: 36.36073541641235, loss: 41.48206979036331 
Train [4/6] | Epoch [74/120] |	nca: 3.1369309537112713, flat: 2.3000247105956078, pod: 34.85488450527191, loss: 40.29184031486511 
Train [4/6] | Epoch [75/120] |	nca: 2.831017816439271, flat: 2.3765834029763937, pod: 33.92998254299164, loss: 39.13758385181427 
Train [4/6] | Epoch [76/120] |	nca: 2.9909377340227365, flat: 2.1545248851180077, pod: 32.33581918478012, loss: 37.48128169775009 
Train [4/6] | Epoch [77/120] |	nca: 2.7043843995779753, flat: 2.171807374805212, pod: 32.27744734287262, loss: 37.153639137744904 
Train [4/6] | Epoch [78/120] |	nca: 2.6629075538367033, flat: 2.1377159412950277, pod: 32.67927771806717, loss: 37.479901134967804 
Train [4/6] | Epoch [79/120] |	nca: 2.882258642464876, flat: 2.2033250741660595, pod: 33.69168937206268, loss: 38.77727323770523 
Train [4/6] | Epoch [80/120] |	nca: 2.9060438349843025, flat: 2.2170008830726147, pod: 34.11258256435394, loss: 39.23562741279602 
Train [4/6] | Epoch [81/120] |	nca: 2.3910368122160435, flat: 2.0191966500133276, pod: 31.069661855697632, loss: 35.479895412921906 
Train [4/6] | Epoch [82/120] |	nca: 2.5035697743296623, flat: 2.099411725997925, pod: 31.682375192642212, loss: 36.28535658121109 
Train [4/6] | Epoch [83/120] |	nca: 2.4988241121172905, flat: 2.0864749401807785, pod: 32.2818700671196, loss: 36.8671692609787 
Train [4/6] | Epoch [84/120] |	nca: 2.55129905231297, flat: 1.977207325398922, pod: 30.635386168956757, loss: 35.1638925075531 
Train [4/6] | Epoch [85/120] |	nca: 2.4707146920263767, flat: 2.0439380425959826, pod: 30.670153260231018, loss: 35.18480622768402 
Train [4/6] | Epoch [86/120] |	nca: 2.4887041728943586, flat: 1.9355853255838156, pod: 30.006630092859268, loss: 34.4309196472168 
Train [4/6] | Epoch [87/120] |	nca: 2.4131734054535627, flat: 1.9423179477453232, pod: 30.757835030555725, loss: 35.11332643032074 
Train [4/6] | Epoch [88/120] |	nca: 2.2386105116456747, flat: 2.080374676734209, pod: 32.12779998779297, loss: 36.446785151958466 
Train [4/6] | Epoch [89/120] |	nca: 2.307419829070568, flat: 1.8797719981521368, pod: 28.712186455726624, loss: 32.8993781208992 
Train [4/6] | Epoch [90/120] |	nca: 2.3406620249152184, flat: 1.846061047166586, pod: 29.492977023124695, loss: 33.67970025539398 
Train [4/6] | Epoch [91/120] |	nca: 2.1367978751659393, flat: 1.8494993336498737, pod: 28.761301696300507, loss: 32.74759900569916 
Train [4/6] | Epoch [92/120] |	nca: 2.2492806557565928, flat: 1.9106480609625578, pod: 28.496842592954636, loss: 32.656771302223206 
Train [4/6] | Epoch [93/120] |	nca: 2.2858305238187313, flat: 1.8320844043046236, pod: 27.65998926758766, loss: 31.777904331684113 
Train [4/6] | Epoch [94/120] |	nca: 2.0502632800489664, flat: 1.8018375020474195, pod: 26.623756021261215, loss: 30.475856840610504 
Train [4/6] | Epoch [95/120] |	nca: 2.115844087675214, flat: 1.8181559685617685, pod: 27.808721035718918, loss: 31.74272119998932 
Train [4/6] | Epoch [96/120] |	nca: 2.308611085638404, flat: 1.7365149110555649, pod: 26.691645681858063, loss: 30.73677158355713 
Train [4/6] | Epoch [97/120] |	nca: 2.0200978852808475, flat: 1.7664386238902807, pod: 26.479670763015747, loss: 30.26620727777481 
Train [4/6] | Epoch [98/120] |	nca: 2.173070827499032, flat: 1.7124689817428589, pod: 25.78216990828514, loss: 29.66770961880684 
Train [4/6] | Epoch [99/120] |	nca: 2.013337241485715, flat: 1.7472474314272404, pod: 26.295127660036087, loss: 30.0557122528553 
Train [4/6] | Epoch [100/120] |	nca: 2.0931748654693365, flat: 1.7361942250281572, pod: 25.99917122721672, loss: 29.828540295362473 
Train [4/6] | Epoch [101/120] |	nca: 2.168319633230567, flat: 1.7116929031908512, pod: 25.286796152591705, loss: 29.16680872440338 
Train [4/6] | Epoch [102/120] |	nca: 1.903367729857564, flat: 1.6493622977286577, pod: 24.754166424274445, loss: 28.306896686553955 
Train [4/6] | Epoch [103/120] |	nca: 1.967811206355691, flat: 1.62526161596179, pod: 24.481986463069916, loss: 28.075059354305267 
Train [4/6] | Epoch [104/120] |	nca: 2.0329579394310713, flat: 1.6911520417779684, pod: 25.000191271305084, loss: 28.7243013381958 
Train [4/6] | Epoch [105/120] |	nca: 2.0128530021756887, flat: 1.5931995324790478, pod: 24.409709930419922, loss: 28.015762239694595 
Train [4/6] | Epoch [106/120] |	nca: 1.8423886001110077, flat: 1.6007763408124447, pod: 23.665541112422943, loss: 27.108706027269363 
Train [4/6] | Epoch [107/120] |	nca: 1.914178615435958, flat: 1.5611025802791119, pod: 22.837810963392258, loss: 26.313092172145844 
Train [4/6] | Epoch [108/120] |	nca: 1.8730594404041767, flat: 1.5696385819464922, pod: 23.290397882461548, loss: 26.733095705509186 
Train [4/6] | Epoch [109/120] |	nca: 1.7190714180469513, flat: 1.5918141398578882, pod: 23.387675374746323, loss: 26.69856086373329 
Train [4/6] | Epoch [110/120] |	nca: 1.8711749631911516, flat: 1.5195600241422653, pod: 22.059496223926544, loss: 25.4502312541008 
Train [4/6] | Epoch [111/120] |	nca: 1.878142487257719, flat: 1.58096794039011, pod: 23.135715067386627, loss: 26.59482565522194 
Train [4/6] | Epoch [112/120] |	nca: 1.7876840122044086, flat: 1.5655043106526136, pod: 22.634458661079407, loss: 25.9876469373703 
Train [4/6] | Epoch [113/120] |	nca: 1.8097874782979488, flat: 1.5824520885944366, pod: 23.63297238945961, loss: 27.02521201968193 
Train [4/6] | Epoch [114/120] |	nca: 1.8730245064944029, flat: 1.4847578685730696, pod: 21.49647542834282, loss: 24.85425764322281 
Train [4/6] | Epoch [115/120] |	nca: 1.819860529154539, flat: 1.4534962251782417, pod: 21.426840096712112, loss: 24.70019683241844 
Train [4/6] | Epoch [116/120] |	nca: 1.8123538475483656, flat: 1.4731042981147766, pod: 21.35570576786995, loss: 24.641163885593414 
Train [4/6] | Epoch [117/120] |	nca: 1.752139026299119, flat: 1.4884437303990126, pod: 21.40830409526825, loss: 24.64888682961464 
Train [4/6] | Epoch [118/120] |	nca: 1.773735722526908, flat: 1.4943434838205576, pod: 21.905835539102554, loss: 25.173914700746536 
Train [4/6] | Epoch [119/120] |	nca: 1.815889086574316, flat: 1.493682349100709, pod: 21.86871600151062, loss: 25.17828744649887 
Train [4/6] | Epoch [120/120] |	nca: 1.7236989997327328, flat: 1.461762337014079, pod: 20.838900238275528, loss: 24.024361550807953 
Fine-tuning
Building & updating memory.
Train [4/6] | Epoch [121/140] |	nca: 6.144469730556011, flat: 1.7535324543714523, pod: 17.583897590637207, loss: 25.481900095939636 
Train [4/6] | Epoch [122/140] |	nca: 2.192703403532505, flat: 1.7004169896245003, pod: 17.439093232154846, loss: 21.332213759422302 
Train [4/6] | Epoch [123/140] |	nca: 1.7737588956952095, flat: 1.7223479971289635, pod: 17.28865087032318, loss: 20.78475785255432 
Train [4/6] | Epoch [124/140] |	nca: 1.541219636797905, flat: 1.7784117385745049, pod: 17.67198085784912, loss: 20.991612195968628 
Train [4/6] | Epoch [125/140] |	nca: 1.4876260086894035, flat: 1.724682256579399, pod: 17.424744486808777, loss: 20.63705277442932 
Train [4/6] | Epoch [126/140] |	nca: 1.247124545276165, flat: 1.6894090697169304, pod: 17.300301432609558, loss: 20.23683512210846 
Train [4/6] | Epoch [127/140] |	nca: 1.3871354907751083, flat: 1.7125726714730263, pod: 17.42280864715576, loss: 20.52251696586609 
Train [4/6] | Epoch [128/140] |	nca: 1.3048394843935966, flat: 1.7607150599360466, pod: 17.4212167263031, loss: 20.48677146434784 
Train [4/6] | Epoch [129/140] |	nca: 1.173880822956562, flat: 1.782847136259079, pod: 17.59393620491028, loss: 20.55066430568695 
Train [4/6] | Epoch [130/140] |	nca: 1.2364856004714966, flat: 1.7715527713298798, pod: 17.664366006851196, loss: 20.672404289245605 
Train [4/6] | Epoch [131/140] |	nca: 1.2810490876436234, flat: 1.7820821031928062, pod: 17.520170211791992, loss: 20.583301424980164 
Train [4/6] | Epoch [132/140] |	nca: 1.2035920545458794, flat: 1.7194703593850136, pod: 17.521133303642273, loss: 20.44419574737549 
Train [4/6] | Epoch [133/140] |	nca: 1.0545315966010094, flat: 1.74286637455225, pod: 17.46208381652832, loss: 20.25948178768158 
Train [4/6] | Epoch [134/140] |	nca: 1.2153077647089958, flat: 1.7869617715477943, pod: 17.489115953445435, loss: 20.49138569831848 
Train [4/6] | Epoch [135/140] |	nca: 1.0968663096427917, flat: 1.758371241390705, pod: 17.581912398338318, loss: 20.4371497631073 
Train [4/6] | Epoch [136/140] |	nca: 1.1649155914783478, flat: 1.8076519221067429, pod: 17.683421850204468, loss: 20.655989289283752 
Train [4/6] | Epoch [137/140] |	nca: 1.1690208688378334, flat: 1.7622292190790176, pod: 17.517130851745605, loss: 20.448380827903748 
Train [4/6] | Epoch [138/140] |	nca: 1.091084998100996, flat: 1.7667493522167206, pod: 17.789863109588623, loss: 20.647697687149048 
Train [4/6] | Epoch [139/140] |	nca: 0.9992722235620022, flat: 1.771967664361, pod: 17.77319860458374, loss: 20.54443860054016 
Train [4/6] | Epoch [140/140] |	nca: 1.1047799177467823, flat: 1.7835702076554298, pod: 17.764142870903015, loss: 20.65249276161194 
after task
Building & updating memory.
after task
Eval on 0->8.
eval task
podnet_nme_cifar10_xsteps
Avg inc acc: 0.8644999999999999.
Current acc: {'total': 0.806, '00-09': 0.806}.
Avg inc acc top5: 0.9977499999999999.
Current acc top5: {'total': 0.994}.
Forgetting: 0.08249999999999996.
Cord metric: 0.83.
Old accuracy: 0.81, mean: 0.85.
New accuracy: 0.76, mean: 0.73.
================Task 4 Start!================
Testing on False unseen tasks (max class = 9).
Set memory of size: 1600.
Before task
Generating imprinted weights
Multi class diff kmeans.
Now 200 examplars per class.
Group: convnet, lr: 0.1.
Group: postprocessing, lr: 0.1.
Group: new_weights, lr: 0.1.
================Task 4 Training!================
The training samples number: 6600
Train on 8->9.
train task
nb 6600.
Train [5/6] | Epoch [1/120] |	nca: 20.28490662574768, flat: 12.209951996803284, pod: 80.1582932472229, loss: 112.65315163135529 
Train [5/6] | Epoch [2/120] |	nca: 12.371138349175453, flat: 7.127682454884052, pod: 63.47430503368378, loss: 82.97312593460083 
Train [5/6] | Epoch [3/120] |	nca: 10.322427660226822, flat: 6.4754655212163925, pod: 59.86442530155182, loss: 76.66231870651245 
Train [5/6] | Epoch [4/120] |	nca: 10.306629970669746, flat: 6.509504087269306, pod: 61.46843886375427, loss: 78.28457295894623 
Train [5/6] | Epoch [5/120] |	nca: 8.716810792684555, flat: 5.866555325686932, pod: 57.991713523864746, loss: 72.57507908344269 
Train [5/6] | Epoch [6/120] |	nca: 8.229760937392712, flat: 5.4979820773005486, pod: 53.84029120206833, loss: 67.56803464889526 
Train [5/6] | Epoch [7/120] |	nca: 7.651937715709209, flat: 5.63682509213686, pod: 56.080457985401154, loss: 69.36922061443329 
Train [5/6] | Epoch [8/120] |	nca: 7.417906790971756, flat: 5.152999557554722, pod: 52.05432140827179, loss: 64.62522768974304 
Train [5/6] | Epoch [9/120] |	nca: 7.019537638872862, flat: 5.296186618506908, pod: 54.195230424404144, loss: 66.51095461845398 
Train [5/6] | Epoch [10/120] |	nca: 7.928264074027538, flat: 5.507742561399937, pod: 54.82120203971863, loss: 68.25720918178558 
Train [5/6] | Epoch [11/120] |	nca: 6.635363884270191, flat: 5.158014595508575, pod: 53.17231398820877, loss: 64.96569240093231 
Train [5/6] | Epoch [12/120] |	nca: 6.327659718692303, flat: 5.125387392938137, pod: 52.63569122552872, loss: 64.088738322258 
Train [5/6] | Epoch [13/120] |	nca: 6.630194529891014, flat: 5.001808196306229, pod: 51.602580428123474, loss: 63.234583377838135 
Train [5/6] | Epoch [14/120] |	nca: 6.0973679684102535, flat: 4.997996486723423, pod: 51.9242342710495, loss: 63.019598960876465 
Train [5/6] | Epoch [15/120] |	nca: 6.069281041622162, flat: 4.875946424901485, pod: 52.47205197811127, loss: 63.41727948188782 
Train [5/6] | Epoch [16/120] |	nca: 6.809772402048111, flat: 4.905578963458538, pod: 50.50526708364487, loss: 62.22061824798584 
Train [5/6] | Epoch [17/120] |	nca: 6.242236629128456, flat: 4.872911423444748, pod: 51.95975333452225, loss: 63.07490122318268 
Train [5/6] | Epoch [18/120] |	nca: 5.3205893114209175, flat: 4.521299488842487, pod: 48.26543086767197, loss: 58.107319593429565 
Train [5/6] | Epoch [19/120] |	nca: 5.944400869309902, flat: 4.866722509264946, pod: 51.417894184589386, loss: 62.22901737689972 
Train [5/6] | Epoch [20/120] |	nca: 5.9364033080637455, flat: 4.8785137459635735, pod: 51.628944873809814, loss: 62.443862199783325 
Train [5/6] | Epoch [21/120] |	nca: 5.996630758047104, flat: 4.945774659514427, pod: 50.66023540496826, loss: 61.602641224861145 
Train [5/6] | Epoch [22/120] |	nca: 5.486456468701363, flat: 4.730560794472694, pod: 50.86480247974396, loss: 61.08182007074356 
Train [5/6] | Epoch [23/120] |	nca: 5.84470684081316, flat: 4.841024927794933, pod: 50.07413202524185, loss: 60.75986409187317 
Train [5/6] | Epoch [24/120] |	nca: 5.733330734074116, flat: 4.947149075567722, pod: 49.70387428998947, loss: 60.38435369729996 
Train [5/6] | Epoch [25/120] |	nca: 5.188430229201913, flat: 4.5729217156767845, pod: 48.40003949403763, loss: 58.1613911986351 
Train [5/6] | Epoch [26/120] |	nca: 5.260684862732887, flat: 4.679826602339745, pod: 48.920866787433624, loss: 58.8613783121109 
Train [5/6] | Epoch [27/120] |	nca: 5.432149514555931, flat: 4.550721719861031, pod: 47.70040452480316, loss: 57.68327569961548 
Train [5/6] | Epoch [28/120] |	nca: 5.6932535246014595, flat: 4.749161094427109, pod: 49.397094547748566, loss: 59.83950924873352 
Train [5/6] | Epoch [29/120] |	nca: 5.043639346957207, flat: 4.81734561175108, pod: 51.52487140893936, loss: 61.38585674762726 
Train [5/6] | Epoch [30/120] |	nca: 4.597184341400862, flat: 4.324556961655617, pod: 46.10264754295349, loss: 55.02438884973526 
Train [5/6] | Epoch [31/120] |	nca: 4.9945191740989685, flat: 4.437035486102104, pod: 47.911429047584534, loss: 57.34298348426819 
Train [5/6] | Epoch [32/120] |	nca: 4.989698346704245, flat: 4.418382249772549, pod: 46.46917366981506, loss: 55.87725442647934 
Train [5/6] | Epoch [33/120] |	nca: 4.896045241504908, flat: 4.404621906578541, pod: 45.268335580825806, loss: 54.56900256872177 
Train [5/6] | Epoch [34/120] |	nca: 5.081447634845972, flat: 4.48670993745327, pod: 48.10930287837982, loss: 57.67746013402939 
Train [5/6] | Epoch [35/120] |	nca: 5.256154589354992, flat: 4.806857280433178, pod: 47.8975595831871, loss: 57.96057152748108 
Train [5/6] | Epoch [36/120] |	nca: 4.433812350034714, flat: 4.328721471130848, pod: 46.32364600896835, loss: 55.08617955446243 
Train [5/6] | Epoch [37/120] |	nca: 4.39795845746994, flat: 4.199821140617132, pod: 45.214458882808685, loss: 53.81223863363266 
Train [5/6] | Epoch [38/120] |	nca: 4.896715953946114, flat: 4.1950328424572945, pod: 44.744092643260956, loss: 53.83584147691727 
Train [5/6] | Epoch [39/120] |	nca: 4.6089483089745045, flat: 4.161541920155287, pod: 43.908252596855164, loss: 52.67874312400818 
Train [5/6] | Epoch [40/120] |	nca: 4.6723899729549885, flat: 4.559180058538914, pod: 47.536816358566284, loss: 56.76838576793671 
Train [5/6] | Epoch [41/120] |	nca: 4.099105037748814, flat: 4.1736390590667725, pod: 44.3150976896286, loss: 52.58784145116806 
Train [5/6] | Epoch [42/120] |	nca: 4.527164235711098, flat: 4.17888506129384, pod: 45.07593768835068, loss: 53.781986951828 
Train [5/6] | Epoch [43/120] |	nca: 4.046689264476299, flat: 4.113799013197422, pod: 45.12904268503189, loss: 53.28953117132187 
Train [5/6] | Epoch [44/120] |	nca: 4.342205822467804, flat: 4.261196255683899, pod: 45.89744961261749, loss: 54.500851690769196 
Train [5/6] | Epoch [45/120] |	nca: 4.652100097388029, flat: 4.269625157117844, pod: 44.39677840471268, loss: 53.31850379705429 
Train [5/6] | Epoch [46/120] |	nca: 4.360579928383231, flat: 4.115411765873432, pod: 44.46764016151428, loss: 52.94363176822662 
Train [5/6] | Epoch [47/120] |	nca: 4.257211524993181, flat: 4.088681221008301, pod: 44.21015524864197, loss: 52.55604773759842 
Train [5/6] | Epoch [48/120] |	nca: 4.3741554990410805, flat: 4.336073510348797, pod: 44.79413503408432, loss: 53.5043643116951 
Train [5/6] | Epoch [49/120] |	nca: 4.134934604167938, flat: 4.083677738904953, pod: 44.822679460048676, loss: 53.0412917137146 
Train [5/6] | Epoch [50/120] |	nca: 3.497120726853609, flat: 3.7302899844944477, pod: 41.18420338630676, loss: 48.41161423921585 
Train [5/6] | Epoch [51/120] |	nca: 3.658837292343378, flat: 3.6313872933387756, pod: 39.29895770549774, loss: 46.58918237686157 
Train [5/6] | Epoch [52/120] |	nca: 4.109717797487974, flat: 3.8020770139992237, pod: 41.01145702600479, loss: 48.92325180768967 
Train [5/6] | Epoch [53/120] |	nca: 4.8647731095552444, flat: 4.094444461166859, pod: 42.71964228153229, loss: 51.678859651088715 
Train [5/6] | Epoch [54/120] |	nca: 3.9048458598554134, flat: 3.7254032604396343, pod: 40.67037206888199, loss: 48.30062121152878 
Train [5/6] | Epoch [55/120] |	nca: 4.159031648188829, flat: 3.991800509393215, pod: 41.94276922941208, loss: 50.09360134601593 
Train [5/6] | Epoch [56/120] |	nca: 3.737835370004177, flat: 3.640009392052889, pod: 39.78951919078827, loss: 47.16736418008804 
Train [5/6] | Epoch [57/120] |	nca: 4.128685299307108, flat: 3.9126987121999264, pod: 40.83692765235901, loss: 48.87831139564514 
Train [5/6] | Epoch [58/120] |	nca: 3.7727509662508965, flat: 3.700875885784626, pod: 40.51815927028656, loss: 47.99178618192673 
Train [5/6] | Epoch [59/120] |	nca: 3.3971475288271904, flat: 3.5012287087738514, pod: 37.39680373668671, loss: 44.29518008232117 
Train [5/6] | Epoch [60/120] |	nca: 3.5078870952129364, flat: 3.4817788302898407, pod: 38.40316069126129, loss: 45.39282667636871 
Train [5/6] | Epoch [61/120] |	nca: 3.468870759010315, flat: 3.4779704101383686, pod: 37.91990828514099, loss: 44.8667494058609 
Train [5/6] | Epoch [62/120] |	nca: 3.4319869186729193, flat: 3.620459910482168, pod: 39.53294229507446, loss: 46.58538889884949 
Train [5/6] | Epoch [63/120] |	nca: 3.470573952421546, flat: 3.54987820237875, pod: 38.55193656682968, loss: 45.57238858938217 
Train [5/6] | Epoch [64/120] |	nca: 3.4702325873076916, flat: 3.3922170735895634, pod: 38.56823539733887, loss: 45.43068504333496 
Train [5/6] | Epoch [65/120] |	nca: 3.860146190971136, flat: 3.4890732057392597, pod: 38.44247478246689, loss: 45.7916944026947 
Train [5/6] | Epoch [66/120] |	nca: 3.126675348728895, flat: 3.336437474936247, pod: 36.617251098155975, loss: 43.08036398887634 
Train [5/6] | Epoch [67/120] |	nca: 3.395845279097557, flat: 3.464711781591177, pod: 38.079689621925354, loss: 44.94024682044983 
Train [5/6] | Epoch [68/120] |	nca: 2.8589685950428247, flat: 3.2814763076603413, pod: 36.77555179595947, loss: 42.91599678993225 
Train [5/6] | Epoch [69/120] |	nca: 2.8404191862791777, flat: 3.3253877460956573, pod: 36.77378845214844, loss: 42.939595460891724 
Train [5/6] | Epoch [70/120] |	nca: 3.190470727160573, flat: 3.3230035081505775, pod: 35.92112463712692, loss: 42.43459892272949 
Train [5/6] | Epoch [71/120] |	nca: 3.149961180984974, flat: 3.186977796256542, pod: 35.04260152578354, loss: 41.379540741443634 
Train [5/6] | Epoch [72/120] |	nca: 2.86807369440794, flat: 3.136753376573324, pod: 34.20096963644028, loss: 40.20579671859741 
Train [5/6] | Epoch [73/120] |	nca: 2.751230264082551, flat: 3.0613043271005154, pod: 34.01279401779175, loss: 39.82532870769501 
Train [5/6] | Epoch [74/120] |	nca: 2.9073136262595654, flat: 3.0484808273613453, pod: 34.50604408979416, loss: 40.46183854341507 
Train [5/6] | Epoch [75/120] |	nca: 2.606493080034852, flat: 2.992371618747711, pod: 33.497562408447266, loss: 39.09642708301544 
Train [5/6] | Epoch [76/120] |	nca: 2.5801860336214304, flat: 2.8611869253218174, pod: 33.157063484191895, loss: 38.598436415195465 
Train [5/6] | Epoch [77/120] |	nca: 2.663789616897702, flat: 2.897140882909298, pod: 32.427448987960815, loss: 37.988379657268524 
Train [5/6] | Epoch [78/120] |	nca: 2.4677594043314457, flat: 2.9664549976587296, pod: 33.58062785863876, loss: 39.01484227180481 
Train [5/6] | Epoch [79/120] |	nca: 2.6167063787579536, flat: 2.8924145810306072, pod: 32.29491513967514, loss: 37.804036021232605 
Train [5/6] | Epoch [80/120] |	nca: 2.5270159021019936, flat: 2.8446513451635838, pod: 31.289508819580078, loss: 36.6611762046814 
Train [5/6] | Epoch [81/120] |	nca: 2.5608980674296618, flat: 2.897422481328249, pod: 32.33741897344589, loss: 37.79573971033096 
Train [5/6] | Epoch [82/120] |	nca: 2.4051649775356054, flat: 2.8434806875884533, pod: 31.339520007371902, loss: 36.588165521621704 
Train [5/6] | Epoch [83/120] |	nca: 2.405907526612282, flat: 2.739512827247381, pod: 30.93795120716095, loss: 36.083371579647064 
Train [5/6] | Epoch [84/120] |	nca: 2.3666820731014013, flat: 2.881622150540352, pod: 31.86561417579651, loss: 37.11391860246658 
Train [5/6] | Epoch [85/120] |	nca: 2.4939040653407574, flat: 2.7172650918364525, pod: 29.513647884130478, loss: 34.72481715679169 
Train [5/6] | Epoch [86/120] |	nca: 2.41027688421309, flat: 2.772745680063963, pod: 29.876756638288498, loss: 35.05977898836136 
Train [5/6] | Epoch [87/120] |	nca: 2.2450337298214436, flat: 2.7164239399135113, pod: 30.54417046904564, loss: 35.50562804937363 
Train [5/6] | Epoch [88/120] |	nca: 2.3782350458204746, flat: 2.65142722427845, pod: 28.98262047767639, loss: 34.012282729148865 
Train [5/6] | Epoch [89/120] |	nca: 2.301756512373686, flat: 2.7608917951583862, pod: 29.75441300868988, loss: 34.81706124544144 
Train [5/6] | Epoch [90/120] |	nca: 2.3319356348365545, flat: 2.6653747223317623, pod: 28.699355453252792, loss: 33.696666061878204 
Train [5/6] | Epoch [91/120] |	nca: 2.110293446108699, flat: 2.5583054460585117, pod: 27.527948319911957, loss: 32.19654721021652 
Train [5/6] | Epoch [92/120] |	nca: 2.226407004520297, flat: 2.600636698305607, pod: 28.46681782603264, loss: 33.29386156797409 
Train [5/6] | Epoch [93/120] |	nca: 2.2178077679127455, flat: 2.5547147691249847, pod: 27.00279688835144, loss: 31.775319397449493 
Train [5/6] | Epoch [94/120] |	nca: 2.1302045229822397, flat: 2.50105981528759, pod: 27.212042927742004, loss: 31.843307316303253 
Train [5/6] | Epoch [95/120] |	nca: 2.108051845803857, flat: 2.496838741004467, pod: 27.029350727796555, loss: 31.634241223335266 
Train [5/6] | Epoch [96/120] |	nca: 2.1125007290393114, flat: 2.4307308234274387, pod: 26.779022067785263, loss: 31.32225352525711 
Train [5/6] | Epoch [97/120] |	nca: 2.1470080856233835, flat: 2.3845480382442474, pod: 25.00097206234932, loss: 29.53252810239792 
Train [5/6] | Epoch [98/120] |	nca: 1.995761590078473, flat: 2.317764028906822, pod: 24.253585904836655, loss: 28.567111611366272 
Train [5/6] | Epoch [99/120] |	nca: 2.091452468186617, flat: 2.3195900954306126, pod: 24.968852430582047, loss: 29.379894882440567 
Train [5/6] | Epoch [100/120] |	nca: 1.9824919793754816, flat: 2.4488018192350864, pod: 25.802591621875763, loss: 30.233885437250137 
Train [5/6] | Epoch [101/120] |	nca: 2.0457589477300644, flat: 2.402496375143528, pod: 24.992396891117096, loss: 29.440652430057526 
Train [5/6] | Epoch [102/120] |	nca: 2.0988101921975613, flat: 2.366740111261606, pod: 24.7237608730793, loss: 29.1893113553524 
Train [5/6] | Epoch [103/120] |	nca: 2.098596826195717, flat: 2.3403878286480904, pod: 23.250669598579407, loss: 27.689654141664505 
Train [5/6] | Epoch [104/120] |	nca: 2.0500475112348795, flat: 2.289494749158621, pod: 23.5164612531662, loss: 27.856003761291504 
Train [5/6] | Epoch [105/120] |	nca: 1.9885223172605038, flat: 2.327675126492977, pod: 23.857470005750656, loss: 28.173667460680008 
Train [5/6] | Epoch [106/120] |	nca: 1.993636541068554, flat: 2.2344133146107197, pod: 23.07060593366623, loss: 27.29865574836731 
Train [5/6] | Epoch [107/120] |	nca: 1.9794984217733145, flat: 2.2141799591481686, pod: 22.393388152122498, loss: 26.58706659078598 
Train [5/6] | Epoch [108/120] |	nca: 1.968580637127161, flat: 2.1837647035717964, pod: 22.26819407939911, loss: 26.420539677143097 
Train [5/6] | Epoch [109/120] |	nca: 1.9716410357505083, flat: 2.22423879429698, pod: 22.347428798675537, loss: 26.543308526277542 
Train [5/6] | Epoch [110/120] |	nca: 2.007870903238654, flat: 2.2163974829018116, pod: 21.848882794380188, loss: 26.073151260614395 
Train [5/6] | Epoch [111/120] |	nca: 1.878143297508359, flat: 2.188410848379135, pod: 21.64450079202652, loss: 25.711055129766464 
Train [5/6] | Epoch [112/120] |	nca: 1.988709969446063, flat: 2.178582277148962, pod: 22.079824775457382, loss: 26.247116953134537 
Train [5/6] | Epoch [113/120] |	nca: 1.9005516804754734, flat: 2.1745432130992413, pod: 22.07987344264984, loss: 26.154968470335007 
Train [5/6] | Epoch [114/120] |	nca: 2.0282020773738623, flat: 2.116846948862076, pod: 20.984046638011932, loss: 25.129095643758774 
Train [5/6] | Epoch [115/120] |	nca: 2.0228445511311293, flat: 2.187427245080471, pod: 21.129667848348618, loss: 25.33993971347809 
Train [5/6] | Epoch [116/120] |	nca: 1.910536790266633, flat: 2.158719088882208, pod: 20.550882160663605, loss: 24.62013804912567 
Train [5/6] | Epoch [117/120] |	nca: 1.8473447617143393, flat: 2.127654630690813, pod: 20.910037964582443, loss: 24.885037302970886 
Train [5/6] | Epoch [118/120] |	nca: 1.8401724509894848, flat: 2.1631655171513557, pod: 20.667175143957138, loss: 24.670512974262238 
Train [5/6] | Epoch [119/120] |	nca: 2.0010429229587317, flat: 2.169543117284775, pod: 21.201026380062103, loss: 25.371612399816513 
Train [5/6] | Epoch [120/120] |	nca: 1.9732779040932655, flat: 2.1446959748864174, pod: 21.010093718767166, loss: 25.1280677318573 
Fine-tuning
Building & updating memory.
Train [5/6] | Epoch [121/140] |	nca: 8.211869031190872, flat: 3.9634046405553818, pod: 25.683664083480835, loss: 37.85893785953522 
Train [5/6] | Epoch [122/140] |	nca: 3.6269111335277557, flat: 3.635834187269211, pod: 25.079354763031006, loss: 32.34209990501404 
Train [5/6] | Epoch [123/140] |	nca: 2.857402205467224, flat: 3.306612953543663, pod: 24.27851164340973, loss: 30.442527055740356 
Train [5/6] | Epoch [124/140] |	nca: 1.8864696770906448, flat: 3.575327768921852, pod: 24.840709447860718, loss: 30.302507162094116 
Train [5/6] | Epoch [125/140] |	nca: 2.5402531027793884, flat: 3.340306267142296, pod: 23.961049795150757, loss: 29.841609239578247 
Train [5/6] | Epoch [126/140] |	nca: 3.5608261451125145, flat: 3.629329189658165, pod: 25.33084547519684, loss: 32.52100121974945 
Train [5/6] | Epoch [127/140] |	nca: 2.4040598198771477, flat: 3.745758280158043, pod: 25.193999528884888, loss: 31.343817830085754 
Train [5/6] | Epoch [128/140] |	nca: 1.8253174647688866, flat: 3.6574555933475494, pod: 24.81318688392639, loss: 30.295960068702698 
Train [5/6] | Epoch [129/140] |	nca: 1.4598059803247452, flat: 3.3406512439250946, pod: 24.397254586219788, loss: 29.197712063789368 
Train [5/6] | Epoch [130/140] |	nca: 1.6629532277584076, flat: 3.319371737539768, pod: 24.510523676872253, loss: 29.49284851551056 
Train [5/6] | Epoch [131/140] |	nca: 1.859082005918026, flat: 3.524555817246437, pod: 24.8330317735672, loss: 30.21666944026947 
Train [5/6] | Epoch [132/140] |	nca: 1.2306707501411438, flat: 3.4493292719125748, pod: 24.771878480911255, loss: 29.4518780708313 
Train [5/6] | Epoch [133/140] |	nca: 1.7960641905665398, flat: 3.430357441306114, pod: 24.811089038848877, loss: 30.037510633468628 
Train [5/6] | Epoch [134/140] |	nca: 1.2402453981339931, flat: 3.498240679502487, pod: 24.60449504852295, loss: 29.34298062324524 
Train [5/6] | Epoch [135/140] |	nca: 1.4264982789754868, flat: 3.485907107591629, pod: 25.248985052108765, loss: 30.16139054298401 
Train [5/6] | Epoch [136/140] |	nca: 1.3655425943434238, flat: 3.4134095907211304, pod: 24.41877043247223, loss: 29.197722911834717 
Train [5/6] | Epoch [137/140] |	nca: 1.1630893871188164, flat: 3.4958790093660355, pod: 24.55531072616577, loss: 29.214279174804688 
Train [5/6] | Epoch [138/140] |	nca: 1.071656383574009, flat: 3.337293654680252, pod: 23.941619515419006, loss: 28.350569486618042 
Train [5/6] | Epoch [139/140] |	nca: 1.7884057611227036, flat: 3.415627419948578, pod: 24.95563805103302, loss: 30.159671306610107 
Train [5/6] | Epoch [140/140] |	nca: 1.868496060371399, flat: 3.3883360475301743, pod: 24.131495356559753, loss: 29.388327479362488 
after task
Building & updating memory.
after task
Eval on 0->9.
eval task
podnet_nme_cifar10_xsteps
Avg inc acc: 0.8480000000000001.
Current acc: {'total': 0.782, '00-09': 0.782}.
Avg inc acc top5: 0.9965999999999999.
Current acc top5: {'total': 0.992}.
Forgetting: 0.09449999999999997.
Cord metric: 0.81.
Old accuracy: 0.79, mean: 0.83.
New accuracy: 0.74, mean: 0.73.
================Task 5 Start!================
Testing on False unseen tasks (max class = 10).
Set memory of size: 1800.
Before task
Generating imprinted weights
Multi class diff kmeans.
Now 200 examplars per class.
Group: convnet, lr: 0.1.
Group: postprocessing, lr: 0.1.
Group: new_weights, lr: 0.1.
================Task 5 Training!================
The training samples number: 6800
Train on 9->10.
train task
nb 6800.
Train [6/6] | Epoch [1/120] |	nca: 28.23589563369751, flat: 8.163622818887234, pod: 85.8684949874878, loss: 122.26801323890686 
Train [6/6] | Epoch [2/120] |	nca: 22.425554424524307, flat: 8.15955300629139, pod: 90.51308536529541, loss: 121.09819304943085 
Train [6/6] | Epoch [3/120] |	nca: 20.51880645751953, flat: 7.332991495728493, pod: 84.51146900653839, loss: 112.36326694488525 
Train [6/6] | Epoch [4/120] |	nca: 18.655470117926598, flat: 6.784153066575527, pod: 80.3251382112503, loss: 105.76476120948792 
Train [6/6] | Epoch [5/120] |	nca: 16.283216886222363, flat: 6.1799221858382225, pod: 75.98408114910126, loss: 98.44722068309784 
Train [6/6] | Epoch [6/120] |	nca: 14.27109344303608, flat: 5.297398716211319, pod: 68.20145857334137, loss: 87.76995062828064 
Train [6/6] | Epoch [7/120] |	nca: 13.470312252640724, flat: 5.081645652651787, pod: 66.23507106304169, loss: 84.78702902793884 
Train [6/6] | Epoch [8/120] |	nca: 12.364954926073551, flat: 4.880470544099808, pod: 64.46652841567993, loss: 81.71195363998413 
Train [6/6] | Epoch [9/120] |	nca: 12.509798161685467, flat: 4.847268484532833, pod: 63.43609166145325, loss: 80.79315865039825 
Train [6/6] | Epoch [10/120] |	nca: 14.535473555326462, flat: 6.198254309594631, pod: 71.32291758060455, loss: 92.05664539337158 
Train [6/6] | Epoch [11/120] |	nca: 12.609835378825665, flat: 5.391812384128571, pod: 66.16253781318665, loss: 84.16418552398682 
Train [6/6] | Epoch [12/120] |	nca: 11.252777591347694, flat: 4.712123721837997, pod: 60.956371903419495, loss: 76.92127311229706 
Train [6/6] | Epoch [13/120] |	nca: 11.435910977423191, flat: 5.202687785029411, pod: 66.36688041687012, loss: 83.00547909736633 
Train [6/6] | Epoch [14/120] |	nca: 11.325456216931343, flat: 5.26298575848341, pod: 67.51789331436157, loss: 84.10633492469788 
Train [6/6] | Epoch [15/120] |	nca: 11.31803061813116, flat: 4.840320557355881, pod: 61.583956480026245, loss: 77.742307305336 
Train [6/6] | Epoch [16/120] |	nca: 12.363132186233997, flat: 5.5900256261229515, pod: 68.92117917537689, loss: 86.87433660030365 
Train [6/6] | Epoch [17/120] |	nca: 9.432002432644367, flat: 4.622560888528824, pod: 60.34904193878174, loss: 74.40360534191132 
Train [6/6] | Epoch [18/120] |	nca: 11.345424458384514, flat: 5.629866503179073, pod: 67.22467648983002, loss: 84.19996726512909 
Train [6/6] | Epoch [19/120] |	nca: 8.968451023101807, flat: 4.52156213670969, pod: 60.195925533771515, loss: 73.68593895435333 
Train [6/6] | Epoch [20/120] |	nca: 9.12543549388647, flat: 4.690512269735336, pod: 60.017796099185944, loss: 73.83374381065369 
Train [6/6] | Epoch [21/120] |	nca: 10.592153534293175, flat: 4.844703547656536, pod: 62.360245287418365, loss: 77.79710245132446 
Train [6/6] | Epoch [22/120] |	nca: 11.311742521822453, flat: 5.184569463133812, pod: 64.57633191347122, loss: 81.07264423370361 
Train [6/6] | Epoch [23/120] |	nca: 9.061279863119125, flat: 4.792760230600834, pod: 61.23705530166626, loss: 75.09109508991241 
Train [6/6] | Epoch [24/120] |	nca: 10.5075623691082, flat: 4.831357955932617, pod: 60.938908994197845, loss: 76.27782940864563 
Train [6/6] | Epoch [25/120] |	nca: 10.289016157388687, flat: 5.160908877849579, pod: 61.95358169078827, loss: 77.40350723266602 
Train [6/6] | Epoch [26/120] |	nca: 9.965054109692574, flat: 4.966144427657127, pod: 61.78715068101883, loss: 76.7183495759964 
Train [6/6] | Epoch [27/120] |	nca: 8.79972019791603, flat: 4.514359347522259, pod: 59.423919320106506, loss: 72.73799872398376 
Train [6/6] | Epoch [28/120] |	nca: 10.277458928525448, flat: 5.091294698417187, pod: 63.68345767259598, loss: 79.05221128463745 
Train [6/6] | Epoch [29/120] |	nca: 9.757585816085339, flat: 4.718710117042065, pod: 60.57271033525467, loss: 75.04900658130646 
Train [6/6] | Epoch [30/120] |	nca: 9.557056449353695, flat: 4.963049307465553, pod: 62.32085210084915, loss: 76.84095788002014 
Train [6/6] | Epoch [31/120] |	nca: 8.69174512475729, flat: 4.407644025981426, pod: 57.2468838095665, loss: 70.34627294540405 
Train [6/6] | Epoch [32/120] |	nca: 11.155596137046814, flat: 5.596585422754288, pod: 65.92412400245667, loss: 82.67630505561829 
Train [6/6] | Epoch [33/120] |	nca: 7.877994768321514, flat: 4.432482089847326, pod: 58.094102561473846, loss: 70.40457940101624 
Train [6/6] | Epoch [34/120] |	nca: 9.018290132284164, flat: 4.651916667819023, pod: 59.06621825695038, loss: 72.7364251613617 
Train [6/6] | Epoch [35/120] |	nca: 9.655244871973991, flat: 5.444918788969517, pod: 63.33069485425949, loss: 78.43085861206055 
Train [6/6] | Epoch [36/120] |	nca: 8.67230261862278, flat: 4.517059922218323, pod: 56.8438116312027, loss: 70.03317415714264 
Train [6/6] | Epoch [37/120] |	nca: 7.3528914749622345, flat: 4.0626455917954445, pod: 53.71352976560593, loss: 65.12906634807587 
Train [6/6] | Epoch [38/120] |	nca: 8.056952223181725, flat: 4.354003436863422, pod: 55.834691762924194, loss: 68.24564790725708 
Train [6/6] | Epoch [39/120] |	nca: 9.341769203543663, flat: 4.91866260021925, pod: 62.02394777536392, loss: 76.28437995910645 
Train [6/6] | Epoch [40/120] |	nca: 8.477418303489685, flat: 4.241213697940111, pod: 55.331358790397644, loss: 68.04999077320099 
Train [6/6] | Epoch [41/120] |	nca: 7.351272724568844, flat: 4.113072387874126, pod: 52.81079053878784, loss: 64.27513539791107 
Train [6/6] | Epoch [42/120] |	nca: 7.836000323295593, flat: 4.346589282155037, pod: 56.03310751914978, loss: 68.21569752693176 
Train [6/6] | Epoch [43/120] |	nca: 10.799630850553513, flat: 5.4212450459599495, pod: 64.34890884160995, loss: 80.56978440284729 
Train [6/6] | Epoch [44/120] |	nca: 6.741158951073885, flat: 4.465337418019772, pod: 57.21803653240204, loss: 68.42453271150589 
Train [6/6] | Epoch [45/120] |	nca: 6.377029158174992, flat: 4.058335926383734, pod: 54.01761996746063, loss: 64.45298498868942 
Train [6/6] | Epoch [46/120] |	nca: 6.395778872072697, flat: 3.8206478729844093, pod: 52.46736681461334, loss: 62.68379336595535 
Train [6/6] | Epoch [47/120] |	nca: 6.84842436388135, flat: 3.9273226223886013, pod: 52.417167127132416, loss: 63.19291424751282 
Train [6/6] | Epoch [48/120] |	nca: 7.530376698821783, flat: 4.260308124125004, pod: 55.892779648303986, loss: 67.68346405029297 
Train [6/6] | Epoch [49/120] |	nca: 7.606088727712631, flat: 4.320508524775505, pod: 55.869724333286285, loss: 67.79632139205933 
Train [6/6] | Epoch [50/120] |	nca: 7.50892049074173, flat: 4.616005089133978, pod: 56.12195920944214, loss: 68.24688452482224 
Train [6/6] | Epoch [51/120] |	nca: 5.845686249434948, flat: 3.8619973734021187, pod: 52.731758654117584, loss: 62.439442336559296 
Train [6/6] | Epoch [52/120] |	nca: 5.93363494426012, flat: 3.742531105875969, pod: 51.41786462068558, loss: 61.0940306186676 
Train [6/6] | Epoch [53/120] |	nca: 5.380920447409153, flat: 3.5137414522469044, pod: 49.14394801855087, loss: 58.03861004114151 
Train [6/6] | Epoch [54/120] |	nca: 6.93648337572813, flat: 3.9512042552232742, pod: 53.536385238170624, loss: 64.42407274246216 
Train [6/6] | Epoch [55/120] |	nca: 8.451114751398563, flat: 4.608034409582615, pod: 57.946497559547424, loss: 71.0056471824646 
Train [6/6] | Epoch [56/120] |	nca: 6.415406081825495, flat: 4.0083374455571175, pod: 52.98439210653305, loss: 63.408135652542114 
Train [6/6] | Epoch [57/120] |	nca: 5.522279754281044, flat: 3.5895511023700237, pod: 49.839636981487274, loss: 58.951467871665955 
Train [6/6] | Epoch [58/120] |	nca: 5.680572967976332, flat: 3.4099695459008217, pod: 46.81741279363632, loss: 55.9079555273056 
Train [6/6] | Epoch [59/120] |	nca: 8.648187793791294, flat: 4.6756597720086575, pod: 56.619672417640686, loss: 69.94351994991302 
Train [6/6] | Epoch [60/120] |	nca: 5.175309490412474, flat: 3.484091930091381, pod: 49.090308010578156, loss: 57.74970930814743 
Train [6/6] | Epoch [61/120] |	nca: 5.666963525116444, flat: 3.487265195697546, pod: 48.88452959060669, loss: 58.038758635520935 
Train [6/6] | Epoch [62/120] |	nca: 5.197210963815451, flat: 3.572572208940983, pod: 48.737016916275024, loss: 57.5067999958992 
Train [6/6] | Epoch [63/120] |	nca: 5.134826496243477, flat: 3.5437475219368935, pod: 48.71529918909073, loss: 57.393873274326324 
Train [6/6] | Epoch [64/120] |	nca: 6.352141812443733, flat: 3.7673909217119217, pod: 51.35429722070694, loss: 61.473830461502075 
Train [6/6] | Epoch [65/120] |	nca: 4.640713818371296, flat: 3.2389803417026997, pod: 45.450428664684296, loss: 53.33012276887894 
Train [6/6] | Epoch [66/120] |	nca: 5.319138962775469, flat: 3.480941355228424, pod: 46.79188942909241, loss: 55.59196978807449 
Train [6/6] | Epoch [67/120] |	nca: 4.900933161377907, flat: 3.3795048967003822, pod: 46.422661662101746, loss: 54.70309954881668 
Train [6/6] | Epoch [68/120] |	nca: 5.523890696465969, flat: 3.633714396506548, pod: 48.39960217475891, loss: 57.557207107543945 
Train [6/6] | Epoch [69/120] |	nca: 4.2526140958070755, flat: 3.0771550610661507, pod: 43.6472909450531, loss: 50.97706025838852 
Train [6/6] | Epoch [70/120] |	nca: 3.896029233932495, flat: 3.1457988619804382, pod: 43.60372084379196, loss: 50.64554888010025 
Train [6/6] | Epoch [71/120] |	nca: 3.6400245279073715, flat: 3.0023322589695454, pod: 43.6578973531723, loss: 50.30025368928909 
Train [6/6] | Epoch [72/120] |	nca: 3.805594850331545, flat: 2.902272332459688, pod: 41.18369817733765, loss: 47.89156550168991 
Train [6/6] | Epoch [73/120] |	nca: 3.711974496021867, flat: 2.8759724348783493, pod: 42.339632511138916, loss: 48.92757934331894 
Train [6/6] | Epoch [74/120] |	nca: 3.9786159619688988, flat: 2.8771541006863117, pod: 40.95467185974121, loss: 47.810441851615906 
Train [6/6] | Epoch [75/120] |	nca: 3.853664956986904, flat: 2.992053046822548, pod: 43.26834565401077, loss: 50.11406356096268 
Train [6/6] | Epoch [76/120] |	nca: 3.674856150522828, flat: 2.8064093366265297, pod: 40.981672048568726, loss: 47.46293771266937 
Train [6/6] | Epoch [77/120] |	nca: 3.9476134665310383, flat: 2.852212466299534, pod: 40.779615581035614, loss: 47.5794415473938 
Train [6/6] | Epoch [78/120] |	nca: 3.87442858889699, flat: 2.8397153057157993, pod: 39.99887025356293, loss: 46.71301394701004 
Train [6/6] | Epoch [79/120] |	nca: 3.358731145039201, flat: 2.764991357922554, pod: 40.577282190322876, loss: 46.701004564762115 
Train [6/6] | Epoch [80/120] |	nca: 3.211140062659979, flat: 2.680299013853073, pod: 39.20090061426163, loss: 45.092339873313904 
Train [6/6] | Epoch [81/120] |	nca: 3.647246837615967, flat: 2.6206757687032223, pod: 38.004336178302765, loss: 44.27225863933563 
Train [6/6] | Epoch [82/120] |	nca: 3.297945313155651, flat: 2.6672718450427055, pod: 39.14921075105667, loss: 45.114427626132965 
Train [6/6] | Epoch [83/120] |	nca: 3.3833707347512245, flat: 2.5330293513834476, pod: 36.24984699487686, loss: 42.1662472486496 
Train [6/6] | Epoch [84/120] |	nca: 3.0583281964063644, flat: 2.5882024355232716, pod: 38.66836875677109, loss: 44.31489938497543 
Train [6/6] | Epoch [85/120] |	nca: 3.3003398198634386, flat: 2.3966806568205357, pod: 35.48032706975937, loss: 41.17734754085541 
Train [6/6] | Epoch [86/120] |	nca: 3.2386759743094444, flat: 2.6432144343852997, pod: 38.55047333240509, loss: 44.43236345052719 
Train [6/6] | Epoch [87/120] |	nca: 2.9329463709145784, flat: 2.4258786477148533, pod: 35.80607479810715, loss: 41.16489964723587 
Train [6/6] | Epoch [88/120] |	nca: 3.0236733444035053, flat: 2.3250675536692142, pod: 35.30812120437622, loss: 40.6568620800972 
Train [6/6] | Epoch [89/120] |	nca: 2.947468439117074, flat: 2.2820089533925056, pod: 33.84063416719437, loss: 39.0701117515564 
Train [6/6] | Epoch [90/120] |	nca: 2.515901081264019, flat: 2.358007289469242, pod: 35.18638753890991, loss: 40.060295939445496 
Train [6/6] | Epoch [91/120] |	nca: 2.912293318659067, flat: 2.416628334671259, pod: 35.099226117134094, loss: 40.42814785242081 
Train [6/6] | Epoch [92/120] |	nca: 2.599550684913993, flat: 2.22926046513021, pod: 33.15116894245148, loss: 37.979980170726776 
Train [6/6] | Epoch [93/120] |	nca: 2.6883754804730415, flat: 2.263927089050412, pod: 34.678636372089386, loss: 39.630938947200775 
Train [6/6] | Epoch [94/120] |	nca: 2.5902579594403505, flat: 2.257285075262189, pod: 33.89005729556084, loss: 38.737600326538086 
Train [6/6] | Epoch [95/120] |	nca: 2.8378196079283953, flat: 2.1234328895807266, pod: 31.854498893022537, loss: 36.81575149297714 
Train [6/6] | Epoch [96/120] |	nca: 2.6625992469489574, flat: 2.1955931447446346, pod: 31.072087168693542, loss: 35.9302796125412 
Train [6/6] | Epoch [97/120] |	nca: 2.7290078084915876, flat: 2.236784003674984, pod: 32.684212267398834, loss: 37.650004148483276 
Train [6/6] | Epoch [98/120] |	nca: 2.6238005235791206, flat: 2.121292484924197, pod: 31.34770616889, loss: 36.09279918670654 
Train [6/6] | Epoch [99/120] |	nca: 3.07495572976768, flat: 2.1554310843348503, pod: 31.956830322742462, loss: 37.187217116355896 
Train [6/6] | Epoch [100/120] |	nca: 2.854989506304264, flat: 2.1665711775422096, pod: 30.766608774662018, loss: 35.788169503211975 
Train [6/6] | Epoch [101/120] |	nca: 2.547534177079797, flat: 2.043797602877021, pod: 29.920765340328217, loss: 34.512096881866455 
Train [6/6] | Epoch [102/120] |	nca: 2.472475755959749, flat: 2.0424543358385563, pod: 29.74431547522545, loss: 34.25924554467201 
Train [6/6] | Epoch [103/120] |	nca: 2.8777098432183266, flat: 1.9878272600471973, pod: 29.810055822134018, loss: 34.67559289932251 
Train [6/6] | Epoch [104/120] |	nca: 2.5772532913833857, flat: 2.098878961056471, pod: 29.079490512609482, loss: 33.75562286376953 
Train [6/6] | Epoch [105/120] |	nca: 2.3883202094584703, flat: 2.0151558071374893, pod: 28.518794685602188, loss: 32.922270476818085 
Train [6/6] | Epoch [106/120] |	nca: 2.780149158090353, flat: 2.140797918662429, pod: 30.507206618785858, loss: 35.42815366387367 
Train [6/6] | Epoch [107/120] |	nca: 2.1958077251911163, flat: 1.9622533340007067, pod: 28.01120775938034, loss: 32.169268906116486 
Train [6/6] | Epoch [108/120] |	nca: 2.1673351787030697, flat: 1.8333073779940605, pod: 26.989862591028214, loss: 30.990505158901215 
Train [6/6] | Epoch [109/120] |	nca: 2.1395475026220083, flat: 1.864614250138402, pod: 27.397381216287613, loss: 31.401543021202087 
Train [6/6] | Epoch [110/120] |	nca: 2.168349601328373, flat: 1.9065833222121, pod: 27.942975729703903, loss: 32.017908692359924 
Train [6/6] | Epoch [111/120] |	nca: 2.40264299698174, flat: 1.886583860963583, pod: 27.31081634759903, loss: 31.600043296813965 
Train [6/6] | Epoch [112/120] |	nca: 2.257376153022051, flat: 1.8760347105562687, pod: 27.798025131225586, loss: 31.931436091661453 
Train [6/6] | Epoch [113/120] |	nca: 2.2381153348833323, flat: 1.8574287984520197, pod: 26.782779276371002, loss: 30.878323286771774 
Train [6/6] | Epoch [114/120] |	nca: 2.159443961456418, flat: 1.9101167563349009, pod: 27.99381124973297, loss: 32.063372015953064 
Train [6/6] | Epoch [115/120] |	nca: 2.0833646059036255, flat: 1.8132751509547234, pod: 26.112540066242218, loss: 30.009180009365082 
Train [6/6] | Epoch [116/120] |	nca: 2.3222661055624485, flat: 1.8544059097766876, pod: 26.888758093118668, loss: 31.065430134534836 
Train [6/6] | Epoch [117/120] |	nca: 2.063987782225013, flat: 1.7443694062530994, pod: 25.457468271255493, loss: 29.265825361013412 
Train [6/6] | Epoch [118/120] |	nca: 2.129020994529128, flat: 1.7903815153986216, pod: 25.363923519849777, loss: 29.28332617878914 
Train [6/6] | Epoch [119/120] |	nca: 2.0608661249279976, flat: 1.9385380148887634, pod: 27.778928369283676, loss: 31.778332471847534 
Train [6/6] | Epoch [120/120] |	nca: 2.0514321234077215, flat: 1.9097263608127832, pod: 27.34501427412033, loss: 31.30617269873619 
Fine-tuning
Building & updating memory.
Train [6/6] | Epoch [121/140] |	nca: 6.190509274601936, flat: 1.5422332882881165, pod: 18.97623038291931, loss: 26.708972811698914 
Train [6/6] | Epoch [122/140] |	nca: 2.139509215950966, flat: 1.6499427370727062, pod: 19.56033343076706, loss: 23.349785208702087 
Train [6/6] | Epoch [123/140] |	nca: 1.4259268566966057, flat: 1.5780670046806335, pod: 19.184662580490112, loss: 22.18865656852722 
Train [6/6] | Epoch [124/140] |	nca: 1.4598780274391174, flat: 1.6045784652233124, pod: 19.150577187538147, loss: 22.215033769607544 
Train [6/6] | Epoch [125/140] |	nca: 1.2179326601326466, flat: 1.5946479812264442, pod: 19.018911123275757, loss: 21.831491708755493 
Train [6/6] | Epoch [126/140] |	nca: 1.3335066922008991, flat: 1.6306715458631516, pod: 19.346660256385803, loss: 22.31083858013153 
Train [6/6] | Epoch [127/140] |	nca: 1.3772610388696194, flat: 1.6337915882468224, pod: 19.223295152187347, loss: 22.234347820281982 
Train [6/6] | Epoch [128/140] |	nca: 1.1759342141449451, flat: 1.5855074748396873, pod: 19.08273959159851, loss: 21.844181418418884 
Train [6/6] | Epoch [129/140] |	nca: 1.0836119055747986, flat: 1.5693509429693222, pod: 19.02192860841751, loss: 21.674891233444214 
Train [6/6] | Epoch [130/140] |	nca: 1.1275981403887272, flat: 1.58637785166502, pod: 19.088377118110657, loss: 21.802352905273438 
Train [6/6] | Epoch [131/140] |	nca: 1.239206925034523, flat: 1.6053428947925568, pod: 19.192901015281677, loss: 22.037450909614563 
Train [6/6] | Epoch [132/140] |	nca: 1.2184858433902264, flat: 1.6157227829098701, pod: 19.153555989265442, loss: 21.987764716148376 
Train [6/6] | Epoch [133/140] |	nca: 1.2455335520207882, flat: 1.6025660410523415, pod: 19.142009139060974, loss: 21.990108728408813 
Train [6/6] | Epoch [134/140] |	nca: 1.1339843235909939, flat: 1.6002651676535606, pod: 19.256843328475952, loss: 21.991092801094055 
Train [6/6] | Epoch [135/140] |	nca: 1.0736673288047314, flat: 1.5773163214325905, pod: 19.007208347320557, loss: 21.658191800117493 
Train [6/6] | Epoch [136/140] |	nca: 1.146458126604557, flat: 1.5743330121040344, pod: 18.939140141010284, loss: 21.659931302070618 
Train [6/6] | Epoch [137/140] |	nca: 1.0228523910045624, flat: 1.5811710581183434, pod: 19.14152204990387, loss: 21.745545387268066 
Train [6/6] | Epoch [138/140] |	nca: 1.046947117894888, flat: 1.6487197205424309, pod: 19.394306659698486, loss: 22.08997333049774 
Train [6/6] | Epoch [139/140] |	nca: 1.1116232797503471, flat: 1.6046508699655533, pod: 19.259766459465027, loss: 21.976040720939636 
Train [6/6] | Epoch [140/140] |	nca: 1.1033422239124775, flat: 1.6144684329628944, pod: 19.173303186893463, loss: 21.891113877296448 
after task
Building & updating memory.
after task
Saving model at results\dev\podnet\202401\week_1\20240103_podnet_nme_cifar10_xsteps\net_0_task_5.pth.
Saving metadata at results\dev\podnet\202401\week_1\20240103_podnet_nme_cifar10_xsteps\meta_0_task_5.pkl.
Eval on 0->10.
eval task
podnet_nme_cifar10_xsteps
Avg inc acc: 0.8315.
Current acc: {'total': 0.749, '00-09': 0.749}.
Avg inc acc top5: 0.9948333333333332.
Current acc top5: {'total': 0.986}.
Forgetting: 0.11099999999999999.
Cord metric: 0.79.
Old accuracy: 0.76, mean: 0.82.
New accuracy: 0.62, mean: 0.71.
Average Incremental Accuracy: 0.8315.
Label was: podnet_nme_cifar10_xsteps
Results done on 1 seeds: avg: 83.15, last: 74.9, forgetting: 11.1
Individual results avg: [83.15]
Individual results last: [74.9]
Individual results forget: [11.1]
Command was D:/go_to_D/ML/Final/LibContinual/run_trainer.py
Time cost :  4367.220504522324
